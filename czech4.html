<!doctype html>
<meta charset=utf-8>
<meta name=viewport content=width=device-width,initial-scale=1.0>
<style>
body{background:#2f2f2f;color:white;text-align:center}
p,pre,ul,li,blockquote,table,dl{text-align:left}
body,td,th{font:14.5px/1.33 Arial,Helvetica,'Liberation Sans',sans-serif}
p{max-width:520px;margin:1em auto}
dl,pre{margin:1em auto;width:fit-content;max-width:min(100%, 1100px);box-sizing:border-box}
hr{border:none;border-top: 2px solid #bbb;margin:1em auto;max-width:1100px}
ul,ol{width:min(100%, 520px);margin:1em auto;box-sizing:border-box}
ul ul,ul ol,ol ol,ol ul{margin-top:0;margin-bottom:0}
h1,h2,h3,h2 a,h3 a,h2 a:visited,h3 a:visited{color:white;font-weight:normal}
h1{font-size:2.1em;margin-top:.7em}
h2{font-size:1.75em}
h3{font-size:1.35em}
blockquote h2,blockquote h3{margin:.5em 0}
blockquote ul,blockquote ol{margin:.4em 0}
a,a .quote{color:hsl(220,100%,75%)}
a:visited,a .quote{color:hsl(270,100%,75%)}
pre,code{white-space:pre-wrap;word-wrap:break-word;font:13.7px Menlo,'DejaVu Sans Mono','Liberation Mono',Consolas,monospace;background:#4a4a4a;color:white}
pre{padding:4px}
code{padding:1px}
table{border-collapse:collapse;margin:0 auto}
td,th{border:1px solid #555;padding:1px 3px}
th{background:#444;font-weight:bold}
img{max-width:100%;margin:0;vertical-align:middle}
div:has(img){width:fit-content;margin:0 auto}
dt{font-size:1.3em;margin:.4em 0}
body>blockquote{margin:1em auto;padding-left:45px;width:475px}
blockquote blockquote{width:calc(100% - 45px);margin-left:45px;box-sizing:border-box}
blockquote>:first-child{margin-top:0}
blockquote>:last-child{margin-bottom:0}
blockquote,.quote,blockquote,blockquote{color:hsl(100,100%,88%)}
blockquote .quote,blockquote blockquote,.quote .quote{color:hsl(100,50%,67%)}
blockquote blockquote blockquote,blockquote blockquote .quote,blockquote .quote .quote,.quote .quote .quote{color:hsl(100,35%,45%)}
blockquote h3{color:inherit}
.spoiler{max-width:1100px;margin:0 auto}
.spoiler button{width:90px;border:0;font-family:inherit;font-size:inherit;color:inherit;background:#4a4a4a;padding:4px 0px;outline:none;cursor:pointer;margin:0 0 -.3em 0}
.spoiler pre{display:none;margin-top:0;text-align:left}
.red,.red .quote{color:hsl(0,100%,77%)!important}
.comment{color:hsl(0,100%,80%)!important}
.toc{width:calc(50% + 260px);margin:1em 0 1em max(0px, 50% - 260px)}
.toc ul{width:min(100%, 50% + 260px - 40px);margin:0}
.maxwidth{max-width:100%}
@media print{
  body{background:white;color:black;margin:0px;zoom:.9;print-color-adjust:exact;-webkit-print-color-adjust:exact}
  a,a:visited{color:#0000EE}
  h1,h2,h2 a,h3 a,h2 a:visited,h3 a:visited{color:black}
  pre,code{background:#d6d6d6;color:black}
  th{background:#ddd}
  td,th{border:1px solid #ccc}
  blockquote,.quote{color:hsl(100,65%,28%)}
  blockquote .quote,blockquote blockquote,.quote .quote{color:hsl(100,50%,53%)}
  blockquote blockquote blockquote,blockquote .quote .quote,.quote .quote .quote{color:hsl(100,70%,72%)}
  .spoiler{display:none}
  .red,.red .quote{color:hsl(0,50%,60%)!important}
}
</style>
<title>Czech individual-level mortality data by vaccination status (part 4)</title>
<h1>Czech individual-level mortality data by vaccination status (part 4) - <a href=index.html>sars2.net</a></h1>
<p>Links to earlier parts: <a href=czech.html>czech.html</a>,
<a href=czech2.html>czech2.html</a>,
<a href=czech3.html>czech3.html</a>. The files about the Rootclaim
debate include additional analysis of the Czech data:
<a href=rootclaim3.html>rootclaim3.html</a>,
<a href=rootclaim4.html>rootclaim4.html</a>.</p>
<h2 id=Contents><a href=#Contents>Contents</a></h2>
<ul class=toc>
<li><a href="#Moderna_Pfizer_ratio_by_vaccination_quarter_and_age_group">Moderna-Pfizer ratio by vaccination quarter and age group</a></li>
<li><a href="#Triangle_plots_of_Moderna_Pfizer_ratio_for_third_and_fourth_doses">Triangle plots of Moderna-Pfizer ratio for third and fourth doses</a></li>
<li><a href="#Types_of_vaccination_sites">Types of vaccination sites</a></li>
<li><a href="#Ratio_of_deaths_per_adverse_event_reports_in_VAERS_calculated_by_Hans_Joachim_Kremer">Ratio of deaths per adverse event reports in VAERS calculated by Hans-Joachim Kremer</a></li>
<li><a href="#Adverse_event_reports_by_country_at_EudraVigilance">Adverse event reports by country at EudraVigilance</a></li>
<li><a href="#ASMR_when_people_are_classified_as_unvaccinated_until_three_weeks_from_vaccination">ASMR when people are classified as unvaccinated until three weeks from vaccination</a></li>
<li><a href="#Kirschs_resurrected_claim_that_people_were_not_allowed_to_choose_if_they_got_a_Moderna_or_Pfizer_vaccine">Kirsch&#39;s resurrected claim that people were not allowed to choose if they got a Moderna or Pfizer vaccine</a></li>
<li><a href="#Mortality_rate_of_people_born_before_1930_calculated_by_Tom_F_rst">Mortality rate of people born before 1930 calculated by Tomáš Fürst</a></li>
<li><a href="#Plot_for_raw_deaths_by_weeks_after_vaccination">Plot for raw deaths by weeks after vaccination</a></li>
<li><a href="#Kirschs_calculation_for_mortality_rate_by_batch">Kirsch&#39;s calculation for mortality rate by batch</a></li>
<li><a href="#Confidence_intervals_for_age_normalized_Moderna_Pfizer_ratio_by_month_of_vaccination">Confidence intervals for age-normalized Moderna-Pfizer ratio by month of vaccination</a></li>
<li><a href="#The_record_level_data_includes_vaccination_entries_for_people_older_than_the_oldest_known_Czech_citizens">The record-level data includes vaccination entries for people older than the oldest known Czech citizens</a></li>
<li><a href="#New_record_level_dataset_with_columns_for_cases_hospitalizations_and_comorbidity_index">New record-level dataset with columns for cases, hospitalizations, and comorbidity index</a></li>
<li><a href="#Comorbidity_index_by_age_group_and_vaccine_type_in_new_UZIS_data">Comorbidity index by age group and vaccine type in new UZIS data</a></li>
<li><a href="#Age_standardized_hospitalization_rate_by_vaccine_type_in_new_UZIS_data">Age-standardized hospitalization rate by vaccine type in new UZIS data</a></li>
<li><a href="#Age_standardized_hospitalization_rate_by_age_group_in_new_UZIS_data">Age-standardized hospitalization rate by age group in new UZIS data</a></li>
<li><a href="#Moderna_Pfizer_mortality_ratio_by_year_of_birth_and_comorbidity_index_in_new_UZIS_data">Moderna-Pfizer mortality ratio by year of birth and comorbidity index in new UZIS data</a></li>
<li><a href="#Mortality_risk_ratio_within_year_from_vaccination_in_new_UZIS_data">Mortality risk ratio within year from vaccination in new UZIS data</a></li>
<li><a href="#Hospitalizations_by_weeks_after_vaccination_in_new_UZIS_data">Hospitalizations by weeks after vaccination in new UZIS data</a></li>
<li><a href="#Relative_risk_of_Moderna_and_Pfizer_in_low_COVID_months">Relative risk of Moderna and Pfizer in low-COVID months</a></li>
<li><a href="#Case_fatality_ratio_in_new_UZIS_data">Case fatality ratio in new UZIS data</a></li>
<li><a href="#Daily_raw_number_of_deaths_by_vaccination_status">Daily raw number of deaths by vaccination status</a></li>
<li><a href="#Monthly_ASMR_by_vaccination_status">Monthly ASMR by vaccination status</a></li>
<li><a href="#Kirsch_regrets_not_appreciating_the_effect_of_confounders_in_his_analysis_of_the_Czech_data">Kirsch regrets not appreciating the effect of confounders in his analysis of the Czech data</a></li>
<li><a href="#ASMR_and_vaccine_doses_administered_by_age_group_in_NZIP_data">ASMR and vaccine doses administered by age group in NZIP data</a></li>
<li><a href="#NZIP_deaths_as_percentage_of_FOI_deaths">NZIP deaths as percentage of FOI deaths</a></li>
</ul>


<h2>
<a href=#Moderna_Pfizer_ratio_by_vaccination_quarter_and_age_group id=Moderna_Pfizer_ratio_by_vaccination_quarter_and_age_group>Moderna-Pfizer
ratio by vaccination quarter and age group</a>
</h2>
<p>Kirsch told me on Twitter: <span class="quote">"You have all failed
to explain why in every age group where we have sufficient data. Moderna
was significantly more deadly than Pfizer. it wasn't comorbidities
because those didn't matter. So why was the death rate higher? Why can't
you answer that simple question?"</span>
[<a href=https://x.com/stkirsch/status/1818053265357160918>https://x.com/stkirsch/status/1818053265357160918</a>]</p>
<p>I told him that in the plot below if you look at the age groups 50-59
and above where there's a sufficient sample size of deaths, the
Moderna-Pfizer ratio was close to 1.0 among people who got the first
dose in the 4th quarter of 2021. So did Moderna vaccines get less deadly
in the 4th quarter?</p>
<div>
<img src=i/czech-modpfivaxqvsage.png width=500>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table)

agecut=\(x,y)cut(x,c(y,Inf),paste0(y,c(paste0(&quot;-&quot;,y[-1]-1),&quot;+&quot;)),T,F)
quar=\(x){u=unique(x);paste0(substr(u,1,4),&quot;Q&quot;,(as.numeric(substr(u,6,7))-1)%/%3+1)[match(x,u)]}

ages=c(0,2:9*10)

t=fread(&quot;http://sars2.net/f/czbucketskeep.csv.gz&quot;)[dose&lt;=1][,age:=pmin(age,95)]

t=merge(t[dose==1&amp;vaxmonth&gt;=&quot;2021-01&quot;&amp;vaxmonth&lt;=&quot;2022-03&quot;],t[,.(base=sum(dead)/sum(alive)),age])[,base:=base*alive]

t=t[,.(base=sum(base),dead=sum(dead),alive=sum(as.double(alive))),.(type,vaxmonth=quar(vaxmonth),age=agecut(age,ages))]
t=rbind(t,t[,.(base=sum(base),dead=sum(dead),alive=sum(alive),vaxmonth=&quot;Total&quot;),.(age,type)])
t=rbind(t,t[,.(base=sum(base),dead=sum(dead),alive=sum(alive),age=&quot;Total&quot;),.(vaxmonth,type)])

a=t[,tapply(dead/base,.(type,age,vaxmonth),c)]
m1=a[&quot;Moderna&quot;,,];m2=a[&quot;Pfizer&quot;,,]
m=(m1-m2)/ifelse(m1&gt;m2,m2,m1)

pop=t[type%in%c(&quot;Moderna&quot;,&quot;Pfizer&quot;),xtabs(alive~age+vaxmonth)]/365
disp=matrix(sprintf(ifelse(m1/m2&gt;10,&quot;%.1f&quot;,&quot;%.2f&quot;),m1/m2),nrow(m))
hide=pmin(m1,m2)==0;m[hide]=NA;disp[is.na(m)]=&quot;&quot;
exp=.7;m=abs(m)^exp*sign(m);maxcolor=10^exp

pheatmap::pheatmap(m,filename=&quot;i1.png&quot;,display_numbers=disp,
  gaps_row=nrow(m)-1,gaps_col=ncol(m)-1,
  cluster_rows=F,cluster_cols=F,legend=F,cellwidth=19,cellheight=19,fontsize=9,fontsize_number=8,
  border_color=NA,na_col=&quot;gray90&quot;,
  number_color=ifelse((abs(m)&gt;.55*maxcolor)&amp;!is.na(m),&quot;white&quot;,&quot;black&quot;),
  breaks=seq(-maxcolor,maxcolor,,256),
  colorRampPalette(hsv(rep(c(7/12,0),5:4),c(.9,.75,.6,.3,0,.3,.6,.75,.9),c(.4,.65,1,1,1,1,1,.65,.4)))(256))

rec=fread(&quot;Czech/data/CR_records.csv&quot;,showProgress=F)
pop=rec[grep(&quot;comirnaty|spikevax&quot;,ignore.case=T,OckovaciLatka_1),.N,.(age=agecut(2021-Rok_narozeni,ages),vaxq=quar(Datum_1))]
pop=rbind(pop,pop[,.(N=sum(N),age=&quot;Total&quot;),vaxq])
pop=rbind(pop,pop[,.(N=sum(N),vaxq=&quot;Total&quot;),age])
pop=xtabs(N~age+vaxq,pop)[rownames(m),colnames(m)]

exp2=.6;maxcolor2=max(pop[-nrow(pop),])

kimi=\(x){e=floor(log10(ifelse(x==0,1,abs(x))));e2=pmax(e,0)%/%3+1;p=!is.na(x)
  x[p]=paste0(sprintf(paste0(&quot;%.&quot;,ifelse(e[p]%%3==0,1,0),&quot;f&quot;),x[p]/1e3^(e2[p]-1)),c(&quot;&quot;,&quot;k&quot;,&quot;M&quot;,&quot;B&quot;,&quot;T&quot;)[e2[p]]);x}

exp2=.6;maxcolor2=max(pop[-nrow(pop),-ncol(pop)])

pheatmap::pheatmap(pop^exp2,filename=&quot;i2.png&quot;,display_numbers=kimi(ifelse(pop==0,0,pop)),
  gaps_row=nrow(m)-1,gaps_col=ncol(m)-1,
  cluster_rows=F,cluster_cols=F,legend=F,cellwidth=19,cellheight=19,fontsize=9,fontsize_number=8,
  border_color=NA,na_col=&quot;white&quot;,
  number_color=ifelse(pop^exp2&gt;maxcolor2^exp2*.45,&quot;white&quot;,&quot;black&quot;),
  breaks=seq(0,maxcolor2^exp2,,256),
  sapply(seq(1,0,,256),\(i)rgb(i,i,i)))

cap=&quot;Czech record-level data: Age-normalized Moderna-Pfizer mortality ratio by vaccination quarter and age group. Only first doses are included. The mortality rate was calculated from the day of the first dose up to the end of 2022. A baseline number of deaths was calculated for each single year of age by multiplying the person-days of the age by the total mortality rate for the age in 2020 to 2022 among all people who are included in the record-level data, and the baseline deaths for all ages within an age group were added together. The ratio was calculated as (Moderna_deaths / Moderna_baseline) / (Pfizer_deaths / Pfizer_baseline). The right side shows the number of people each quarter who received either a Pfizer or Moderna vaccine for their first dose.&quot;
system(paste0(&quot;magick i[12].png +append 0.png;w=`identify -format %w 0.png`;pad=24;convert -pointsize 42 -interline-spacing -3 -font Arial \\( -size $[w-pad*2]x caption:&#39;&quot;,cap,&quot;&#39; -splice $[pad]x20 \\) 0.png -append 1.png&quot;))</pre>
</div>
<h2>
<a href=#Triangle_plots_of_Moderna_Pfizer_ratio_for_third_and_fourth_doses id=Triangle_plots_of_Moderna_Pfizer_ratio_for_third_and_fourth_doses>Triangle
plots of Moderna-Pfizer ratio for third and fourth doses</a>
</h2>
<p>Kirsch has been saying that the Moderna-Pfizer ratio is consistently
around 1.3 for all months of vaccination that have a sufficiently large
sample size of vaccinated people (even though my age-normalized
Moderna-Pfizer ratio was about 1.02 for people who got the first dose in
November 2021, and there's about about 300,000 people who got a first
dose from a Pfizer or Moderna vaccine in November 2021 so I think it's a
sufficiently large sample size).</p>
<p>But Kirsch has generally been looking at first doses only. The plot
below shows the results for the third dose instead. I used the same R
script as in this section:
<a href=czech2.html#Triangle_plot_of_Moderna_Pfizer_ratio>czech2.html#Triangle_plot_of_Moderna_Pfizer_ratio</a>.</p>
<p>The total Moderna-Pfizer ratio is below 1.0 for people who got the
third dose during each month from March 2022 to August 2022, but it
shouldn't just be random noise because there's a total of about 300,000
people who received a third shot from a Moderna or Pfizer vaccine during
those months. So there appears to be a similar effect as with the first
dose, where the late vaccinees have a lower Moderna-Pfizer ratio than
the early vaccinees:</p>
<div>
<img src=i/czech-trianglemodpfi-third.png width=690>
</div>
<p>The monthly number of 4th doses peaked in October 2022. But for
people who got a 4th dose in October 2022, the Moderna-Pfizer ratio was
about 0.67:</p>
<div>
<img src=i/czech-trianglemodpfi-fourth.png width=550>
</div>
<p>I had forgotten to make these triangle plots for the third and fourth
doses, but now I think these plots have become yet another nail in the
coffin of Kirsch's theory that his Moderna-Pfizer ratio proved that
Moderna vaccines were more deadly. Now of course it's possible that
Moderna vaccines were actually more deadly, but I don't think Kirsch's
Moderna-Pfizer ratio is the smoking gun piece of evidence that he makes
it out to be.</p>
<h2>
<a href=#Types_of_vaccination_sites id=Types_of_vaccination_sites>Types
of vaccination sites</a>
</h2>
<p>In the file <code>prehled-ockovacich-mist.csv</code> which has
information about vaccination sites, the sites are classified under
these 5 types:
[<a href=https://ockodoc.mzcr.cz/wp-content/uploads/2024/01/231230_manual_crs.pdf>https://ockodoc.mzcr.cz/wp-content/uploads/2024/01/231230_manual_crs.pdf</a>]</p>
<table>
<tr>
<th>
Abbreviation
</th>
<th>
Translation
</th>
<th>
Czech
</th>
</tr>
<tr>
<td>
OČM
</td>
<td>
standard vaccination site
</td>
<td>
standardní očkovací místo
</td>
</tr>
<tr>
<td>
DOČM
</td>
<td>
vaccination site for children
</td>
<td>
očkovací místo pro děti
</td>
</tr>
<tr>
<td>
VOČM
</td>
<td>
large-capacity vaccination site
</td>
<td>
velkokapacitní očkovací místo
</td>
</tr>
<tr>
<td>
SMPL
</td>
<td>
vaccination site for self-payers
</td>
<td>
očkovací místo pro samoplátce
</td>
</tr>
<tr>
<td>
WALKIN
</td>
<td>
mobile vaccination site
</td>
<td>
mobilní očkovací místo
</td>
</tr>
</table>
<p>The file <code>ockovani-profese.csv</code> contains about 19 million
rows with one row for each administered dose, but when I tried joining
the file with the file for information about vaccination sites, only
about 7 million rows could be joined by the vaccinator ID. The joined
rows didn't include any row for a large-capacity vaccination site. And I
further excluded vaccination sites for children and I excluded vaccines
given to ages below 18, because children have little effect on overall
mortality but the pediatric vaccination sites distorted the overall
percentages of site types. But this shows the distribution of the
remaining 3 types of vaccination sites:</p>
<pre>dlf=\(x,y,...){if(missing(y))y=sub(&quot;.*/&quot;,&quot;&quot;,x);for(i in 1:length(x))download.file(x[i],y[i],quiet=T,...)}
dlf(&quot;https://onemocneni-aktualne.mzcr.cz/api/v2/covid-19/ockovani-profese.csv&quot;) # about 4 GiB
dlf(&quot;https://onemocneni-aktualne.mzcr.cz/api/v2/covid-19/prehled-ockovacich-mist.csv&quot;) # about 20 kiB

pro=fread(&quot;ockovani-profese.csv&quot;)
mist=fread(&quot;prehled-ockovacich-mist.csv&quot;)

d=pro[,.N,.(vaxtype=vakcina,vaccinator=zarizeni_kod,age=vekova_skupina)]

d=d[!d$age%in%c(&quot;0-4&quot;,&quot;05-11&quot;,&quot;12-15&quot;,&quot;16-17&quot;)]

name1=unique(d$vaxtype);name2=rep(&quot;Other&quot;,length(name1))
name2[name1==&quot;&quot;]=&quot;&quot;
name2[grep(&quot;comirnaty&quot;,ignore.case=T,name1)]=&quot;Pfizer&quot;
name2[grep(&quot;spikevax&quot;,ignore.case=T,name1)]=&quot;Moderna&quot;
name2[grep(&quot;nuvaxovid&quot;,ignore.case=T,name1)]=&quot;Novavax&quot;
name2[name1==&quot;COVID-19 Vaccine Janssen&quot;]=&quot;Janssen&quot;
name2[name1==&quot;VAXZEVRIA&quot;]=&quot;AstraZeneca&quot;
d$vaxtype=name2[match(d$vaxtype,name1)]

d=merge(unique(mist[,.(sitetype=ockovaci_misto_typ,vaccinator=nrpzs_kod)],by=&quot;vaccinator&quot;),d)

m=d[sitetype!=&quot;DOČM&quot;,xtabs(N~vaxtype+sitetype)]
m=m[order(-rowSums(m)),]

round(m/rowSums(m)*100)</pre>
<!-- -->
<pre>             sitetype
vaxtype       OČM SMPL WALKIN # percentage of site types by manufacturer
  Pfizer       54   37      9
  Moderna      66   20     14
  Janssen      67   29      4
  AstraZeneca  46   42     12
  Novavax      65   32      3
  Other        42   46     11</pre>
<p>So Pfizer has a higher percentage of vaccination sites for
self-payers than Moderna (SMPL), but Moderna has a higher percentage of
standard vaccination sites (OČM) and walk-in sites. Which is yet another
line of evidence that there are systematic biases in the distribution of
vaccine doses by different manufacturers.</p>
<h2>
<a href=#Ratio_of_deaths_per_adverse_event_reports_in_VAERS_calculated_by_Hans_Joachim_Kremer id=Ratio_of_deaths_per_adverse_event_reports_in_VAERS_calculated_by_Hans_Joachim_Kremer>Ratio
of deaths per adverse event reports in VAERS calculated by Hans-Joachim
Kremer</a>
</h2>
<p>In this blog post where Hans-Joachim Kremer looked at US VAERS data,
he got a higher ratio of deaths per adverse event reports for Pfizer
than Moderna vaccines, so he pointed out that it conflicted with
Kirsch's analysis of the Czech data:
<a href=https://tkp.at/2024/08/06/spikevax-gefaehrlicher-als-comirnaty-steve-kirsch-greift-daneben/.><a
href="https://tkp.at/2024/08/06/spikevax-gefaehrlicher-als-comirnaty-steve-kirsch-greift-daneben/"
class="uri">https://tkp.at/2024/08/06/spikevax-gefaehrlicher-als-comirnaty-steve-kirsch-greift-daneben/</a>.</a></p>
<p>However it could be that Moderna had both a higher number of adverse
event reports per dose than Pfizer and a higher number of deaths per
dose than Pfizer, but the ratio of deaths per adverse event reports
could've still been higher for Pfizer than Moderna. So he could've
repeated the calculation so that he would've used doses administered
instead of adverse event reports as the denominator.</p>
<p>I took the number of adverse event reports in Czechia per vaccine
manufacturer from this spreadsheet:
<a href=https://github.com/PalackyUniversity/batch-dependent-safety/blob/main/data/SUKL-batches-AE.xlsx.><a
href="https://github.com/PalackyUniversity/batch-dependent-safety/blob/main/data/SUKL-batches-AE.xlsx"
class="uri">https://github.com/PalackyUniversity/batch-dependent-safety/blob/main/data/SUKL-batches-AE.xlsx</a>.</a>
The spreadsheet only included the number of doses released but not the
number of doses administered, so I calculated the number of doses
administered from the record-level data. I only included doses
administered up to July 4th 2023, which was the date when the authors
who published the batch data wrote they received the data. But anyway,
Moderna got a higher ratio than Pfizer for both deaths per doses
administered and adverse event reports per doses administered:</p>
<pre>rename=\(x){u=unique(x);o=rep(&quot;Other&quot;,length(u))
  o[grep(&quot;comirnaty|pfizer&quot;,u,T)]=&quot;Pfizer&quot;
  o[grep(&quot;moderna|spikevax&quot;,u,T)]=&quot;Moderna&quot;
  o[grep(&quot;nuvaxovid|novavax&quot;,u,T)]=&quot;Novavax&quot;
  o[grep(&quot;janssen&quot;,u,T)]=&quot;Janssen&quot;
  o[grep(&quot;vaxzevria|astrazeneca&quot;,u,T)]=&quot;AstraZeneca&quot;
  o[match(x,u)]}

rec=fread(&quot;curl -Ls github.com/skirsch/Czech/raw/main/data/CR_records.csv.xz|xz -dc&quot;)
k=grep(&quot;Datum_&quot;,names(rec));k2=k+3
d=data.table(date=`class&lt;-`(unlist(rec[,..k],,F),&quot;Date&quot;),type=rename(unlist(rec[,..k2],,F)))[!is.na(date)]
d=d[date&lt;=&quot;2023-7-4&quot;,.(doses=.N),type]

f=&quot;SUKL-batches-AE.xlsx&quot;
download.file(&quot;https://github.com/PalackyUniversity/batch-dependent-safety/raw/main/data/SUKL-batches-AE.xlsx&quot;,f)
s2=data.table(readxl::read_excel(f,sheet=2))
s2=s2[,.(reports=sum(no_reports),serious=sum(serious),dead=sum(deaths)),.(type=rename(name))]

o=merge(s2,d)
o[,deadpermildose:=dead/doses*1e6]
o[,reportspermildose:=reports/doses*1e6]
o[,deadpermilreport:=dead/reports*1e6]

dplyr::mutate_if(o[type!=&quot;Other&quot;],is.double,round)[order(-doses)]|&gt;print(r=F)</pre>
<!-- -->
<pre>        type reports serious dead    doses deadpermildose reportspermildose deadpermilreport
      Pfizer   10712    5183  134 15680944              9               683            12509
     Moderna    1575     583   26  1643159             16               959            16508
 AstraZeneca    1512     695   44   887601             50              1703            29101
     Janssen     555     241   10   415077             24              1337            18018
     Novavax      14       4    0    11190              0              1251                0</pre>
<p>When I used Pfizer as the baseline, Moderna got about 1.9 times
higher deaths per dose and about 1.4 times higher adverse event reports
per dose, so the ratio of deaths per reports also ended up being higher
for Moderna than Pfizer:</p>
<pre>&gt; round(o[type==&quot;Moderna&quot;,-1]/o[type==&quot;Pfizer&quot;,-1],3)
   reports serious  dead doses deadpermildose reportspermildose deadpermilreport
1:   0.147   0.112 0.194 0.105          1.852             1.403             1.32</pre>
<p>The spreadsheet didn't include information about age so I wasn't able
to look at only specific age groups or normalize my calculation by age.
In the record-level data the average age is about 7 years higher for
people who got a Moderna vaccine for the first dose than people who got
a Pfizer vaccine for the first dose. But earlier I got a correlation of
only about 0.18 between the average age of people under a batch and the
rate of deaths per batch that had been reported as adverse events:
<a href=czech3.html#Batch_study_by_authors_from_Palack_University>czech3.html#Batch_study_by_authors_from_Palack_University</a>.</p>
<p>But anyway, next I tried looking at US VAERS data:
<a href=https://vaers.hhs.gov/data/datasets.html.><a
href="https://vaers.hhs.gov/data/datasets.html"
class="uri">https://vaers.hhs.gov/data/datasets.html</a>.</a> I got the
number of doses administered per manufacturer in the United States from
this JSON file:
<a href=https://covid.cdc.gov/covid-data-tracker/COVIDData/getAjaxData?id=vaccination_data.><a
href="https://covid.cdc.gov/covid-data-tracker/COVIDData/getAjaxData?id=vaccination_data"
class="uri">https://covid.cdc.gov/covid-data-tracker/COVIDData/getAjaxData?id=vaccination_data</a>.</a>
It only included the cumulative number of doses administered up to May
10th 2023 which was when the data stopped being updated, when there were
about 367 million doses administered for Pfizer and 232 million for
Moderna. But I didn't find any source which showed the number of doses
grouped by both vaccine manufacturer and age, so I wasn't able to adjust
my calculation for age.</p>
<p>Moderna again got a higher rate of both deaths per dose and reports
per dose than Pfizer. But unlike in the case of the Czech data, the
Moderna-Pfizer ratio for deaths per dose was now lower than the ratio
for reports per dose, so Pfizer got a higher ratio of deaths per
reports:</p>
<pre>names=read.csv(text=&quot;name,vaers,doses
Pfizer,PFIZER\\BIONTECH,366979906
Moderna,MODERNA,232147784
Janssen,JANSSEN,19007537
Novavax,NOVAVAX,89195
Unknown,UNKNOWN MANUFACTURER,890835&quot;)

# # this code is not needed because I added the number of doses from the API to the table above
# con=url(&quot;https://covid.cdc.gov/covid-data-tracker/COVIDData/getAjaxData?id=vaccination_data&quot;)
# j=jsonlite::fromJSON(readLines(con))$vaccination_data;close(con)
# names$doses=j[1,paste0(&quot;Administered_&quot;,ifelse(names$name==&quot;Unknown&quot;,&quot;Unk_Manuf&quot;,names$name))]

va=do.call(rbind,lapply(2020:2024,\(i)fread(paste0(i,&quot;VAERSDATA.csv&quot;))))
va=merge(va,do.call(rbind,lapply(2020:2024,\(i)fread(paste0(i,&quot;VAERSVAX.csv&quot;)))))

o=va[VAX_TYPE==&quot;COVID19&quot;,.(reports=.N,dead=sum(DIED==&quot;Y&quot;)),.(vaers=VAX_MANU)]
o=merge(o,names)[,.(name,reports,dead,doses)]
o[,deadpermildose:=dead/doses*1e6]
o[,reportspermildose:=reports/doses*1e6]
o[,deadpermilreport:=dead/reports*1e6]
o[order(-doses)]|&gt;dplyr::mutate_if(is.double,round)|&gt;print(r=F)</pre>
<!-- -->
<pre>    name reports  dead     doses deadpermildose reportspermildose deadpermilreport
  Pfizer  481402 10439 366979906             28              1312            21685
 Moderna  469655  9821 232147784             42              2023            20911
 Janssen   73454  1943  19007537            102              3864            26452
 Unknown    7363    82    890835             92              8265            11137
 Novavax     492     5     89195             56              5516            10163</pre>
<p>This shows that the Moderna-Pfizer ratio is about 1.53 for reports
per dose, 1.39 for deaths per dose, and 0.91 for deaths per report:</p>
<pre>&gt; round(o[name==&quot;Moderna&quot;,-1]/o[name==&quot;Pfizer&quot;,-1],3)
   reports  dead doses deadpermildose reportspermildose deadpermilreport
1:   0.976 0.941 0.633          1.487             1.542            0.964</pre>
<p>However ideally I should've adjusted these calculations for age. In
VAERS the ratio of deaths per reports seems to approximately double
between each 10-year age group from 30-39 up to 90+ (even though the
ratio remains similar in ages 10-19, 20-29, and 30-39):</p>
<pre>&gt; va=do.call(rbind,lapply(2020:2024,\(i)fread(paste0(i,&quot;VAERSDATA.csv&quot;))))
&gt; va=merge(va,do.call(rbind,lapply(2020:2024,\(i)fread(paste0(i,&quot;VAERSVAX.csv&quot;)))))
&gt; agecut=\(x,y)cut(x,c(y,Inf),paste0(y,c(paste0(&quot;-&quot;,y[-1]-1),&quot;+&quot;)),T,F)
&gt; o=va[!is.na(AGE_YRS)&amp;VAX_TYPE==&quot;COVID19&quot;,.(dead=sum(DIED==&quot;Y&quot;),reports=.N),.(age=agecut(AGE_YRS,0:9*10))]
&gt; o[order(age)][,deadper10kreport:=round(dead/reports*1e4)][]|&gt;print(r=F)
   age dead reports deadper10kreport
   0-9   20   16389               12
 10-19  107   54171               20
 20-29  201   86426               23
 30-39  362  135659               27
 40-49  672  140188               48
 50-59 1572  155711              101
 60-69 3786  162128              234
 70-79 5910  117297              504
 80-89 5445   48294             1127
   90+ 2446   12197             2005</pre>
<p>Kremer divided the VAERS data into only two groups for ages 18-64 and
65+, so I wanted to check if I would get different results for more
fine-grained age groups. However when I calculated a Moderna-Pfizer
ratio for deaths per reports, the ratio was below 1 in all age 5-year
groups above 50-54, and some of the younger age groups where the ratio
was above 1 had wide confidence intervals:</p>
<pre>&gt; o=va[!is.na(AGE_YRS)&amp;VAX_TYPE==&quot;COVID19&quot;,.(dead=sum(DIED==&quot;Y&quot;),reports=.N),.(age=agecut(AGE_YRS,0:19*5),type=VAX_MANU)][order(age)]
&gt; o1=o[type==&quot;MODERNA&quot;];o2=o[type==&quot;PFIZER\\BIONTECH&quot;]
&gt; rate=(o1$dead/o1$reports)/(o2$dead/o2$reports)
&gt; ci=exp(log(rate)+outer(qnorm(.975)*sqrt(1/o1$dead-1/o1$reports+1/o2$dead-1/o2$reports),c(-1,1)))
&gt; o1[,.(age,rate,low=ci[,1],high=ci[,2])]|&gt;mutate_if(is.double,round,2)|&gt;print(r=F)
   age rate  low high
   0-4 1.47 0.40 5.47
   5-9 0.00 0.00  NaN
 10-14 2.31 0.79 6.78
 15-19 0.53 0.32 0.89
 20-24 0.83 0.52 1.35
 25-29 1.22 0.82 1.81
 30-34 0.88 0.61 1.28
 35-39 1.13 0.86 1.48
 40-44 0.87 0.68 1.13
 45-49 0.95 0.77 1.18
 50-54 1.02 0.86 1.22
 55-59 0.88 0.77 1.00
 60-64 0.86 0.77 0.95
 65-69 0.74 0.68 0.80
 70-74 0.72 0.66 0.77
 75-79 0.79 0.73 0.85
 80-84 0.71 0.66 0.76
 85-89 0.78 0.72 0.84
 90-94 0.94 0.86 1.03
   95+ 0.91 0.80 1.02</pre>
<p>Kremer's <span class="quote">"proportional rate ratio"</span> values
were expressed as the ratio for Pfizer divided by the ratio for Moderna,
so it's the opposite of the Moderna-Pfizer ratios that have been
calculated by me and Kirsch. His PRR value for deaths divided by reports
was about 1.014 for ages 18-64 and 1.278 for ages 65+:</p>
<div>
<img src=i/czech-kremer.jpg width=450>
</div>
<p>At first I got about 27% more deaths in ages 65+ than Kremer but only
about 4% more reports. But then I realized it was probably because I
counted reports where the <code>DIED</code> column had the value
<code>Y</code> as deaths, but Kremer might have only counted reports
where one of the symptom fields included death, which also gave me about
18% fewer deaths in ages 65+ for Moderna and Pfizer combined:</p>
<pre>&gt; va=do.call(rbind,lapply(2020:2024,\(i)fread(paste0(i,&quot;VAERSDATA.csv&quot;))))
&gt; va=merge(va,do.call(rbind,lapply(2020:2024,\(i)fread(paste0(i,&quot;VAERSVAX.csv&quot;)))))
&gt; symp=do.call(rbind,lapply(2020:2024,\(i)fread(paste0(i,&quot;VAERSSYMPTOMS.csv&quot;))))
&gt; va$dead=va$VAERS_ID%in%symp$VAERS_ID[rowSums(symp[,c(1:5*2)]==&quot;Death&quot;)==1]
&gt; vae=va[AGE_YRS&gt;=65&amp;VAX_TYPE==&quot;COVID19&quot;&amp;grepl(&quot;MOD|PFI&quot;,VAX_MANU)]
&gt; vae[DIED==&quot;Y&quot;,.N,VAX_MANU] # DIED column is Y
           VAX_MANU    N
1:          MODERNA 7598
2: PFIZER\\BIONTECH 7520
&gt; vae[dead==T,.N,VAX_MANU] # symptom columns include death
           VAX_MANU    N
1:          MODERNA 6285
2: PFIZER\\BIONTECH 6138</pre>
<p>I don't know which approach is better, but here when I counted
reports where the symptom columns included death, I got similar PRR
values as Kremer:</p>
<pre>&gt; young=va[AGE_YRS%in%18:64&amp;VAX_TYPE==&quot;COVID19&quot;,.(dead=sum(dead),reports=.N),.(type=VAX_MANU)]
&gt; young=young[match(c(&quot;PFIZER\\BIONTECH&quot;,&quot;MODERNA&quot;),type)]
&gt; young
               type dead reports
1: PFIZER\\BIONTECH 1503  283324
2:          MODERNA 1458  273126
&gt; young[1,dead/reports]/young[2,dead/reports]
[1] 0.99376 # PRR for ages 18 to 64 (Pfizer divided by Moderna)
&gt; old=va[AGE_YRS&gt;=65&amp;VAX_TYPE==&quot;COVID19&quot;,.(dead=sum(dead),reports=.N),.(type=VAX_MANU)]
&gt; old=old[match(c(&quot;PFIZER\\BIONTECH&quot;,&quot;MODERNA&quot;),type)]
&gt; old
               type dead reports
1: PFIZER\\BIONTECH 6138  105769
2:          MODERNA 6285  142616
&gt; old[1,dead/reports]/old[2,dead/reports]
[1] 1.3168 # PRR for ages 65 and above (Pfizer divided by Moderna)</pre>
<p>VAERS also contains reports from European countries, but several
fields including the country codes were scrubbed from European reports
in November 2022. WelcomeTheEagle posted a version of the VAERS data
here that was downloaded before the country codes were removed:
<a href=https://www.vaersaware.com/post/vaers-nov-11th-downloadable-files.><a
href="https://www.vaersaware.com/post/vaers-nov-11th-downloadable-files"
class="uri">https://www.vaersaware.com/post/vaers-nov-11th-downloadable-files</a>.</a>
I used the data to calculate an age-normalized rate of adverse event
reports in the Czech Republic. I took the number of doses administered
in each age group from the record-level data, so that I only included
doses administered up to November 11th 2022 which was the date of the
old snapshot of VAERS.</p>
<p>In the old VAERS data you can select Czech reports by selecting rows
where the first two characters of the <code>SPLTTYPE</code> field are
<code>CZ</code>. At first I tried selecting rows where the
<code>SYMPTOM_TEXT</code> field matched identifiers like
<code>CZ-CZSUKL-21010694</code>, but it missed about 16% of all reports
where the <code>SPLTTYPE</code> field started with <code>CZ</code>.
There were only two reports where <code>SYMPTOM_TEXT</code> matched
<code>\bCZ-</code> but <code>SPLTTYPE</code> didn't start with
<code>CZ</code>, but one of them was a Belgian report that was linked to
an earlier Czech report of the same patient, and the other report was
missing the <code>SPLTTYPE</code> field.</p>
<p>There were only 5,247 rows where the <code>SPLTTYPE</code> column
started with <code>CZ</code> and the <code>VAX_TYPE</code> column was
<code>COVID19</code>, and about two thirds of the rows were missing the
age field. But among the remaining 1,871 rows, the age-standardized rate
of adverse event reports per doses administered was about 3.0 times
higher for Moderna than Pfizer, and the crude rate that was not adjusted
for age was about 2.9 times higher for Moderna than Pfizer:</p>
<pre>age=\(x,y){class(x)=class(y)=NULL;(y-x-(y-789)%/%1461+(x-789)%/%1461)%/%365}
ua=\(x,y,...){u=unique(x);y(u,...)[match(x,u)]}

agecut=\(x,y)cut(x,c(y,Inf),paste0(y,c(paste0(&quot;-&quot;,y[-1]-1),&quot;+&quot;)),T,F)
ages=c(0,30,40,50,seq(60,95,5))

rename=\(x){u=unique(x);o=rep(&quot;Other&quot;,length(u))
  o[grep(&quot;comirnaty|pfizer&quot;,u,T)]=&quot;Pfizer&quot;
  o[grep(&quot;moderna|spikevax&quot;,u,T)]=&quot;Moderna&quot;
  o[grep(&quot;nuvaxovid|novavax&quot;,u,T)]=&quot;Novavax&quot;
  o[grep(&quot;janssen&quot;,u,T)]=&quot;Janssen&quot;
  o[grep(&quot;vaxzevria|astrazeneca&quot;,u,T)]=&quot;AstraZeneca&quot;
  o[match(x,u)]}

va=fread(&quot;AllVAERSDataCSVS/NonDomesticVAERSDATA.csv&quot;)
va=merge(va,fread(&quot;AllVAERSDataCSVS/NonDomesticVAERSVAX.csv&quot;))
vae=va[grepl(&quot;^CZ&quot;,SPLTTYPE)&amp;VAX_TYPE==&quot;COVID19&quot;]

rec=fread(&quot;Czech/data/CR_records.csv&quot;)
k=grep(&quot;Datum_&quot;,names(rec));k2=k+3
set.seed(0);d=rec[,.(birth=rep(ua(paste0(Rok_narozeni,&quot;-1-1&quot;),as.Date)+sample(0:364,.N,T),7))]
d$date=`class&lt;-`(unlist(rec[,..k],,F),&quot;Date&quot;)
d$type=rename(unlist(rec[,..k2],,F))
d=d[!is.na(date)&amp;date&lt;=&quot;2022-11-11&quot;]
d[,age:=age(birth,date)]
d=d[,.(doses=.N),.(type,age=agecut(pmax(age,0),ages))]

std=fread(&quot;http://sars2.net/f/czcensus2021pop.csv&quot;)[,.(std=sum(pop)),.(age=agecut(age,ages))][,std:=std/sum(std)]

a=merge(d,vae[!is.na(AGE_YRS),.(reports=.N),.(type=rename(VAX_MANU),age=agecut(AGE_YRS,ages))])
o=merge(std,a)[,.(reports=sum(reports),doses=sum(doses),agestd=sum(reports/doses*std*1e6)),type]
o[,crude:=reports/doses*1e6][order(-doses)]|&gt;print(r=F)</pre>
<!-- -->
<pre>    type reports    doses  agestd    crude
  Pfizer    1369 15508487   86.98    88.27 # Pfizer has about 3.3 times as many reports as Moderna
 Moderna     415  1639762  258.43   253.09
 Janssen      84   397696  205.40   211.22
   Other       2      180 2590.57 11111.11</pre>
<p>At first when I tried to select Czech VAERS reports by picking rows
where the age field was not missing and the <code>SYMPTOM_TEXT</code>
field matched <code>\bCZ-</code>, I got 199 reports for Moderna but 1210
for Pfizer. But now when I picked rows where the <code>SPLTTYPE</code>
field started with <code>CZ</code> instead, I got 415 reports for
Moderna but 1369 for Pfizer, so it approximately doubled the ratio of
Moderna reports to Pfizer reports. It might be because many of the
reports for Pfizer vaccines included an identifier like
<code>CZ-PFIZER INC-2021285400</code> in the <code>SYMPTOM_TEXT</code>
field, but there wasn't a similar identifier for Moderna vaccines.
However it also seems to be a sign that there was somehow a different
reporting procedure used for Pfizer vaccines and Moderna vaccines.</p>
<p>In the previous block of code I only included VAERS reports where the
age field was not missing. But now when I also included the reports
where the age field was missing, Pfizer got about 9% higher crude rate
of reports per dose than Moderna:</p>
<pre>&gt; allage=merge(d[,.(doses=sum(doses)),type],va[,.(reports=.N),.(type=rename(VAX_MANU))])
&gt; allage[,crude:=reports/doses*1e6][order(-doses)]|&gt;print(r=F)
    type    doses reports   crude
  Pfizer 15526217    4548   292.9 # Pfizer has about 10.3 times as many reports as Moderna
 Moderna  1639762     441   268.9
 Janssen   414410     244   588.8
   Other      764      14 18324.6</pre>
<p>In the output above Pfizer got about 10.3 times as many reports as
Moderna but in the block of output before it the ratio was about 3.3. In
the spreadsheet from the GitHub account of Palacký University I got an
intermediate ratio of about 6.8. The Palacký spreadsheet includes about
2.7 times as many total reports as VAERS, so there might be some kind of
a bias for which reports end up being submitted to VAERS:</p>
<pre>&gt; s2=data.table(readxl::read_excel(&quot;SUKL-batches-AE.xlsx&quot;,sheet=2))
&gt; s2[,.(reports=sum(no_reports)),type=rename(name)][order(-reports)]|&gt;print(r=F)
        type reports
      Pfizer   10712 # Pfizer has about 6.8 times as many reports as Moderna
     Moderna    1575
 AstraZeneca    1512
     Janssen     555
       Other      18
     Novavax      14</pre>
<p>For some reason in the Czech VAERS data, the percentage of reports
that was missing the age field was about 6% for Moderna but 70% for
Pfizer (even though in many of the reports where the age field was
missing, the age was still mentioned in the <code>SYMPTOM_TEXT</code>
field):</p>
<pre>&gt; va=fread(&quot;AllVAERSDataCSVS/NonDomesticVAERSDATA.csv&quot;)
&gt; va=merge(va,fread(&quot;AllVAERSDataCSVS/NonDomesticVAERSVAX.csv&quot;))
&gt; vae=va[grepl(&quot;^CZ&quot;,SPLTTYPE)&amp;VAX_TYPE==&quot;COVID19&quot;]
&gt; vae[,.(reports=.N,missingagepct=mean(is.na(AGE_YRS))*100),VAX_MANU][order(-reports)]|&gt;print(r=F)
             VAX_MANU reports missingagepct
     PFIZER\\BIONTECH    4548        69.899
              MODERNA     441         5.896
              JANSSEN     244        65.574
 UNKNOWN MANUFACTURER      14        78.571</pre>
<p>In the whole VAERS data the percentage of reports that was missing
the age field was about 8.9% for Moderna but 9.7% for Pfizer (so it's
not a major difference, but it might have still introduced a slight bias
to Kremer's analysis where he only included reports within a certain age
range):</p>
<pre>&gt; va=do.call(rbind,lapply(2020:2024,\(i)fread(paste0(i,&quot;VAERSDATA.csv&quot;))))
&gt; va=merge(va,do.call(rbind,lapply(2020:2024,\(i)fread(paste0(i,&quot;VAERSVAX.csv&quot;)))))
&gt; va[VAX_TYPE==&quot;COVID19&quot;,.(reports=.N,missingagepct=mean(is.na(AGE_YRS))*100),VAX_MANU][order(-reports)]|&gt;print(r=F)
             VAX_MANU reports missingagepct
     PFIZER\\BIONTECH  481402         9.738
              MODERNA  469655         8.871
              JANSSEN   73454        18.101
 UNKNOWN MANUFACTURER    7363        27.774
              NOVAVAX     492         3.862</pre>
<p>I also tried downloading the raw EudraVigilance data from here:
<a href=https://howbad.info>https://howbad.info</a> (direct link
<a href=https://www.dropbox.com/scl/fi/mrzkrrg5391kevsrwex0e/eudra-vigilance3.zip?rlkey=eqg628elz9lqufpehh2ni3o9w).><a
href="https://www.dropbox.com/scl/fi/mrzkrrg5391kevsrwex0e/eudra-vigilance3.zip?rlkey=eqg628elz9lqufpehh2ni3o9w"
class="uri">https://www.dropbox.com/scl/fi/mrzkrrg5391kevsrwex0e/eudra-vigilance3.zip?rlkey=eqg628elz9lqufpehh2ni3o9w</a>).</a>
I ran this code to get the number of deaths and reports grouped by age,
date, and manufacturer:</p>
<pre>awk -F\\t &#39;{sub(&quot; .*&quot;,&quot;&quot;,$3);sub(&quot;More than 85 Years&quot;,85,$7);sub(&quot;Not Specified&quot;,&quot;&quot;,$7);sub(&quot;[- ].*&quot;,&quot;&quot;,$7);x=&quot;&quot;}$12~/SPIKEVAX|MODERNA/{x=&quot;Moderna&quot;}$12~/COMIRNATY|TOZINAMERAN/{x=&quot;Pfizer&quot;}$12~/COVID-19 VACCINE ASTRAZENECA|VAXZEVRIA/{x=&quot;AstraZeneca&quot;}$12~/COVID-19 VACCINE JANSSEN|JCOVDEN/{x=&quot;Janssen&quot;}x{k=$3&quot;,&quot;x&quot;,&quot;$7;a[k]++;dead[k]+=$11~/Fatal - Results in Death/}END{for(i in a)print i&quot;,&quot;a[i]&quot;,&quot;dead[i]}&#39; eudra-vigilance3/*|(echo date,type,age,reports,dead;sort -nk3|sort -sk2,2|sort -sk1,1)&gt;eudra.csv</pre>
<p>However in the EudraVigilance data Moderna got a higher rate of
deaths per reports than Pfizer in all age groups:</p>
<pre>eu=fread(&quot;http://sars2.net/f/eudra.csv&quot;)

eu=eu[,.(reports=sum(reports),dead=sum(dead)),.(age=ifelse(age&lt;10,0,age),type)][order(age)]
eu=rbind(eu,eu[,.(reports=sum(reports),dead=sum(dead),age=&quot;Total&quot;),type])

o=eu[type==&quot;Moderna&quot;,.(age,Moderna_dead=dead,Moderna_reports=reports)]
o=cbind(o,eu[type==&quot;Pfizer&quot;,.(Pfizer_dead=dead,Pfizer_reports=reports)])
o$Moderna_rate=o[,2]/o[,3]*1e6
o$Pfizer_rate=o[,4]/o[,5]*1e6
o$Moderna_Pfizer_ratio=o[,6]/o[,7]
o</pre>
<table>
<tr>
<th>
Age
</th>
<th>
Moderna<br>dead
</th>
<th>
Moderna<br>reports
</th>
<th>
Pfizer<br>dead
</th>
<th>
Pfizer<br>reports
</th>
<th>
Moderna<br>rate
</th>
<th>
Pfizer<br>rate
</th>
<th>
Moderna-Pfizer<br>ratio
</th>
</tr>
<tr>
<td>
0
</td>
<td>
13
</td>
<td>
511
</td>
<td>
74
</td>
<td>
6436
</td>
<td>
25440
</td>
<td>
11498
</td>
<td>
2.21
</td>
</tr>
<tr>
<td>
12
</td>
<td>
26
</td>
<td>
2553
</td>
<td>
158
</td>
<td>
30958
</td>
<td>
10184
</td>
<td>
5104
</td>
<td>
2.00
</td>
</tr>
<tr>
<td>
18
</td>
<td>
1832
</td>
<td>
292765
</td>
<td>
3034
</td>
<td>
920149
</td>
<td>
6258
</td>
<td>
3297
</td>
<td>
1.90
</td>
</tr>
<tr>
<td>
65
</td>
<td>
3139
</td>
<td>
53245
</td>
<td>
5937
</td>
<td>
152645
</td>
<td>
58954
</td>
<td>
38894
</td>
<td>
1.52
</td>
</tr>
<tr>
<td>
85
</td>
<td>
1367
</td>
<td>
6259
</td>
<td>
4104
</td>
<td>
26633
</td>
<td>
218405
</td>
<td>
154095
</td>
<td>
1.42
</td>
</tr>
<tr>
<td>
NA
</td>
<td>
280
</td>
<td>
16845
</td>
<td>
1098
</td>
<td>
74500
</td>
<td>
16622
</td>
<td>
14738
</td>
<td>
1.13
</td>
</tr>
<tr>
<td>
Total
</td>
<td>
6657
</td>
<td>
372178
</td>
<td>
14405
</td>
<td>
1211321
</td>
<td>
17887
</td>
<td>
11892
</td>
<td>
1.50
</td>
</tr>
</table>
<p>The next plot also shows that there's a lot of variance in the <span
class="quote">"proportional rate ratio"</span> across European
countries. Even if you only look at the column which shows the total
ratio in all age groups and you look at the countries at the top of the
plot which have the highest number of reports, the ratio is far below 1
in Austria and Germany but far above 1 in France, Italy, and
Netherlands. The countries are sorted by the total number of reports,
which was for some reason the highest in Austria:</p>
<div>
<img src=i/czech-kremer-eea.png width=800>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table)

kimi=\(x){na=is.na(x);x[na]=0;e=floor(log10(ifelse(x==0,1,abs(x))));e2=pmax(e,0)%/%3+1;x[]=ifelse(abs(x)&lt;1e3,round(x),paste0(sprintf(paste0(&quot;%.&quot;,ifelse(e%%3==0,1,0),&quot;f&quot;),x/1e3^(e2-1)),c(&quot;&quot;,&quot;k&quot;,&quot;M&quot;,&quot;B&quot;,&quot;T&quot;)[e2]));x[na]=&quot;NA&quot;;x}

agecut=\(x,y)cut(x,c(y,Inf),paste0(y,c(paste0(&quot;-&quot;,y[-1]-1),&quot;+&quot;)),T,F)

iso2=fread(&quot;https://raw.githubusercontent.com/lukes/ISO-3166-Countries-with-Regional-Codes/master/all/all.csv&quot;)
iso2=setNames(iso2$name,iso2$`alpha-2`)
iso2[&quot;NL&quot;]=&quot;Netherlands&quot;

va=fread(&quot;AllVAERSDataCSVS/NonDomesticVAERSDATA.csv&quot;)
va=merge(va,fread(&quot;AllVAERSDataCSVS/NonDomesticVAERSVAX.csv&quot;))
symp=fread(&quot;AllVAERSDataCSVS/NonDomesticVAERSSYMPTOMS.csv&quot;)

va$dead=va$VAERS_ID%in%symp$VAERS_ID[rowSums(symp[,c(1:5*2)]==&quot;Death&quot;)==1]
va[,country:=substr(SPLTTYPE,1,2)]
eea=strsplit(&quot;AT BE BG HR CY CZ DK EE FI FR DE GR HU IE IT LV LT LU MT NL PL PT RO SK SI ES SE IS LI NO&quot;,&quot; &quot;)[[1]]
va=va[VAX_TYPE==&quot;COVID19&quot;&amp;country%in%eea]

ages=c(0,40,60,80)
vae=va[,.(dead=sum(dead),reports=.N),.(type=VAX_MANU,country=iso2[country],age=agecut(AGE_YRS,ages))]
vae[is.na(age),age:=&quot;Missing&quot;]
vae=vae[country%in%vae[,sum(reports),country][V1&gt;=5e3,country]]

vae[,country:=factor(country,vae[,sum(reports),country][order(-V1),country])]
vae[,type:=factor(type,vae[,sum(reports),type][order(-V1),type])]
vae=rbind(vae,vae[,.(dead=sum(dead),reports=sum(reports),age=&quot;Total&quot;),.(type,country)])
vae=rbind(vae,vae[,.(dead=sum(dead),reports=sum(reports),country=&quot;Total&quot;),.(type,age)])

a=vae[,tapply(dead/reports*1e5,.(type,country,age),c)]

type1=&quot;MODERNA&quot;;type2=&quot;PFIZER\\BIONTECH&quot;
m1=a[type1,,];m2=a[type2,,];m=(m1-m2)/ifelse(m1&gt;m2,m2,m1)
disp=m1/m2;disp[]=sprintf(&quot;%.*f&quot;,ifelse(!is.na(disp)&amp;disp&gt;=10,1,2),disp);disp[is.na(m)]=&quot;NA&quot;
maxcolor=10
zero=m1&gt;0&amp;m2==0;m[zero]=-maxcolor;disp[zero]=&quot;0.00&quot;
inf=m1==0&amp;m2&gt;0;m[inf]=maxcolor;disp[inf]=&quot;Inf&quot;

pal=hsv(rep(c(7/12,0),4:5),c(.9,.75,.6,.3,0,.3,.6,.75,.9),c(.4,.65,1,1,1,1,1,.65,.4))

pheatmap::pheatmap(m,filename=&quot;i1.png&quot;,display_numbers=disp,
  gaps_col=ncol(m)-1,gaps_row=nrow(m)-1,cluster_rows=F,cluster_cols=F,legend=F,
  cellwidth=19,cellheight=19,fontsize=9,fontsize_number=8,border_color=NA,na_col=&quot;gray90&quot;,
  number_color=ifelse(!is.na(m)&amp;abs(m)&gt;.5*maxcolor,&quot;white&quot;,&quot;black&quot;),
  breaks=seq(-maxcolor,maxcolor,,256),colorRampPalette(pal)(256))

mpop=vae[type%in%c(type1,type2),xtabs(reports~country+age)]
exp2=.6;maxcolor2=max(mpop[-nrow(mpop),-ncol(mpop)])

pheatmap::pheatmap(mpop^exp2,filename=&quot;i2.png&quot;,display_numbers=kimi(mpop),
  gaps_row=nrow(m)-1,gaps_col=ncol(m)-1,cluster_rows=F,cluster_cols=F,legend=F,
  cellwidth=19,cellheight=19,fontsize=9,fontsize_number=8,border_color=NA,na_col=&quot;white&quot;,
  number_color=ifelse(mpop^exp2&gt;maxcolor2^exp2*.45,&quot;white&quot;,&quot;black&quot;),
  breaks=seq(0,maxcolor2^exp2,,256),sapply(seq(1,0,,256),\(i)rgb(i,i,i)))

mdead=vae[type%in%c(type1,type2),xtabs(dead~country+age)]
exp3=.6;maxcolor3=max(mdead[-nrow(mdead),-ncol(mdead)])

pheatmap::pheatmap(mdead^exp3,filename=&quot;i3.png&quot;,display_numbers=kimi(mdead),
  gaps_row=nrow(m)-1,gaps_col=ncol(m)-1,cluster_rows=F,cluster_cols=F,legend=F,
  cellwidth=19,cellheight=19,fontsize=9,fontsize_number=8,border_color=NA,na_col=&quot;white&quot;,
  number_color=ifelse(mdead^exp3&gt;maxcolor3^exp3*.45,&quot;white&quot;,&quot;black&quot;),
  breaks=seq(0,maxcolor3^exp3,,256),sapply(seq(1,0,,256),\(i)rgb(i,i,i)))

cap=&quot;VAERS reports in EEA up to November 2022: Ratio of deaths per reports for Moderna divided by Pfizer. For example 2.0 means that the ratio of deaths per reports was twice as high for Moderna as Pfizer. Only countries with at least 5,000 total reports were included. An old snapshot of VAERS data where country codes had not been removed was downloaded from here: vaersaware.com/post/vaers-nov-11th-downloadable-files.&quot;
system(paste0(&quot;pad=20;pad2=30;w=`identify -format %w i1.png`;magick -font Arial-Bold -pointsize 42 -size $[w-pad*2]x \\( caption:&#39;Moderna-Pfizer ratio&#39; -splice $[pad]x20 i1.png -append \\) \\( caption:&#39;Reports for Pfizer and Moderna&#39; -splice $[pad]x20 i2.png -append \\) \\( caption:&#39;Deaths for Pfizer and Moderna&#39; -splice $[pad]x20 i3.png -append \\) -shave 14x +append -trim -bordercolor white -border $pad2 0.png;w=`identify -format %w 0.png`;magick -pointsize 42 -font Arial -interline-spacing -2 \\( -size $[w-pad2*2]x caption:&#39;&quot;,cap,&quot;&#39; -splice $[pad2]x24 \\) 0.png -append 1.png&quot;))</pre>
</div>
<h2>
<a href=#Adverse_event_reports_by_country_at_EudraVigilance id=Adverse_event_reports_by_country_at_EudraVigilance>Adverse
event reports by country at EudraVigilance</a>
</h2>
<p>The raw data for EudraVigilance that can be downloaded from
howbad.info doesn't show the country of the reports. But you can see the
number of reports for each country from EMA's portal for EudraVigilance,
if you go here, click <span class="quote">"C"</span>, scroll to COVID
vaccines, open the page for a vaccine brand, and click <span
class="quote">"Number of Individual Cases by EEA countries"</span>:
<a href=https://www.adrreports.eu/en/search_subst.html.><a
href="https://www.adrreports.eu/en/search_subst.html"
class="uri">https://www.adrreports.eu/en/search_subst.html</a>.</a> I
compiled the data for all vaccine brands into this CSV file on August
8th 2024 UTC: <a href=f/eudracountry.csv>f/eudracountry.csv</a>.</p>
<p>I took the number of doses administered by manufacturer and country
from OWID:
<a href=https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/vaccinations/vaccinations-by-manufacturer.csv.><a
href="https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/vaccinations/vaccinations-by-manufacturer.csv"
class="uri">https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/vaccinations/vaccinations-by-manufacturer.csv</a>.</a>
OWID was missing data for Greece and UK, and in the following analysis I
also excluded Iceland because it was missing most administered doses at
OWID.</p>
<p>In most countries Moderna got a higher rate of reports per dose than
Pfizer (with the exception of Italy, Netherlands, Portugal, and a few
small countries that have a small sample size):</p>
<div>
<img src=i/czech-eudracountry.png width=500>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table)

kimi=\(x){na=is.na(x);x[na]=0;e=floor(log10(ifelse(x==0,1,abs(x))));e2=pmax(e,0)%/%3+1;x[]=ifelse(abs(x)&lt;1e3,round(x),paste0(sprintf(paste0(&quot;%.&quot;,ifelse(e%%3==0,1,0),&quot;f&quot;),x/1e3^(e2-1)),c(&quot;&quot;,&quot;k&quot;,&quot;M&quot;,&quot;B&quot;,&quot;T&quot;)[e2]));x[na]=&quot;NA&quot;;x}

owid=fread(&quot;https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/vaccinations/vaccinations-by-manufacturer.csv&quot;)
owid=unique(owid[order(-date)],by=c(&quot;location&quot;,&quot;vaccine&quot;))
owid=owid[,.(country=location,doses=total_vaccinations,type=vaccine)]

owid$type[owid$type==&quot;Pfizer/BioNTech&quot;]=&quot;Pfizer&quot;
owid$type[owid$type==&quot;Oxford/AstraZeneca&quot;]=&quot;AstraZeneca&quot;
owid$type[owid$type==&quot;Johnson&amp;Johnson&quot;]=&quot;Janssen&quot;

eu=fread(&quot;http://sars2.net/f/eudracountry.csv&quot;)
eu$country[eu$country==&quot;Czech Republic&quot;]=&quot;Czechia&quot;

me=merge(eu,owid)[country!=&quot;Iceland&quot;]

me[,country:=factor(country,me[,.(sum(doses)),country][order(-V1),country])]
me[,type:=factor(type,me[,.(sum(doses)),type][order(-V1),type])]

me=rbind(me,me[,.(reports=sum(reports),doses=sum(doses),country=&quot;Total&quot;),type])
me=rbind(me,me[,.(reports=sum(reports),doses=sum(doses),type=&quot;Total&quot;),country])

m=me[,tapply(reports/doses*1e4,.(country,type),c)]
m[is.infinite(m)]=NA;disp=kimi(m);exp=.7;maxcolor=200
pal=hsv(c(21,21,21,16,11,6,3,0,0,0)/36,c(0,.25,rep(.5,8)),c(rep(1,8),.5,0))

pheatmap::pheatmap(m^exp,filename=&quot;i1.png&quot;,display_numbers=disp,
  gaps_row=nrow(m)-1,gaps_col=ncol(m)-1,
  cluster_rows=F,cluster_cols=F,legend=F,cellwidth=20,cellheight=20,fontsize=9,fontsize_number=8,
  border_color=NA,na_col=&quot;gray90&quot;,
  number_color=ifelse(!is.na(m)&amp;m^exp&gt;maxcolor^exp*.8,&quot;white&quot;,&quot;black&quot;),
  breaks=seq(0,maxcolor^exp,,256),
  colorRampPalette(pal)(256))

m=me[,xtabs(doses~country+type)]
disp=kimi(m);exp=.7;maxcolor=max(m[-nrow(m),-ncol(m)])
pal=sapply(seq(1,0,,256),\(i)rgb(i,i,i))

pheatmap::pheatmap(m^exp,filename=&quot;i2.png&quot;,display_numbers=disp,
  gaps_row=nrow(m)-1,gaps_col=ncol(m)-1,
  cluster_rows=F,cluster_cols=F,legend=F,cellwidth=20,cellheight=20,fontsize=9,fontsize_number=8,
  border_color=NA,na_col=&quot;gray90&quot;,
  number_color=ifelse(!is.na(m)&amp;m^exp&gt;maxcolor^exp*.45,&quot;white&quot;,&quot;black&quot;),
  breaks=seq(0,maxcolor^exp,,256),
  colorRampPalette(pal)(256))

cap=&quot;Number of adverse event reports at EudraVigilance per 10,000 doses administered at OWID. The right side shows the number of doses administered. Source: adrreports.eu/en/search_subst.html (letter C, links for COVID vaccines), ourworldindata.org/grapher/covid-vaccine-doses-by-manufacturer (download CSV data).&quot;
system(paste0(&quot;magick \\( i1.png -gravity east -chop 10x \\) \\( i2.png -gravity west -chop 10x \\) +append 0.png;w=`identify -format %w 0.png`;pad=20;magick -pointsize 42 -interline-spacing -2 -font Arial \\( -size $[w-pad*2]x caption:&#39;&quot;,cap,&quot;&#39; -splice $[pad]x20 \\) 0.png -append 1.png&quot;))</pre>
</div>
<p>However I was not able to adjust my analysis for differences in the
age distribution between vaccine brands. In the VAERS reports that are
not missing the age field, most EEA countries have a higher average age
for Moderna than Pfizer, even though in most countries the difference
isn't as big as in the Czech Republic:</p>
<pre>va=fread(&quot;AllVAERSDataCSVS/NonDomesticVAERSDATA.csv&quot;)
va=merge(va,fread(&quot;AllVAERSDataCSVS/NonDomesticVAERSVAX.csv&quot;))

va[,country:=substr(SPLTTYPE,1,2)]
vae=va[VAX_TYPE==&quot;COVID19&quot;,.(age=mean(AGE_YRS,na.rm=T),.N),.(type=VAX_MANU,country)]

o=vae[type==&quot;MODERNA&quot;,.(country,Moderna_age=age,Moderna_N=N)]
o=merge(o,vae[type==&quot;PFIZER\\BIONTECH&quot;,.(country,Pfizer_age=age,Pfizer_N=N)])
o$diff=o[,2]-o[,4]

o=o[country%in%strsplit(&quot;AT BE BG HR CY CZ DK EE FI FR DE GR HU IE IT LV LT LU MT NL PL PT RO SK SI ES SE IS LI NO&quot;,&quot; &quot;)[[1]]]
o[order(-Pfizer_N)][,c(1,2,4,6,3,5)]|&gt;mutate_if(is.double,round,1)|&gt;print(r=F)</pre>
<!-- -->
<pre> country Moderna_age Pfizer_age  diff Moderna_N Pfizer_N
      AT        46.8       46.1   0.7      7179    85854
      DE        49.7       49.4   0.3      9772    54896
      FR        51.3       50.2   1.2      6781    41596
      IT        49.2       48.0   1.2      5161    19949
      NL        51.3       47.5   3.8      1743    11278
      SE        49.9       49.7   0.3      2190     9454
      ES        45.3       48.0  -2.7      2232     8977
      BE        42.1       42.6  -0.5      2871     8285
      PT        44.6       44.9  -0.3       885     6337
      NO        44.5       46.3  -1.8      1563     5934
      FI        45.6       47.1  -1.5      1059     5555
      GR        49.6       47.8   1.8       676     5125
      CZ        54.3       48.7   5.6       441     4548
      IE        47.5       42.1   5.4       794     4408
      PL        47.5       44.2   3.3       500     4300
      DK        47.6       51.5  -3.9       861     4250
      RO        46.5       41.2   5.3       180     1978
      EE        55.7       49.4   6.3       104     1143
      HR        47.7       44.7   3.0       178     1118
      HU        61.8       49.2  12.6        93     1064
      IS        41.2       47.6  -6.4        76     1048
      SK        52.8       46.1   6.8       120      857
      LT        53.1       47.8   5.4        63      830
      SI        62.8       50.6  12.2        58      518
      LU        45.7       43.4   2.3       117      457
      LV        53.0       40.8  12.2       149      417
      CY        43.2       45.5  -2.3        26      214
      BG        46.2       46.5  -0.3        33      185
      MT        43.2       50.9  -7.7        23      137
      LI        44.0       72.0 -28.0         2        5
 country Moderna_age Pfizer_age  diff Moderna_N Pfizer_N</pre>
<h2>
<a href=#ASMR_when_people_are_classified_as_unvaccinated_until_three_weeks_from_vaccination id=ASMR_when_people_are_classified_as_unvaccinated_until_three_weeks_from_vaccination>ASMR
when people are classified as unvaccinated until three weeks from
vaccination</a>
</h2>
<p>In February 2024 the Dutch Central Bureau of Statistics published a
dataset for COVID and non-COVID ASMR by vaccination status:
<a href=https://www.cbs.nl/nl-nl/longread/rapportages/2024/covid-vaccinatiestatus-en-sterfte/3-resultaten.><a
href="https://www.cbs.nl/nl-nl/longread/rapportages/2024/covid-vaccinatiestatus-en-sterfte/3-resultaten"
class="uri">https://www.cbs.nl/nl-nl/longread/rapportages/2024/covid-vaccinatiestatus-en-sterfte/3-resultaten</a>.</a>
It included one set of data where people were classified as vaccinated
immediately after the first dose, and another set of data where people
were generally only classified as vaccinated 2 weeks after the second
dose (or 4 weeks after the first dose in the case of vaccine brands like
Johnson &amp; Johnson which had only one primary course dose).</p>
<p>The classification delay reduced unvaccinated ASMR during the main
rollout of the primary course doses from March to July 2021, so it
resulted in a big advantage to unvaccinated people. In January and
February 2021 the classification delay gave an advantage to vaccinated
people because then there was a delay before the vulnerable groups of
people were priorized during early rollout were counted as vaccinated,
even though there were so few people who had been vaccinated during the
first two months of 2021 that they don't have much impact on the total
ASMR of vaccinated people:
[<a href=statistic.html#Comparison_of_fully_vaccinated_and_vaccinated_ASMR>statistic.html#Comparison_of_fully_vaccinated_and_vaccinated_ASMR</a>]</p>
<div>
<img src=i/czech-cheap-1.png width=700>
</div>
<p>Similarly in the Czech record-level data when I classified people as
unvaccinated until 3 weeks from the first dose, it gave an advantage to
unvaccinated people because it reduced the ASMR of unvaccinated people
and it increased the ASMR of vaccinated people:</p>
<div>
<img src=i/czech-cheap-2.png width=600>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table);library(ggplot2)

b=fread(&quot;http://sars2.net/f/czbucketskeep.csv.gz&quot;)[dose&lt;=1]
std=fread(&quot;http://sars2.net/f/czcensus2021pop.csv&quot;)[,.(std=sum(pop)),.(age=pmin(age,95)%/%5*5)][,std:=std/sum(std)]

p=copy(b)[,dose:=ifelse(dose==1,&quot;Vaccinated&quot;,&quot;Unvaccinated&quot;)]
p=rbind(p,copy(b)[week&lt;3,dose:=0][,dose:=ifelse(dose==1,&quot;Vaccinated at least 21 days ago&quot;,&quot;Unvaccinated or vaccinated less than 21 days ago&quot;)])

p=p[,.(cmr=sum(dead)/sum(alive)*365e5),.(dose,age=pmin(age,95)%/%5*5,month)]
p=merge(std,p)[,.(asmr=sum(cmr*std)),.(dose,month)]
p[,dose:=factor(dose,unique(dose))]

p[,month:=as.Date(paste0(month,&quot;-1&quot;))]
xstart=as.Date(&quot;2020-12-1&quot;);xend=as.Date(&quot;2023-1-1&quot;)
p=p[month&gt;=xstart&amp;month&lt;=xend]

xbreak=seq(as.Date(&quot;2021-7-1&quot;),xend,&quot;year&quot;);xlab=year(xbreak)
ystep=500;ystart=0;yend=max(p$asmr,na.rm=T);ybreak=seq(ystart,yend,ystep)

ggplot(p,aes(x=month+15,y=asmr))+
geom_vline(xintercept=seq(as.Date(&quot;2021-1-1&quot;),as.Date(&quot;2023-1-1&quot;),&quot;year&quot;),linewidth=.5)+
geom_vline(xintercept=c(xstart,xend),linewidth=.5,lineend=&quot;square&quot;)+
geom_hline(yintercept=c(ystart,yend),linewidth=.5,lineend=&quot;square&quot;)+
geom_line(aes(color=dose,linetype=dose),linewidth=.7)+
geom_point(aes(color=dose,alpha=dose),stroke=0,size=1.1)+
labs(x=NULL,y=NULL,title=&quot;Czech record-level data: All-cause ASMR per 100,000 person-years&quot;,subtitle=&quot;The resident population estimates from the 2021 census by 5-year age groups were used as the standard population.&quot;|&gt;stringr::str_wrap(78))+
scale_x_date(limits=c(xstart,xend),breaks=xbreak,labels=xlab)+
scale_y_continuous(limits=c(ystart,yend),breaks=ybreak)+
scale_color_manual(values=hsv(c(21,0,21,0)/36,1,.8))+
scale_linetype_manual(values=c(&quot;solid&quot;,&quot;solid&quot;,&quot;42&quot;,&quot;42&quot;))+
scale_alpha_manual(values=c(1,1,0,0))+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
guides(color=guide_legend(ncol=2,byrow=F))+
theme(axis.text=element_text(size=11,color=&quot;black&quot;),
  axis.text.x=element_text(margin=margin(3)),
  axis.ticks=element_line(linewidth=.5),
  axis.ticks.length=unit(5,&quot;pt&quot;),
  axis.ticks.length.x=unit(0,&quot;pt&quot;),
  legend.background=element_blank(),
  legend.box.spacing=unit(0,&quot;pt&quot;),
  legend.justification=c(0,0),
  legend.key=element_blank(),
  legend.key.height=unit(12,&quot;pt&quot;),
  legend.key.width=unit(30,&quot;pt&quot;),
  legend.margin=margin(,,6),
  legend.position=&quot;top&quot;,
  legend.spacing.x=unit(3,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.text=element_text(size=11),
  legend.title=element_blank(),
  panel.background=element_blank(),
  panel.grid=element_blank(),
  plot.margin=margin(7,7,5,7),
  plot.subtitle=element_text(size=11,margin=margin(,,4)),
  plot.title=element_text(size=11.5,face=&quot;bold&quot;,margin=margin(,,5)))
ggsave(&quot;1.png&quot;,width=6,height=3.8,dpi=300*4)
system(&quot;mogrify -resize 25% -colors 256 1.png&quot;)</pre>
</div>
<p>And in the English ONS data when I classified people as unvaccinated
until 3 weeks from the first dose, it similarly gave a big advantage to
unvaccinated people, because it reduced unvaccinated CMR in early 2021
when the first dose was rolled out
(<a href=stat.html#Plot_CMR_by_age_group_when_people_are_classified_as_unvaccinated_until_3_weeks_from_vaccination>R
code</a>):</p>
<div>
<img src=i/czech-cheap-3.png width=500>
</div>
<h2>
<a href=#Kirschs_resurrected_claim_that_people_were_not_allowed_to_choose_if_they_got_a_Moderna_or_Pfizer_vaccine id=Kirschs_resurrected_claim_that_people_were_not_allowed_to_choose_if_they_got_a_Moderna_or_Pfizer_vaccine>Kirsch's
resurrected claim that people were not allowed to choose if they got a
Moderna or Pfizer vaccine</a>
</h2>
<p>In an early version of the README file of Kirsch's GitHub repository
about the Czech data, Kirsch wrote: <span class="quote">"Vaccines were
randomly distributed for those wishing to get vaxxed. [...] People were
not allowed to select which vaccines they got. [...] The randomization of
which vaccine someone got created a perfect real-world randomized
clinical trial where we could compute the mortality rates for 1 year
after Dose 2 for the two most popular vaccines."</span>
[<a href=https://github.com/skirsch/Czech/blob/5725ac1b64ede7124e00b72af68892f31736b349/README.md>https://github.com/skirsch/Czech/blob/5725ac1b64ede7124e00b72af68892f31736b349/README.md</a>]
After I showed him why his claim was likely wrong, he edited the README
file to remove the claim.</p>
<p>However in August 2024 when Kirsch was on InfoWars, he resurrected
his old claim that people were not allowed to choose if they got a
Moderna or Pfizer vaccine. He said: <span class="quote">"The only
difference in the Czech Republic between getting a Pfizer shot and a
Moderna shot is just pure luck. It was... you weren't allowed to choose,
you were just assigned a brand. So it's effectively like the world's
largest randomized trial."</span>
[<a href=https://x.com/RealAlexJones/status/1828912865107231096>https://x.com/RealAlexJones/status/1828912865107231096</a>,
time 45:51]</p>
<p>When I called Kirsch out for his comments on InfoWars, he asked me to
show evidence that people were allowed to choose which vaccine type they
got. But I showed him that there was a dropdown menu for choosing your
preferred vaccine type in a form for registering a vaccination
appointment:
[<a href=https://ockodoc.mzcr.cz/wp-content/uploads/2023/07/manual_crs.pdf>https://ockodoc.mzcr.cz/wp-content/uploads/2023/07/manual_crs.pdf</a>;
translated with Yandex]</p>
<div>
<img src=i/czech-preferred-form-2.jpg width=600>
</div>
<p>However I don't know if people were not initially allowed to choose
the vaccine type, because an article dated May 2021 said: <span
class="quote">"You cannot currently choose which vaccine to get. Odds
are you will get the Pfizer/BioNTech vaccine, as that one so far has
been the most widely available, accounting for about three-fourths of
the deliveries."</span>
[<a href=https://www.expats.cz/czech-news/article/vaccination-in-the-czech-republic-all-you-need-to-know>https://www.expats.cz/czech-news/article/vaccination-in-the-czech-republic-all-you-need-to-know</a>]</p>
<p>Added in February 2025: Kirsch included my screenshot above in one of
his earlier Substack posts about the Czech data, but for some reason now
he again wrote: <span class="quote">"But vaccine brands were
QUASI-RANDOMLY distributed in the Czech Republic. People didn't get to
choose. They got what was available. There was no systemic or systematic
bias in the distribution."</span> However someone from the Czech
Republic corrected him in the comments and wrote: <span
class="quote">"Reservations for a specific <span
class="quote">'vaccine'</span> were possible through an online
reservation system, which began operating about 2 months after the start
of the vaccination campaign."</span>
[<a href=https://kirschsubstack.com/p/breaking-official-czech-record-level/comment/90222598>https://kirschsubstack.com/p/breaking-official-czech-record-level/comment/90222598</a>]</p>
<p>I also posted this comment to Kirsch:</p>
<blockquote>
<p>And also how do you differentiate whether the vaccines were
distributed quasi-randomly or not quasi-randomly?</p>
<p>There's a bunch of biases like that Moderna recipients were older,
had higher age-normalized comorbidity index, were vaccinated later, had
higher age-normalized rate of vaccinators whose name matched <span
class="quote">"senior home"</span>, and so on. So at what point do those
biases become severe enough that you would say the vaccines were not
distributed quasi-randomly?</p>
<p>Or how do you differentiate between a systematic bias and a
non-systematic bias? ChatGPT said that <span class="quote">"Systematic
bias leads to consistently skewed results in a particular direction,
whereas nonsystematic bias results in random fluctuations around the
true value."</span> ChatGPT said that the effect of nonsystematic biases
averages out over time, and as an example of a nonsystematic bias,
ChatGPT gave that <span class="quote">"If a scale sometimes
overestimates or underestimates weight by small amounts in random ways,
it introduces nonsystematic bias."</span></p>
<p>However in the case of the Czech data, the reason why Moderna
recipients have higher average age than Pfizer recipients is not only
due to random noise caused by a small sample size, or what ChatGPT
suggested was a <span class="quote">"nonsystematic bias"</span>, but the
age distribution seems to be systematically skewed.</p>
</blockquote>
<h2>
<a href=#Mortality_rate_of_people_born_before_1930_calculated_by_Tom_F_rst id=Mortality_rate_of_people_born_before_1930_calculated_by_Tom_F_rst>Mortality
rate of people born before 1930 calculated by Tomáš Fürst</a>
</h2>
<p>Tomáš Fürst posted this plot which shows that among people who were
born in 1929 or earlier, vaccinated people had higher mortality than
unvaccinated people starting from late 2021:
[<a href=https://smis-lab.cz/2024/08/17/celkova-umrtnost-ceskych-obyvatel-dle-vakcinacniho-statutu-nejstarsi-rocniky/>https://smis-lab.cz/2024/08/17/celkova-umrtnost-ceskych-obyvatel-dle-vakcinacniho-statutu-nejstarsi-rocniky/</a>]</p>
<div>
<img src=i/czech-furst-1.png width=800>
</div>
<p>In the following code I took data from one of my buckets files where
I had assigned a random birthday for each person so I could account for
the aging of people over time with a sub-year precision. From the last
column which shows the total mortality rate in 2021-2022, you can see
that unvaccinated people had higher mortality than vaccinated people up
to age 94, but in ages 95 and above vaccinated people had higher
mortality:</p>
<div>
<img src=i/czech-furst-2.png width=800>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>b=fread(&quot;http://sars2.net/f/czbucketsdaily.csv.gz&quot;)

agecut=\(x,y)cut(x,c(y,Inf),paste0(y,c(ifelse(head(y,-1)==y[-1]-1,&quot;&quot;,paste0(&quot;-&quot;,y[-1]-1)),&quot;+&quot;)),T,F)
ages=c(0:9*10,91:105)

a=b[date&gt;=&quot;2021-1-1&quot;,.(alive=sum(alive),dead=sum(dead)),.(dose=pmin(dose,1),age=agecut(age,ages),month=substr(date,1,7))]
a=rbind(a,a[,.(dead=sum(dead),alive=sum(alive),month=&quot;Total&quot;),.(dose,age)])
ar=a[,tapply(dead/alive,.(dose,age,month),c)]

m1=ar[1,,];m2=ar[2,,]
m=(m2-m1)/ifelse(m2&gt;m1,m1,m2)*100
disp=round(m2/m1*100)
maxcolor=600;exp=.85

pheatmap::pheatmap(abs(m)^exp*sign(m),filename=&quot;0.png&quot;,display_numbers=disp,
  gaps_col=ncol(m)-1,gaps_row=9,
  cluster_rows=F,cluster_cols=F,legend=F,cellwidth=19,cellheight=19,fontsize=9,fontsize_number=8,
  border_color=NA,na_col=&quot;gray90&quot;,
  number_color=ifelse((abs(m)^exp&gt;.55*maxcolor^exp)&amp;!is.na(m),&quot;white&quot;,&quot;black&quot;),
  breaks=seq(-maxcolor^exp,maxcolor^exp,,256),
  colorRampPalette(hsv(rep(c(7/12,0),5:4),c(.9,.75,.6,.3,0,.3,.6,.75,.9),c(.4,.65,1,1,1,1,1,.65,.4)))(256))

cap=&quot;Czech record-level data: Vaccinated CMR as percentage of unvaccinated CMR&quot;
system(paste0(&quot;w=`identify -format %w 0.png`;pad=24;convert -pointsize 42 -interline-spacing -3 -font Arial-Bold \\( -size $[w-pad*2]x caption:&#39;&quot;,cap,&quot;&#39; -splice $[pad]x20 \\) 0.png -append 1.png&quot;))</pre>
</div>
<p>Elderly people who live in a senior home have higher ASMR than
elderly people who live on their own, and I don't know if for example
elderly people who live in a senior home are more likely to be
vaccinated than age-matched elderly people who live on their own.</p>
<p>The plot above shows that for some reason in ages 104 and 105+
vaccinated people had more than 10 times as high mortality as
unvaccinated people. For people who were born in 1917 so they turned 104
in 2022, people who were born near the end of the year were much more
likely to be alive in 2022 than people who were born near the beginning
of the year, but my code for assigning a random birthday distributed the
birthdays evenly across the year which resulted in a fairly large bias
in the case of the very oldest age groups. However it shouldn't matter
that much here because I'm simply comparing vaccinated mortality rate
against unvaccinated mortality rate. So I don't know how to explain the
extremely high percentages in ages 104 and 105+.</p>
<p>But in any case Fürst could've mentioned that there was a sharp
increase in the ratio of unvaccinated to vaccinated CMR around ages 94
to 95, but in younger ages unvaccinated people had higher mortality.</p>
<h2>
<a href=#Plot_for_raw_deaths_by_weeks_after_vaccination id=Plot_for_raw_deaths_by_weeks_after_vaccination>Plot
for raw deaths by weeks after vaccination</a>
</h2>
<p>If you look at the raw number of deaths by weeks after vaccination
but you don't normalize it for the background mortality rate, dose 1
seems to have a bump in deaths around weeks 2 to 10 that's missing for
doses 2 and 3. But that's because during the first weeks after dose 1
the background mortality rate was falling rapidly because the COVID wave
in early 2021 was passing by. So here when I calculated a baseline in a
way where I accounted for the background mortality rate, the baseline
for dose 1 has a much bigger drop during the first 15 weeks after
vaccination than the baselines of doses 2 and 3:</p>
<div>
<img src=i/czech-rawweek.png width=700>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table);library(ggplot2);library(stringr)

b=fread(&quot;http://sars2.net/f/czbucketskeep.csv.gz&quot;)[,age:=pmin(age,95)%/%5*5]
d=merge(b[dose%in%1:4],b[dose&lt;=1,.(base=sum(dead)/sum(alive)),.(month,age)])[,base:=base*alive]
p=d[,.(y=sum(dead),base=sum(base),pop=sum(alive)),.(x=week,z=paste0(&quot;Dose &quot;,dose))]

xstart=0;xend=105;xstep=5;ystart=0;yend=3000;ystep=500

color=hsv(c(12,21,24,30)/36,c(.4,.6,.8,.8),c(.9,1,.7,.6))

sub=paste0(&quot;      &quot;,&quot;The dashed line is a baseline which was calculated by multiplying the number of person-days for each combination of 5-year age group and ongoing month with the mortality rate among all people who are included in the record-level data for the same combination of age group and ongoing month.&quot;|&gt;str_wrap(90))
sub=paste0(sub,&quot;\n      &quot;,&quot;People are kept under earlier doses after a new dose. Week 0 consists of the day of vaccination and the next 6 days.&quot;|&gt;str_wrap(90))

ggplot(p,aes(x,y))+
geom_hline(yintercept=c(ystart,0,yend),linewidth=.3,lineend=&quot;square&quot;)+
geom_vline(xintercept=c(xstart,xend),linewidth=.3,lineend=&quot;square&quot;)+
geom_line(aes(color=z),linewidth=.4)+
geom_line(aes(y=base,color=z),linetype=2,linewidth=.4)+
labs(title=&quot;Czech record-level data: Deaths by weeks after vaccination&quot;,subtitle=sub,x=NULL,y=NULL)+
scale_x_continuous(limits=c(xstart,xend),breaks=seq(xstart,xend,xstep))+
scale_y_continuous(limits=c(ystart,yend),breaks=seq(ystart,yend,ystep))+
scale_color_manual(values=color)+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
theme(axis.text=element_text(size=7,color=&quot;black&quot;),
  axis.ticks=element_line(linewidth=.3),
  axis.ticks.length=unit(3,&quot;pt&quot;),
  legend.background=element_rect(fill=&quot;white&quot;,color=&quot;black&quot;,linewidth=.3),
  legend.justification=c(1,1),
  legend.key.height=unit(11,&quot;pt&quot;),
  legend.key.width=unit(15,&quot;pt&quot;),
  legend.key=element_rect(fill=&quot;white&quot;),
  legend.margin=margin(-2,7,3,6),
  legend.position=c(1,1),
  legend.spacing.x=unit(2,&quot;pt&quot;),
  legend.text=element_text(size=7),
  legend.title=element_blank(),
  panel.grid.major=element_line(linewidth=.3,color=&quot;gray90&quot;),
  panel.background=element_rect(fill=&quot;white&quot;),
  plot.margin=margin(4,10,4,4),
  plot.subtitle=element_text(size=7,margin=margin(0,0,4,0)),
  plot.title=element_text(size=7.5,face=&quot;bold&quot;,margin=margin(2,0,4,0)))
ggsave(&quot;0.png&quot;,width=4.5,height=3.2,dpi=400*4)
system(&quot;magick 0.png -filter lanczos2 -resize 25% 1.png&quot;)</pre>
</div>
<p>In the United States first doses were also given at a time when the
COVID wave in early 2021 was passing by, which I think explains why the
temporal HVE appears to last only about 3 weeks in Kirsch's Medicare
data for 2021. But the temporal HVE seems to last longer in the Medicare
data for 2022 which is missing the bump around the third week:
[<a href=moar.html#US_Medicare_data>moar.html#US_Medicare_data</a>]</p>
<div>
<img src=i/moar-medicare-15.png width=600>
</div>
<h2>
<a href=#Kirschs_calculation_for_mortality_rate_by_batch id=Kirschs_calculation_for_mortality_rate_by_batch>Kirsch's
calculation for mortality rate by batch</a>
</h2>
<p>Kirsch picked 9 batches that were given to at last 100 people in ages
70 to 74 in February 2021, and he then calculated a mortality rate for
each batch during the first year from vaccination:
[<a href=https://kirschsubstack.com/p/covid-vax-some-batches-increase-your>https://kirschsubstack.com/p/covid-vax-some-batches-increase-your</a>]</p>
<div>
<img src=i/czech-kirschbatch-2.jpg width=600>
</div>
<p>Kirsch wrote that <span class="quote">"there was &gt;9X variation
between the most deadly Moderna vaccine batch and the safest Pfizer
vaccine batch"</span>. However actually the ratio of the two batches
that are shown in red in his table is only about 8.5 (from
<code>.10989/.013001</code>). The ratio becomes over 9 if you compare
the Moderna vaccines with a missing batch ID against the Pfizer batch
with the highest rate (<code>.12/.013001</code>). But I don't think it
makes sense to treat the doses with a missing batch ID as a distinct
batch.</p>
<p>But anyway, the sample sizes in his table are way too small because
he restricted his analysis to only a single age group and a single month
of vaccination.</p>
<p>In the code below I calculated a normalized excess mortality percent
for each batch up to the end of 2022, so that I multiplied the number of
person-days for each combination of 5-year age group and ongoing month
with the mortality rate among all people who are included in the
record-level data for the same combination of 5-year age group and
ongoing month. I kept people included under a batch even after a dose
from another batch.</p>
<p>I got about 19% excess mortality for the Moderna batch 300042721
which was Kirsch's batch with the highest mortality rate, and I got
about -16% excess mortality for the Pfizer batch EJ6797 which was
Kirsch's batch with the lowest mortality rate. So the Pfizer batch had
only about 1.39 times higher normalized mortality (from
<code>119.64/86.28</code>):</p>
<pre>&gt; library(data.table)
&gt; download.file(&quot;http://sars2.net/f/czbucketsbatchkeep.csv.xz&quot;,&quot;czbucketsbatchkeep.csv.xz&quot;)
&gt; b=fread(&quot;xz -dc czbucketsbatchkeep.csv.xz&quot;)[,age:=pmin(age,95)%/%5*5]
&gt; a=merge(b[dose&gt;0&amp;batch!=&quot;&quot;&amp;type!=&quot;Other&quot;],b[dose&lt;=1,.(base=sum(dead)/sum(alive)),.(age,month)])[,base:=base*alive]
&gt; a=a[,.(alive=sum(alive),dead=sum(dead),base=sum(base)),.(batch,age,type)]
&gt; p=a[,.(excess=(sum(dead)/sum(base)-1)*100),.(batch,type)]
&gt; print(p[batch%in%c(&quot;300042721&quot;,&quot;EJ6797&quot;)][order(-excess)],nrow=Inf)
       batch    type    excess
1: 300042721 Moderna  19.63627
2:    EJ6797  Pfizer -16.28020</pre>
<p>I posted code for generating the <code>czbucketsbatchkeep.csv</code>
file here:
<a href=czech2.html#Statistics_by_batch>czech2.html#Statistics_by_batch</a>.
In the code I assigned a random birthday to each person so that I could
model the aging of people with a daily precision.</p>
<p>Kirsch wrote that for people in ages 60 to 64 who got a second dose
in June 2021, the Pfizer batch FC2473 got more than 3 times higher
mortality rate within a year from vaccination than the Pfizer batch
FD0168:</p>
<div>
<img src=i/czech-kirschbatch-1.jpg width=600>
</div>
<p>However using the code above my total normalized excess mortality was
about -32% for the FC batch and about -39% for the FD batch, so there
was not much difference. I included all doses instead of only second
doses like Kirsch. I included all age groups and all vaccination months,
and I calculated the excess mortality up to the end of 2022 and not
during the first year from vaccination.</p>
<p>Kirsch got 48 deaths out of 6238 doses for the FC batch. The upper
bound of the 95% confidence interval for the ratio is about twice as the
high as the lower bound:</p>
<pre>&gt; as.numeric(prop.test(48,6238)$conf)
[1] 0.005739933 0.010277757</pre>
<p>In the following block of code I picked people who got a second dose
from the FC or FD batch in June 2021 and I divided the number of deaths
in the 365 days starting from the day of vaccination with the number of
doses from the batch. I treated the age of each person as their year of
birth subtracted from 2021. I kept people included under a batch even
after they got a dose from another batch.</p>
<p>I converted the batch IDs to uppercase and stripped trailing spaces,
which is what Kirsch also did.
[<a href=https://github.com/skirsch/Czech/blob/main/code/vax.py#L59>https://github.com/skirsch/Czech/blob/main/code/vax.py#L59</a>]</p>
<p>When I calculated the ratio of deaths per doses for each 5-year age
group, the FD batch actually got a higher mortality rate than the FC
batch in each age group from 65-69 to 85-89 (which all had a fairly
large sample size of deaths):</p>
<pre>rec=fread(&quot;CR_records.csv&quot;)
d=rec[,.(date=as.IDate(unlist(rec[,.SD,.SDcols=patterns(&quot;Datum_&quot;)],,F)),dead=DatumUmrti,age=2021-Rok_narozeni)]
d[,batch:=unlist(rec[,.SD,.SDcols=patterns(&quot;Sarze_&quot;)],,F)][,batch:=toupper(trimws(batch)),batch]
d$dose=rep(1:7,each=nrow(rec))

a=d[dose==2&amp;date&gt;=&quot;2021-06-01&quot;&amp;date&lt;&quot;2021-07-01&quot;]
a=a[,.(dead=sum(!is.na(dead)&amp;dead-date&lt;365),doses=.N),.(batch,age=pmin(age,95)%/%5*5)]

a1=a[batch==&quot;FC2473&quot;,.(age,dead1=dead,doses1=doses,rate1=dead/doses*1e5)]
a2=a[batch==&quot;FD0168&quot;,.(age,dead2=dead,doses2=doses,rate2=dead/doses*1e5)]
o=merge(a1,a2)

o[,rate1vs2:=rate1/rate2]
o[,low:=exp(log(rate1vs2)-qnorm(.975)*sqrt(1/dead1+1/dead2))]
o[,high:=exp(log(rate1vs2)+qnorm(.975)*sqrt(1/dead1+1/dead2))]

print(round(o,2),row.names=F)</pre>
<!-- -->
<pre>     # FC2473              # FD0168              # FC vs FD with 95% CI
 age dead1 doses1    rate1 dead2 doses2    rate2 rate1vs2  low  high
  15     1    179   558.66     1    709   141.04     3.96 0.25 63.32
  20     1    970   103.09     2   2280    87.72     1.18 0.11 12.96
  25     0   1706     0.00     1   3469    28.83     0.00 0.00   NaN
  30     2   2069    96.67     5   4877   102.52     0.94 0.18  4.86
  35     1   2682    37.29     1   6452    15.50     2.41 0.15 38.46
  40     8   4111   194.60    11  11006    99.95     1.95 0.78  4.84
  45    16   4993   320.45    19  19186    99.03     3.24 1.66  6.29
  50    29   4482   647.03    66  28524   231.38     2.80 1.81  4.33
  55    38   5404   703.18   148  65597   225.62     3.12 2.18  4.45
  60    84   8560   981.31   318  75389   421.81     2.33 1.83  2.96
  65   240  31491   762.12   474  58382   811.89     0.94 0.80  1.10 # ratio below 1
  70   203  16682  1216.88   301  17613  1708.96     0.71 0.60  0.85 # ratio below 1
  75   109   3595  3031.99   213   6880  3095.93     0.98 0.78  1.23 # ratio below 1
  80    54    934  5781.58   156   2365  6596.19     0.88 0.64  1.19 # ratio below 1
  85    44    440 10000.00   115   1017 11307.77     0.88 0.62  1.25 # ratio below 1
  90    36    160 22500.00    59    335 17611.94     1.28 0.84  1.93
  95    18     46 39130.43    14     50 28000.00     1.40 0.70  2.81</pre>
<p>My ratio in ages 60 to 64 was only about 2.33 and not 3.15 like in
Kirsch's table. But I eventually figured out it was because of these
three reasons:</p>
<ol type="1">
<li>Kirsch treated the age of each person as the year of birth
subtracted from 2024 and not from 2021 like me. When I ran the code
above but I changed 2021 to 2024, my ratio increased to about 3.07. When
Kirsch subtracted the year of birth from 2024, he overestimated the age
of people by 3 or 4 years on the day of vaccination and by 2 to 4 years
during the whole observation period. But when I subtracted the year of
birth from 2021, I got the age of each person on December 31st 2021
which was roughly the average age of people during the observation
period which lasted from June 2021 until June 2022.</li>
<li>Kirsch looked at deaths during the first 366 days from vaccination
if the day of vaccination is included but I only included the first 365
days. However my ratio remained at 3.07 even after I changed the
observation period from 365 days to 366 days.</li>
<li>Kirsch's code had a bug where he counted how many people died within
a year from the first dose even when he generated the column that showed
how many people died within a year from the second dose. It's because
this line had <code>df['date_1_']</code> regardless of the dose number:
<code>df['days_until_death'] = (df[dod_col] - df['date_1_']).dt.days.round(0)</code>.
[<a href=https://github.com/skirsch/Czech/blob/eb8406c7c160f3951d798f5cd72a7c84901a60c4/code/vax.py#L117>https://github.com/skirsch/Czech/blob/eb8406c7c160f3951d798f5cd72a7c84901a60c4/code/vax.py#L117</a>]
Kirsch fixed the bug after I pointed it out to him.</li>
</ol>
<p>Kirsch later added this section to his Substack post:</p>
<div>
<img src=i/czech-kirschbatch-3.jpg width=600>
</div>
<p>The plot above is a histogram where the y-axis values are always
integers, so it's confusing how the y-axis labels include values like
0.5 and 1.5.</p>
<p>Kirsch wrote that <span class="quote">"if the vaccines were safe, the
mortality rates of the batches I looked at (given to a given group in a
specific time period) must have a normal distribution"</span>. But
that's not necessarily the case if there's confounding factors that vary
across batches even after age and month of vaccination are controlled
for.</p>
<p>Kirsch's plot had so few batches that it was difficult to even tell
if his plot followed a normal distribution or not. And his sample size
of total deaths was also fairly small because he only looked at vaccines
given in March 2021, but he could've increased his sample size if he
would've included all months of vaccination in his plot.</p>
<p>In the histogram plot below I calculated a normalized mortality rate
for each batch the same way as earlier, except I plotted the mortality
rate as a percentage of the baseline and not as excess mortality
relative to the baseline (so now the values are the same as excess
mortality values plus 100). I included only batches with at least 10,000
total person-years. But now in my histogram the distribution of
mortality rates looks closer to a normal distribution than in Kirsch's
plot (even though in plots like this which show excess mortality as a
percentage of a baseline, the distribution is typically skewed because
the values below 100% typically have a more narrow spread than the
values above 100%):</p>
<div>
<img src=i/czech-kirschbatch-4.png width=500>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>b=fread(&quot;xz -dc czbucketsbatchkeep.csv.xz&quot;)[,age:=pmin(age,95)%/%5*5]

a=merge(b[dose&gt;0&amp;batch!=&quot;&quot;&amp;type!=&quot;Other&quot;],b[dose&lt;=1,.(base=sum(dead)/sum(alive)),.(age,month)])[,base:=base*alive]
a=a[,.(alive=sum(alive),dead=sum(dead),base=sum(base)),.(batch,age,type)]
keep=a[,sum(alive),batch][V1/365&gt;=1e4,batch]
a=a[batch%in%keep,.(mort=sum(dead)/sum(base)*100),batch]

step=10;lev=seq(0,max(a$mort),step);yend=30
p=data.table(x=paste0(&quot;[&quot;,lev,&quot;,&quot;,lev+step,&quot;)&quot;),y=as.integer(table(factor(a$mort%/%step*step,lev))))
p[,x:=factor(x,unique(x))]

png(&quot;1.png&quot;,1300,800,res=200)
par(mar=c(5,2.3,1.9,0),mgp=c(0,0.6,0))
tit=&quot;Histogram of batch mortality percentage relative to baseline&quot;
barx=barplot(p$y,names.arg=p$x,main=tit,cex.main=1.1,xlab=NA,ylab=NA,lwd=1.5,las=2,space=0,ylim=c(0,yend))
text(x=barx,y=p$y-.01*yend,labels=p$y,pos=3,cex=0.8)
dev.off()</pre>
</div>
<p>In the next plot I calculated ASMR using 5-year age groups but I
didn't normalize it in any way for ongoing month or month of
vaccination. I again included only batches with at least 10,000
person-years. However now the distribution looked less similar to a
normal distribution:</p>
<div>
<img src=i/czech-kirschbatch-5.png width=500>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>b=fread(&quot;xz -dc czbucketsbatchkeep.csv.xz&quot;)
b[,age:=ifelse(age&lt;25,0,pmin(age,95)%/%5*5)]

std=fread(&quot;czcensus2021pop.csv&quot;)[,.(std=sum(pop)),.(age=ifelse(age&lt;25,0,pmin(age,95)%/%5*5))][,std:=std/sum(std)]
a=b[dose&gt;0&amp;batch!=&quot;&quot;&amp;type!=&quot;Other&quot;,.(dead=sum(dead),alive=sum(alive)),.(batch,age)]
a=merge(std,a)[alive/365&gt;=1e4,.(asmr=sum(dead/alive*std*365e5)),batch]

step=50;max=max(a$asmr);lev=seq(0,max,step);yend=10
p=data.table(x=paste0(&quot;[&quot;,lev,&quot;,&quot;,lev+step,&quot;)&quot;),y=as.integer(table(factor(a$asmr%/%step*step,lev))))
p[,x:=factor(x,unique(x))]

png(&quot;1.png&quot;,1300,800,res=200)
par(mar=c(5,2.3,1.9,0),mgp=c(0,.6,0))
tit=&quot;Histogram of batch ASMR&quot;
barx=barplot(p$y,names.arg=p$x,main=tit,cex.main=1.1,xlab=NA,ylab=NA,lwd=1.5,las=2,space=0,ylim=c(0,yend))
text(x=barx,y=p$y-.01*yend,labels=p$y,pos=3,cex=.8)
dev.off()</pre>
</div>
<h2>
<a href=#Confidence_intervals_for_age_normalized_Moderna_Pfizer_ratio_by_month_of_vaccination id=Confidence_intervals_for_age_normalized_Moderna_Pfizer_ratio_by_month_of_vaccination>Confidence
intervals for age-normalized Moderna-Pfizer ratio by month of
vaccination</a>
</h2>
<p>Kirsch said that in my triangle plot which showed an age-normalized
Moderna-Pfizer ratio by month of vaccination and ongoing month, the
results were not statistically significant from July 2021 onwards:
[<a href=https://kirschsubstack.com/p/a-closer-look-at-the-czech-data-confirms>https://kirschsubstack.com/p/a-closer-look-at-the-czech-data-confirms</a>]</p>
<div>
<img src=i/czech-ci-1.jpg width=700>
</div>
<p>Kirsch seems to have determined statistical significance on each row
of my heatmap by calculating the mean and standard deviation of each
column and then looking at whether the mean was at least 2 standard
deviations above 1, so for example in July 2021 he calculated the mean
and standard deviation for a vector of monthly values like 0.64, 1.07,
1.72, 1.52, 0.88, and so on:</p>
<div>
<img src=i/czech-ci-2.jpg width=600>
</div>
<p>I don't think his approach was correct, because he should've taken
into account the number of deaths and baseline deaths for Moderna and
Pfizer vaccinees. I'm not sure if the following is the correct approach
either, but when I asked ChatGPT how to calculate the confidence
interval for the Moderna-Pfizer ratio for people vaccinated in July
2021, it gave me code like this, where the 95% CI was about 1.20 to 1.53
so the lower bound of the CI was still clearly above 1:</p>
<pre>dead1=284;dead2=2266
base1=252.52;base2=2725.01
rate1=dead1/base1;rate2=dead2/base2
ratio=rate1/rate2

se1=sqrt(dead1)/base1;se2=sqrt(dead2)/base2
se=sqrt((se1/rate1)^2+(se2/rate2)^2)
exp(log(ratio)+c(-1,1)*qnorm(.975)*se)
# [1] 1.195500 1.530073</pre>
<p>When I asked ChatGPT how to calculate whether the result was
statistically significant, it said <span class="quote">"To assess if the
result is statistically significant, we check if the 95% confidence
interval for the ratio excludes 1. If the interval excludes 1, it
indicates that there is a statistically significant difference between
the Moderna and Pfizer rates."</span></p>
<p>When I asked how to calculate a p-value for the result, ChatGPT
answered: <span class="quote">"To calculate the p-value, we need to test
the null hypothesis that the ratio of the two rates is equal to 1. This
can be done using a Wald test, which compares the observed value of the
ratio to the null value (1), using the standard error of the ratio to
compute a Z-score. The p-value is then obtained from the
Z-score."</span> And it gave me this code which gave me a p-value of
about 2e-6:</p>
<pre>z_score=log(ratio)/se
2*(1-pnorm(abs(z_score)))
# [1] 1.6133e-06</pre>
<p>Here when I applied the same method of calculating confidence
intervals to all months of vaccination, I got fairly narrow confidence
intervals up to January 2022:</p>
<pre>b=fread(&quot;http://sars2.net/f/czbucketskeep.csv.gz&quot;)
b=b[month&gt;=&quot;2020-12&quot;&amp;dose&lt;=1][,age:=pmin(age,100)]
t=b[,.(dead=sum(dead),alive=as.numeric(sum(alive))),.(age,month,vaxmonth,type)]
t=merge(t,t[,.(base=sum(dead)/sum(alive)),age])[,base:=base*alive]

a=t[,.(dead=sum(dead),base=sum(base)),.(vaxmonth,type)]
a1=a[type==&quot;Moderna&quot;,.(vaxmonth,dead1=dead,base1=base)]
a2=a[type==&quot;Pfizer&quot;,.(vaxmonth,dead2=dead,base2=base)]
o=merge(a1,a2)

rate1=o[,dead1/base1];rate2=o[,dead2/base2]
o[,ratio:=rate1/rate2]
se1=o[,sqrt(dead1)/base1];se2=o[,sqrt(dead2)/base2]
se=sqrt((se1/rate1)^2+(se2/rate2)^2)
o[,low:=exp(log(ratio)-qnorm(.975)*se)]
o[,high:=exp(log(ratio)+qnorm(.975)*se)]

mutate_if(o,is.double,round,2)|&gt;print(r=F)</pre>
<!-- -->
<pre> vaxmonth dead1   base1 dead2    base2 ratio  low  high
  2021-01  1515  744.34 18513 21218.40  2.33 2.21  2.46
  2021-02  3501 3732.26 13979 19466.04  1.31 1.26  1.36
  2021-03  4961 6404.36 19616 32300.32  1.28 1.24  1.32
  2021-04  2887 3748.78 16321 26352.89  1.24 1.20  1.29
  2021-05  2186 2433.25 12130 21496.87  1.59 1.52  1.67
  2021-06  1674 1510.94  3761  5030.32  1.48 1.40  1.57
  2021-07   284  252.52  2266  2725.01  1.35 1.20  1.53
  2021-08   136  125.80  1080  1118.41  1.12 0.94  1.34
  2021-09   157   93.80   744   586.62  1.32 1.11  1.57
  2021-10    99   78.51   754   557.74  0.93 0.76  1.15
  2021-11   282  222.76  2275  1838.82  1.02 0.90  1.16
  2021-12   249  163.23  1306   871.66  1.02 0.89  1.17
  2022-01    81   47.04   585   342.17  1.01 0.80  1.27
  2022-02    13    8.14   125    55.09  0.70 0.40  1.25
  2022-03     2    3.08    46    17.62  0.25 0.06  1.03
  2022-04     0    0.81    19    10.48  0.00  NaN   NaN
  2022-05     0    0.45    20     8.44  0.00  NaN   NaN
  2022-06     0    0.25    12     4.52  0.00  NaN   NaN
  2022-07     2    0.77    10     4.49  1.17 0.26  5.34
  2022-08     1    0.87    21     8.76  0.48 0.06  3.55
  2022-09     1    0.53    20     7.98  0.76 0.10  5.66
  2022-10     0    0.12    14     3.93  0.00  NaN   NaN
  2022-11     1    0.07     3     1.45  6.85 0.71 65.81
  2022-12     0    0.00     0     0.26   NaN  NaN   NaN
 vaxmonth dead1   base1 dead2    base2 ratio  low  high</pre>
<h2>
<a href=#The_record_level_data_includes_vaccination_entries_for_people_older_than_the_oldest_known_Czech_citizens id=The_record_level_data_includes_vaccination_entries_for_people_older_than_the_oldest_known_Czech_citizens>The
record-level data includes vaccination entries for people older than the
oldest known Czech citizens</a>
</h2>
<p>The record-level dataset contains an entry for a man whose year of
birth is 1912 but who got vaccinated in 2023 when he would've been 110
or 111 years old:</p>
<pre>&gt; t=fread(&quot;curl https://github.com/skirsch/Czech/blob/main/data/CR_records.csv.xz|xz -dc&quot;)
&gt; t[Rok_narozeni&lt;1913,1:4]
    Pohlavikod Rok_narozeni DatumUmrti    Datum_1
 1:          M         1912       &lt;NA&gt; 2021-09-24
 2:          F         1912 2021-07-22 2021-02-11
 3:          F         1911       &lt;NA&gt; 2021-07-27
 4:          F         1911 2020-12-06       &lt;NA&gt;
 5:          F         1910       &lt;NA&gt; 2021-03-28
 6:          F         1912 2020-05-12       &lt;NA&gt;
 7:          F         1912 2021-10-22       &lt;NA&gt;
 8:          M         1912       &lt;NA&gt; 2023-11-29
 9:          F         1912       &lt;NA&gt;       &lt;NA&gt;
10:          F         1912       &lt;NA&gt;       &lt;NA&gt;
11:          F         1912       &lt;NA&gt;       &lt;NA&gt;
12:          F         1912       &lt;NA&gt;       &lt;NA&gt;</pre>
<p>However according to the Czech-language Wikipedia, there have not
been male Czech citizens older than 107 years since at least 2010.
[<a href=https://cs.wikipedia.org/wiki/Seznam_nejstar%C5%A1%C3%ADch_obyvatel_%C4%8Ceska>https://cs.wikipedia.org/wiki/Seznam_nejstar%C5%A1%C3%ADch_obyvatel_%C4%8Ceska</a>]</p>
<h2>
<a href=#New_record_level_dataset_with_columns_for_cases_hospitalizations_and_comorbidity_index id=New_record_level_dataset_with_columns_for_cases_hospitalizations_and_comorbidity_index>New
record-level dataset with columns for cases, hospitalizations, and
comorbidity index</a>
</h2>
<p>In November 2024 ÚZIS (the Czech institute of health information and
statistics) published a new dataset which contains columns for
infections and hospitalizations. However the year of birth is only given
in 5-year ranges and dates of vaccination and death are given on a
weekly and not daily precision. SMIS published the following blog post
about the data (translated from Czech):
[<a href=https://smis-lab.cz/2024/11/07/dalsi-velka-datova-sada-uzis-zverejnena/>https://smis-lab.cz/2024/11/07/dalsi-velka-datova-sada-uzis-zverejnena/</a>]</p>
<blockquote>
<p>After a long time, we received
<a href=https://www.nzip.cz/data/2135-covid-19-prehled-populace>another
large data set</a> from ÚZIS. At first glance, this seems like a holy
grail, as the field descriptions indicate that the data contains
individual-level information on birth quintile, gender, calendar weeks
of all covid vaccines, calendar week of death, and cause of death
(covid/non-covid). In addition, the data includes information on tests
and covid hospitalizations. No country in the world has yet (completely
incomprehensible to us) published such a data set.</p>
<p>However, a closer look <strong>at the data raises many
doubts.</strong></p>
<p>1. <strong>The file contains 12,597,668 lines</strong> , which is
suspiciously large. Even if the second, third, and other infections that
are marked as duplicates in the data description are excluded, that
leaves 12,125,969 rows, which is still a lot. There are not that many
people in the Czech Republic, even if all the dead since 2020 are
included.</p>
<p>2. <strong>The file does not contain an (anonymized) person
identifier</strong> , so it is not possible to match lines that belong
to the same person. It is therefore not possible to link the data on
vaccination with the data on death and its cause. Therefore, it is also
impossible to find out what duplications are the reason for the previous
point.</p>
<p>3. When examining the <span class="quote">"DatumUmrtiLPZ"</span>
column, we find that the numbers listed there approximately correspond
to the course of death according to the CZSO. Until the end of 2022, the
difference in the weekly number of deaths compared to the CZSO will not
exceed one percent, but in the second half of 2024 it will already grow
to tens of percent. <strong>Data on deaths are therefore usable until
the end of 2023 at most</strong>. However, even the differences compared
to the CZSO in the statistics for the weeks of 2020-2023 are suspicious
and should not be there.</p>
<p>4. A far bigger problem, however, is that a total of
<strong>1,556,198 lines of the file contain no data</strong> (except for
DCCI=0), i.e. neither birth nor gender data. Similarly, we have 63,606
rows that contain only the date of death, again without data on birth
and sex. A substantial part of these deaths occurred in 2020, and when
compared with the data from CSU, it is clear that these deaths actually
occurred. Not only can these deaths not be matched to a cause of death,
but they cannot even be assigned to a given age group and gender. It is
therefore not possible to calculate any mortality rate, as it is always
dramatically dependent on age and sex.</p>
<p><strong>Thus, this data set is worthless for analysis.</strong> At
the same time, its investigation already cost several statisticians
hours of time. We will inform the ÚZIS about the problems described
above through the applicant and request the publication of data in the
same format as
<a href=https://smis-lab.cz/2024/07/21/skutecne-dlouha-data-po-skutecne-dlouhe-dobe-aneb-vivat-cecija/>here</a>,
with the fact that the relevant period will be extended at least until
the end of 2023 and a column will be added as to whether the death was
caused by covid or not.</p>
</blockquote>
<p>The file contains these columns:</p>
<table>
<tr>
<th>
column
</th>
<th>
translation
</th>
</tr>
<tr>
<td>
ID
</td>
<td>
ID
</td>
</tr>
<tr>
<td>
Infekce
</td>
<td>
order of infection
</td>
</tr>
<tr>
<td>
Pohlavi
</td>
<td>
sex
</td>
</tr>
<tr>
<td>
RokNarozeni
</td>
<td>
year of birth
</td>
</tr>
<tr>
<td>
DatumPozitivity
</td>
<td>
date of positivity
</td>
</tr>
<tr>
<td>
DatumVysledku
</td>
<td>
date of result
</td>
</tr>
<tr>
<td>
Vylecen
</td>
<td>
week of recovery
</td>
</tr>
<tr>
<td>
Umrti
</td>
<td>
week of COVID death
</td>
</tr>
<tr>
<td>
Symptom
</td>
<td>
was symptomatic at time of test
</td>
</tr>
<tr>
<td>
TypTestu
</td>
<td>
type of test
</td>
</tr>
<tr>
<td>
Datum_Prvni_davka
</td>
<td>
first dose date
</td>
</tr>
<tr>
<td>
Datum_Druha_davka
</td>
<td>
second dose date
</td>
</tr>
<tr>
<td>
Datum_Treti_davka
</td>
<td>
third dose date
</td>
</tr>
<tr>
<td>
Datum_Ctvrta_davka
</td>
<td>
fourth dose date
</td>
</tr>
<tr>
<td>
Datum_Pata_davka
</td>
<td>
fifth dose date
</td>
</tr>
<tr>
<td>
Datum_Sesta_davka
</td>
<td>
sixth dose date
</td>
</tr>
<tr>
<td>
Datum_Sedma_davka
</td>
<td>
seventh dose date
</td>
</tr>
<tr>
<td>
OckovaciLatkaKod_Prvni_davka
</td>
<td>
first dose vaccine type code
</td>
</tr>
<tr>
<td>
OckovaciLatkaKod_Druha_davka
</td>
<td>
second dose vaccine type code
</td>
</tr>
<tr>
<td>
OckovaciLatkaKod_Treti_davka
</td>
<td>
third dose vaccine type code
</td>
</tr>
<tr>
<td>
OckovaciLatkaKod_Ctvrta_davka
</td>
<td>
fourth dose vaccine type code
</td>
</tr>
<tr>
<td>
OckovaciLatkaKod_Pata_davka
</td>
<td>
fifth dose vaccine type code
</td>
</tr>
<tr>
<td>
OckovaciLatkaKod_Sesta_davka
</td>
<td>
sixth dose vaccine type code
</td>
</tr>
<tr>
<td>
OckovaciLatkaKod_Sedma_davka
</td>
<td>
seventh dose vaccine type code
</td>
</tr>
<tr>
<td>
PrimPricinaHospCOVID
</td>
<td>
primary reason for COVID hospitalization
</td>
</tr>
<tr>
<td>
bin_Hospitalizace
</td>
<td>
was hospitalized
</td>
</tr>
<tr>
<td>
min_Hospitalizace
</td>
<td>
earliest week of hospitalization
</td>
</tr>
<tr>
<td>
dni_Hospitalizace
</td>
<td>
days of hospitalization
</td>
</tr>
<tr>
<td>
max_Hospitalizace
</td>
<td>
last week of hospitalization
</td>
</tr>
<tr>
<td>
bin_JIP
</td>
<td>
admitted to ICU
</td>
</tr>
<tr>
<td>
min_JIP
</td>
<td>
earliest week of ICU stay
</td>
</tr>
<tr>
<td>
dni_JIP
</td>
<td>
days in ICU
</td>
</tr>
<tr>
<td>
max_JIP
</td>
<td>
last week of ICU stay
</td>
</tr>
<tr>
<td>
bin_STAN
</td>
<td>
hospitalized at regular hospital ward
</td>
</tr>
<tr>
<td>
min_STAN
</td>
<td>
earliest week of regular ward stay
</td>
</tr>
<tr>
<td>
dni_STAN
</td>
<td>
days in regular ward
</td>
</tr>
<tr>
<td>
max_STAN
</td>
<td>
last week of regular ward stay
</td>
</tr>
<tr>
<td>
bin_Kyslik
</td>
<td>
received oxygen therapy
</td>
</tr>
<tr>
<td>
min_Kyslik
</td>
<td>
earliest week of oxygen therapy
</td>
</tr>
<tr>
<td>
dni_Kyslik
</td>
<td>
days of oxygen therapy
</td>
</tr>
<tr>
<td>
max_Kyslik
</td>
<td>
last week of oxygen therapy
</td>
</tr>
<tr>
<td>
bin_HFNO
</td>
<td>
received high-flow nasal oxygen therapy
</td>
</tr>
<tr>
<td>
min_HFNO
</td>
<td>
earliest week of HFNO
</td>
</tr>
<tr>
<td>
dni_HFNO
</td>
<td>
days of HFNO
</td>
</tr>
<tr>
<td>
max_HFNO
</td>
<td>
last week of HFNO
</td>
</tr>
<tr>
<td>
bin_UPV_ECMO
</td>
<td>
received ultra-protective ventilation/ECMO
</td>
</tr>
<tr>
<td>
min_UPV_ECMO
</td>
<td>
earliest week of UPV/ECMO
</td>
</tr>
<tr>
<td>
dni_UPV_ECMO
</td>
<td>
days of UPV/ECMO
</td>
</tr>
<tr>
<td>
max_UPV_ECMO
</td>
<td>
last week of UPV/ECMO
</td>
</tr>
<tr>
<td>
Mutace
</td>
<td>
variant
</td>
</tr>
<tr>
<td>
DatumUmrtiLPZ
</td>
<td>
week of death from any cause
</td>
</tr>
<tr>
<td>
Long_COVID
</td>
<td>
long COVID diagnosis date
</td>
</tr>
<tr>
<td>
DCCI
</td>
<td>
Deyo-Charlson Comorbidity Index
</td>
</tr>
</table>
<p>The <code>Infekce</code> column indicates whether the entry is for a
person with no infection listed, or for the first, second, or third
infection of the person. So part of the reason why there are more rows
than people is probably because there's multiple rows for people with 2
or 3 infections. But I don't know why the maximum infection number is
only 3 though:</p>
<pre>&gt; t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv&quot;)
&gt; t[,.N,Infekce]
   Infekce       N
1:      NA 7800263
2:       1 4325706
3:       2  450511
4:       3   21188</pre>
<p>The DCCI column shows a Deyo-Charlson Comorbidity Index at the time
of a COVID case, so its value is zero for all people with no COVID case
included:</p>
<pre>&gt; t[,.N,,.(DCCI,Infekce)]|&gt;print(r=F)
 DCCI Infekce       N
    0      NA 7800263
    0       1 2865288
    0       2  284733
    0       3   11712
    1       1  777793
    1       2   93645
    1       3    5005
    2       1  310110
    2       2   35398
    2       3    2148
    3       1  152020
    3       2   15990
    3       3    1009
    4       1   83520
    4       2    8110
    4       3     524
    5       1  136975
    5       2   12635
    5       3     790</pre>
<p>There's about 1.6 million rows where the year of birth is missing.
All except one of them are for people with no vaccine doses listed:</p>
<pre>&gt; t[RokNarozeni==&quot;-&quot;,.N,OckovaciLatkaKod_Prvni_davka][N&gt;0][order(-N)]
   OckovaciLatkaKod_Prvni_davka       N
1:                              1630991 # about 1.6 million rows for unvaccinated people
2:                         CO01       1 # one row for Pfizer</pre>
<p>On most rows with a missing year of birth, all other fields including
the date of death are also missing, but there's 63,695 rows where the
year of birth is missing but the date of death is not missing (which are
mostly for deaths in 2020):</p>
<pre>&gt; t[RokNarozeni==&quot;-&quot;&amp;DatumUmrtiLPZ!=&quot;&quot;,.N,.(year=substr(DatumUmrtiLPZ,1,4))][order(year)]
   year     N
1: 2020 37471 # most records with year of birth missing and date of death not missing are for deaths in 2020
2: 2021  9658
3: 2022  5522
4: 2023  6981
5: 2024  4063</pre>
<p>If rows with a missing date of birth are excluded and rows for second
and third infections are excluded, then the new UZIS dataset has only
about 10.5 million rows, which is about half a million less than in the
old record-level dataset:</p>
<pre>&gt; t[RokNarozeni!=&quot;-&quot;&amp;!(!is.na(Infekce)&amp;Infekce&gt;1),.N]
[1] 10494977</pre>
<p>The new UZIS dataset is missing about 15% of all deaths in 2020 even
if you don't exclude the rows with a date of birth missing:
[<a href=https://ec.europa.eu/eurostat/data/database>https://ec.europa.eu/eurostat/data/database</a>,
<a href=czech2.html#Deaths_by_ICD_code_region_age_group_and_year>czech2.html#Deaths_by_ICD_code_region_age_group_and_year</a>]</p>
<pre>&gt; rec=fread(&quot;CR_records.csv&quot;)
&gt; reclev=rec[,.(reclev=.N),.(year=year(DatumUmrti))]
&gt; eurostat=fread(&quot;http://sars2.net/f/czpopdead.csv&quot;)[,.(eurostat=sum(dead)),year]
&gt; icd=fread(&quot;http://sars2.net/f/czicd.csv.gz&quot;)[,.(byicd=sum(dead)),year]
&gt; me=merge(merge(reclev,eurostat),icd)
&gt; ua=\(x,y,...){u=unique(x);y(u,...)[match(x,u)]}
&gt; new=t[!(!is.na(Infekce)&amp;Infekce&gt;1),.(newuzis=.N),.(year=as.integer(substr(DatumUmrtiLPZ,1,4)))]
&gt; merge(me,new,all=T)[year&gt;=2020]|&gt;print(r=F)
 year reclev eurostat  byicd newuzis
 2020 129289   129289 129289  110177
 2021 139890   139891 139891  139687
 2022 120219   120219 120219  121464
 2023     NA       NA     NA  113807
 2024     NA       NA     NA   70941</pre>
<p>However it's because the new dataset is missing all deaths in the
first 9 weeks of 2020:</p>
<pre>&gt; t[,.N,DatumUmrtiLPZ][order(DatumUmrtiLPZ)][1:6]
   DatumUmrtiLPZ        N
1:               12034894
2:       2020-10     2277
3:       2020-11     2289
4:       2020-12     2318
5:       2020-13     2290
6:       2020-14     2322</pre>
<p>There's two different columns for the week of death:
<code>Umrti</code> (COVID death) and <code>DatumUmrtiLPZ</code> (date of
death LPZ). LPZ is the Czech death certificate registry.
[<a href=https://www.uzis.cz/index.php?pg=registry-sber-dat--ostatni-rezortni-registry--list-o-prohlidce-zemreleho>https://www.uzis.cz/index.php?pg=registry-sber-dat–ostatni-rezortni-registry–list-o-prohlidce-zemreleho</a>]
There's 829 rows where the <code>DatumUmrtiLPZ</code> column is empty
but the <code>Umrti</code> column for a COVID death is not:</p>
<pre>&gt; t[DatumUmrtiLPZ!=&quot;&quot;,.N] # date of death in death certificate registry
[1] 562774
&gt; t[Umrti!=&quot;&quot;,.N] # date of COVID death
[1] 43633
&gt; t0[DatumUmrtiLPZ==&quot;&quot;&amp;Umrti!=&quot;&quot;,.N] # number of rows with only date of COVID death listed
[1] 829</pre>
<p>There are 354 rows where the date of death is not the same as the
date of a COVID death, even though the difference is only one week in
most cases:</p>
<pre>&gt; t[Umrti!=&quot;&quot;&amp;DatumUmrtiLPZ!=&quot;&quot;&amp;DatumUmrtiLPZ!=Umrti,.(DatumUmrtiLPZ,Umrti)]
     DatumUmrtiLPZ   Umrti
  1:       2022-03 2022-04
  2:       2021-12 2021-13
  3:       2020-47 2020-48
  4:       2021-11 2021-10
  5:       2020-51 2020-52
 ---
350:       2021-15 2021-14
351:       2020-43 2020-44
352:       2021-06 2021-07
353:       2021-01 2021-02
354:       2022-44 2022-43</pre>
<p>About 2,000 people have a date of positive test after a date of
death, but in most cases the difference is only 1 or 2 weeks, so it
might be if the date of positive tests is by reporting date:</p>
<pre>&gt; t[DatumUmrtiLPZ!=&quot;&quot;&amp;DatumUmrtiLPZ&lt;DatumPozitivity,.(DatumPozitivity,DatumUmrtiLPZ)]
      DatumPozitivity DatumUmrtiLPZ
   1:         2024-03       2024-01
   2:         2021-21       2021-18
   3:         2020-45       2020-44
   4:         2020-45       2020-44
   5:         2020-18       2020-17
  ---
1745:         2021-48       2020-18
1746:         2021-12       2021-11
1747:         2023-21       2023-09
1748:         2021-14       2021-13
1749:         2022-05       2022-04</pre>
<h2>
<a href=#Comorbidity_index_by_age_group_and_vaccine_type_in_new_UZIS_data id=Comorbidity_index_by_age_group_and_vaccine_type_in_new_UZIS_data>Comorbidity
index by age group and vaccine type in new UZIS data</a>
</h2>
<p>The DCCI column shows a value of the Deyo-Charlson Comorbidity Index
at the time of a COVID case. The value is zero for all people with no
COVID case listed, but at the time of the first case the value was zero
for about 66% of all people:</p>
<pre>&gt; t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv&quot;)
&gt; t[Infekce==1,.N,DCCI]|&gt;print(r=F)
 DCCI       N
    0 2865288
    1  777793
    2  310110
    3  152020
    4   83520
    5  136975</pre>
<p>A Czech study which employed the DCCI index said: <span
class="quote">"0 points indicate no disease, 1-2 points suggest a low
level of severity, 3-4 points represent a moderate level of severity and
a score of 5 or higher can be considered as the occurrence of multiple
significant comorbidities"</span>.
[<a href=https://www.sciencedirect.com/science/article/pii/S0965206X23000591>https://www.sciencedirect.com/science/article/pii/S0965206X23000591</a>]
However in the UZIS data values of 5 and above seem to be listed as
5.</p>
<p>The average comorbidity index was about 0.73 for people with the
first dose type Comirnaty (<code>CO01</code>) but about 1.03 for people
with first dose type SPIKEVAX (<code>CO02</code>):</p>
<pre>&gt; rec=fread(&quot;Czech/data/CR_records.csv&quot;)
&gt; k=grep(&quot;OckovaciLatka_&quot;,names(rec));k2=k-1
&gt; codes=rec[,.(type=unlist(rec[,..k],,F),code=unlist(rec[,..k2],,F))][!duplicated(code)]
&gt; a=t[Infekce==1,.(DCCI=mean(DCCI),.N),.(code=OckovaciLatkaKod_Prvni_davka)]
&gt; merge(codes,a)[order(-N)][N&gt;=1e3]
   code                     type      DCCI       N
1: CO01                Comirnaty 0.7299204 2183923 # Pfizer
2:                               0.4616843 1678946 # unvaccinated
3: CO02                 SPIKEVAX 1.0274723  182293 # Moderna
4: CO04 COVID-19 Vaccine Janssen 0.6712624  152824
5: CO03                VAXZEVRIA 1.7055395  123531 # Astrazeneca
6: CO07                Nuvaxovid 0.5196774    3100 # Novavax</pre>
<p>The comorbidity index peaks in people who were born in 1930-1934, so
this new dataset might reflect the actual level of comorbidities better
than the earlier file <code>ockovani-profese.csv</code> (where the
proportion of people who were indicated to have a chronic illness peaked
in ages 65-69 but it was very low in the oldest age groups, which might
be if information about chronic illness was not listed for people who
qualified to be vaccinated based on their age):</p>
<pre>&gt; t[Infekce==1,.(DCCI=mean(DCCI),.N),RokNarozeni][order(RokNarozeni)]|&gt;print(r=F)
 RokNarozeni       DCCI      N
           - 0.03012425  11187
   1860-1864 0.00000000      1
   1865-1869 0.00000000      2
   1870-1874 0.00000000      1
   1875-1879 0.00000000      2
   1880-1884 0.00000000      2
   1890-1894 0.00000000      1
   1895-1899 0.00000000      1
   1900-1904 0.00000000     69
   1905-1909 0.00000000     45
   1910-1914 0.07142857     56
   1915-1919 2.15384615    117
   1920-1924 2.81595830   2494
   1925-1929 3.08236062  13793
   1930-1934 3.11992329  38066
   1935-1939 2.92733054  60383
   1940-1944 2.62483070 104105
   1945-1949 2.24024614 151786
   1950-1954 1.75856013 176516
   1955-1959 1.31641930 194789
   1960-1964 0.93541726 257143
   1965-1969 0.72503103 289229
   1970-1974 0.54189543 375757
   1975-1979 0.42561725 431108
   1980-1984 0.34186083 358409
   1985-1989 0.28738798 332540
   1990-1994 0.24863189 314119
   1995-1999 0.22801030 232643
   2000-2004 0.20644919 226230
   2005-2009 0.16525787 291738
   2010-2014 0.15856826 273346
   2015-2019 0.13150042 153490
   2020-2024 0.06051234  36538
 RokNarozeni       DCCI      N</pre>
<p>Next I calculated an age-normalized excess comorbidity percentage for
each vaccine type. I excluded people with a year of birth missing.</p>
<p>I derived the expected total DCCI for each vaccine type by
multiplying the number of people in each age group with the average DCCI
index for the age group among all rows where the infection number was 1,
and then I divided the actual total DCCI with the expected total DCCI,
subtracted 1, and multiplied the result by 100. The excess comorbidity
percentage was about -0.6% for Pfizer but 6.7% for Moderna, which
supports my earlier hypothesis that a higher level of comorbidities
explained why Moderna vaccinees had higher ASMR than Pfizer
vaccinees:</p>
<pre>&gt; dcci=t[Infekce==1&amp;RokNarozeni!=&quot;-&quot;,.(dcci=sum(as.numeric(DCCI)),.N),.(code=OckovaciLatkaKod_Prvni_davka,born=RokNarozeni)]
&gt; dcci=merge(dcci[,.(base=sum(dcci)/sum(N)),born],dcci)[,base:=base*N]
&gt; dcci=dcci[,.(excesspct=round((sum(dcci)/sum(base)-1)*100,1),N=sum(N)),code]
&gt; merge(codes,dcci)[N&gt;=1e3][order(-N)]|&gt;print(r=F)
 code                     type excesspct       N
 CO01                Comirnaty      -0.6 2183923 # Pfizer
                                    -1.4 1667759 # unvaccinated
 CO02                 SPIKEVAX       6.7  182293 # Moderna
 CO04 COVID-19 Vaccine Janssen      -3.5  152824
 CO03                VAXZEVRIA       5.8  123531 # AstraZeneca
 CO07                Nuvaxovid       0.3    3100 # Novavax</pre>
<p>In almost all age groups the percentage of the highest DCCI value 5
was higher for Moderna than Pfizer:</p>
<div>
<img src=i/czech-dcci-modpfi.png width=700>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table)

t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv&quot;)

a=t[Infekce==1,.N,.(dcci=DCCI,born=RokNarozeni,code=OckovaciLatkaKod_Prvni_davka)]
a=a[!born%like%&quot;19(05|10)&quot;]
a=merge(a,a[,.(pop=sum(N)),.(born,code)])

a=a[code%in%c(&quot;CO01&quot;,&quot;CO02&quot;)]
a[,name:=factor(code,,c(&quot;Pfizer&quot;,&quot;Moderna&quot;))]

m0=a[,tapply(N/pop*100,.(name,paste(&quot;DCCI&quot;,dcci),born),c)]
maxcolor=max(m0,na.rm=T)

pal=hsv(c(21,21,21,16,11,6,3,0,0)/36,c(0,.25,rep(.5,6),0),c(rep(1,8),.0))
pal=sapply(255:0/255,\(i)rgb(i,i,i))
exp=.5

for(i in 1:dim(m0)[1]){
  m=disp=m0[i,,];disp=ifelse(m&gt;=10,round(m),sprintf(&quot;%.1f&quot;,m))
  pheatmap::pheatmap(m^exp,filename=paste0(&quot;i&quot;,i,&quot;.png&quot;),display_numbers=disp,
    cluster_rows=F,cluster_cols=F,legend=F,cellwidth=18,cellheight=14,fontsize=9,fontsize_number=8,
    border_color=NA,na_col=&quot;white&quot;,
    number_color=ifelse(m^exp&gt;maxcolor^exp*.4,&quot;white&quot;,&quot;black&quot;),
    breaks=seq(0,maxcolor^exp,,256),colorRampPalette(pal)(256))}

ar=a[,tapply(N/pop,.(code,paste(&quot;DCCI&quot;,dcci),born),c)]
m1=ar[1,,];m2=ar[2,,];m=(m2-m1)/ifelse(m2&gt;m1,m1,m2)
disp=m2/m1;disp[]=sprintf(&quot;%.2f&quot;,disp)
pal=hsv(rep(c(21,0)/36,5:4),c(1,.8,.6,.3,0,.3,.6,.8,1),c(.3,.65,1,1,1,1,1,.65,.3))
maxcolor=3;exp=.7

pheatmap::pheatmap(sign(m)*abs(m)^exp,filename=paste0(&quot;i3.png&quot;),display_numbers=disp,
  cluster_rows=F,cluster_cols=F,legend=F,cellwidth=18,cellheight=14,fontsize=9,fontsize_number=8,
  border_color=NA,na_col=&quot;white&quot;,
  number_color=ifelse(abs(m)&gt;maxcolor^exp*.5,&quot;white&quot;,&quot;black&quot;),
  breaks=seq(-maxcolor^exp,maxcolor^exp,,256),colorRampPalette(pal)(256))

sub=&quot;The comorbidity index was calculated at the time of the first COVID case. People with no COVID case are excluded because the DCCI value was only listed for COVID cases. People whose COVID case was before they were vaccinated are not excluded. Pfizer includes only type CO01 but not Pfizer&#39;s Omicron or pediatric vaccine types, and Moderna includes only type CO02. Source: nzip.cz/data/2135-covid-19-prehled-populace.&quot;
system(paste0(&quot;w=`identify -format %w i1.png`;pad=14;convert -gravity northwest -pointsize 46 -interline-spacing -2 -font Arial-Bold -size $[w-pad*2]x \\( caption:&#39;Czech UZIS data: Percentage of people with each value of Deyo-Charlson Comorbidity index by year of birth and type of first vaccine dose&#39; -splice $[pad]x20 \\) \\( -size $[w-pad*2]x -font Arial -pointsize 42 caption:&#39;&quot;,gsub(&quot;&#39;&quot;,&quot;&#39;\\\\&#39;&#39;&quot;,sub),&quot;&#39; -splice $[pad]x10 \\) -pointsize 44 -font Arial-Bold -gravity north \\( caption:Pfizer -splice x12 \\( i1.png -chop x10 \\) caption:Moderna \\( i2.png -chop x10 \\) caption:&#39;Moderna-Pfizer ratio&#39; \\( i3.png -chop x10 \\) \\) -append 1.png&quot;))</pre>
</div>
<h2>
<a href=#Age_standardized_hospitalization_rate_by_vaccine_type_in_new_UZIS_data id=Age_standardized_hospitalization_rate_by_vaccine_type_in_new_UZIS_data>Age-standardized
hospitalization rate by vaccine type in new UZIS data</a>
</h2>
<p>Based on the new CSV file published by UZIS in November 2024, it's
now possible to calculate hospitalization rate by vaccine type.</p>
<p>In the following code in order to calculate an age-standardized
hospitalization rate, I subtracted the start of the 5-year ranges of
year of birth from 2020 to assign people to 5-year age groups based on
their age on December 31st 2020 (because for example all people born in
1950-1954 belong to the age group 70-74 on December 31st 2020). I didn't
bother accounting for the aging of people over time.</p>
<p>The new UZIS data is missing the year of birth of many unvaccinated
people, even though it's not missing for any unvaccinated people with a
date of hospitalization included. But I think the new data doesn't make
it possible to see how many unvaccinated people there are for each
combination of month and age, so I took the monthly number of people by
vaccine type and age from one of my old bucket files for the
record-level data, where I treated the number of vaccinated people in
each age group at the end of 2022 as the number of vaccinated people for
the rest of the dataset. (In my bucket file I accounted for the aging of
people over time, but it shouldn't make much difference here.)</p>
<p>I assigned each hospitalization week to a hospitalization month based
on the month of the Thursday of the week.</p>
<p>But anyway, the results below show that people who got a Janssen or
AstraZeneca vaccine for the first dose had a high hospitalization rate
during the COVID wave in November to December 2021. So it's consistent
with my plot for all-cause ASMR by vaccination status where the spike in
deaths during the last two months of 2021 was more pronounced for
Janssen and AstraZeneca but more flat for Pfizer and Moderna.</p>
<p>In January 2021 vaccinated people had almost as high hospitalization
rate as unvaccinated people, which might be because there had not been
enough time for the immune response to build up after vaccination, or
because vulnerable groups of people were priorized during the early
rollout.</p>
<div>
<img src=i/czech-uzishosp.png width=700>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table);library(ggplot2)

t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv&quot;)

isoweek=\(year,week,weekday=7){d=as.Date(paste0(year,&quot;-1-4&quot;));d-(as.integer(format(d,&quot;%w&quot;))+6)%%7-1+7*(week-1)+weekday}
getweek=\(x)isoweek(as.integer(substr(x,1,4)),as.integer(substr(x,6,7)))
ua=\(x,y,...){u=unique(x);y(u,...)[match(x,u)]}
yemo=\(x){u=unique(x);format(u,&quot;%Y-%m&quot;)[match(x,u)]}

t[min_Hospitalizace!=&quot;&quot;,hospweek:=ua(min_Hospitalizace,getweek)-3]
t[,date1:=ua(Datum_Prvni_davka,getweek)-3]

t[,type:=OckovaciLatkaKod_Prvni_davka]
t[type%in%c(&quot;CO01&quot;,&quot;CO08&quot;,&quot;CO09&quot;,&quot;CO16&quot;,&quot;CO20&quot;,&quot;CO21&quot;),type:=&quot;Pfizer&quot;]
t[type%in%c(&quot;CO02&quot;,&quot;CO12&quot;,&quot;CO15&quot;),type:=&quot;Moderna&quot;]
t[type==&quot;CO03&quot;,type:=&quot;AstraZeneca&quot;]
t[type==&quot;CO04&quot;,type:=&quot;Janssen&quot;]
t[type==&quot;&quot;,type:=&quot;Unvaccinated&quot;]
t[,type:=ifelse(!is.na(date1)&amp;date1&gt;hospweek,&quot;Unvaccinated&quot;,type)]

t[RokNarozeni!=&quot;-&quot;,age:=pmin(100,(2020-as.integer(substr(RokNarozeni,1,4))))]

hosp=t[!type%like%&quot;^CO&quot;&amp;!is.na(hospweek),.(hosp=.N),.(month=yemo(hospweek),type,age=ifelse(age&lt;20,0,age))]

b=fread(&quot;http://sars2.net/f/czbucketskeep.csv.gz&quot;)
a=b[dose&lt;=1,.(pop=sum(alive)),.(month,type=ifelse(type==&quot;&quot;,&quot;Unvaccinated&quot;,type),age=ifelse(age&lt;20,0,age%/%5*5))]
a=rbind(a,a[month==&quot;2022-12&quot;,.(month=yemo(seq(as.Date(&quot;2023-1-1&quot;),as.Date(&quot;2024-10-1&quot;),&quot;month&quot;)),pop),.(type,age)])

me=merge(a,hosp,all=T)[!type%in%c(&quot;Novavax&quot;,&quot;Other&quot;)]
me=merge(fread(&quot;http://sars2.net/f/czcensus2021pop.csv&quot;)[,.(std=sum(pop)),.(age=age%/%5*5)][,std:=std/sum(std)],me)

p=me[,.(hosp=sum(hosp/pop*std*365e5,na.rm=T)),.(month,type)][order(-type)]
p[,month:=as.Date(paste0(month,&quot;-1&quot;))]
p[,type:=factor(type,c(&quot;Unvaccinated&quot;,&quot;Pfizer&quot;,&quot;Moderna&quot;,&quot;AstraZeneca&quot;,&quot;Janssen&quot;))]

xstart=as.Date(&quot;2020-1-1&quot;);xend=as.Date(&quot;2025-1-1&quot;)
xbreak=seq(xstart,xend,&quot;6 month&quot;);xlab=c(rbind(&quot;&quot;,2020:2024),&quot;&quot;)
ybreak=pretty(p$hosp,7);ystart=0;yend=max(ybreak)

color=c(&quot;black&quot;,hsv(c(240,355,330,204,36)/360,c(.94,.75,.8,.67,.64),c(.76,.82,.5,.87,.95)))

ggplot(p,aes(x=month+15,y=hosp))+
geom_vline(xintercept=seq(xstart,xend,&quot;3 month&quot;),color=&quot;gray85&quot;,linewidth=.3)+
geom_vline(xintercept=seq(xstart,xend,&quot;year&quot;),color=&quot;gray65&quot;,linewidth=.3)+
geom_vline(xintercept=c(xstart,xend),linewidth=.3,lineend=&quot;square&quot;)+
geom_hline(yintercept=c(ystart,0,yend),linewidth=.3,lineend=&quot;square&quot;)+
geom_line(aes(color=type),linewidth=.4)+
geom_point(aes(color=type),size=.5)+
labs(title=&quot;Age-standardized hospitalization rate per 100,000 person-years&quot;,subtitle=paste0(&quot;The 2021 census population by 5-year age groups was used as the standard population, where ages below 20 were aggregated to a single age group.&quot;)|&gt;stringr::str_wrap(80),x=NULL,y=NULL,color=&quot;First dose type&quot;)+
scale_x_date(limits=c(xstart,xend),breaks=xbreak,labels=xlab)+
scale_y_continuous(limits=c(ystart,yend),breaks=ybreak)+
scale_color_manual(values=color)+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
theme(axis.text=element_text(size=7,color=&quot;black&quot;),
  axis.ticks=element_line(linewidth=.3),
  axis.ticks.x=element_line(color=alpha(&quot;black&quot;,c(1,0))),
  axis.ticks.length=unit(3,&quot;pt&quot;),
  legend.background=element_rect(fill=&quot;white&quot;,color=&quot;black&quot;,linewidth=.3),
  legend.direction=&quot;vertical&quot;,
  legend.justification=c(1,1),
  legend.key.height=unit(10,&quot;pt&quot;),
  legend.key.width=unit(15,&quot;pt&quot;),
  legend.key=element_blank(),
  legend.margin=margin(3,5,3,4),
  legend.position=c(1,1),
  legend.spacing.x=unit(1.5,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.text=element_text(size=7),
  legend.title=element_text(size=7,face=2,margin=margin(2,,3)),
  panel.background=element_blank(),
  plot.margin=margin(4,4,4,4),
  plot.subtitle=element_text(size=6.7,margin=margin(,,4)),
  plot.title=element_text(size=7.5,face=&quot;bold&quot;,margin=margin(1,,3)))
ggsave(&quot;1.png&quot;,width=4,height=2.2,dpi=380*4)
system(&quot;magick 1.png -resize 25% 1.png&quot;)</pre>
</div>
<p>Here's my old plot for ASMR by vaccine type for comparison, where you
can see that the spike in ASMR in the last two months of 2021 is more
pronounced for Janssen and AstraZeneca which are viral vector vaccines
but the spike is more flat for Moderna and Pfizer which are mRNA
vaccines (even though the difference might not necessarily be due to
efficacy, but it might also be if people with a higher COVID mortality
risk were more likely to get certain types of vaccines):
[<a href=czech2.html#ASMR_by_month_and_vaccine_type>czech2.html#ASMR_by_month_and_vaccine_type</a>]</p>
<div>
<img src=i/czech-asmrtype.png width=700>
</div>
<h2>
<a href=#Age_standardized_hospitalization_rate_by_age_group_in_new_UZIS_data id=Age_standardized_hospitalization_rate_by_age_group_in_new_UZIS_data>Age-standardized
hospitalization rate by age group in new UZIS data</a>
</h2>
<p>Earlier I have pointed out that in the winter of 2020 to 2021 when
the Czech Republic had a pattern with three distinct humps in all-cause
mortality, the third hump was lower than the first hump in ages 80+ but
ages 40-59 and 60-79 followed the opposite pattern where the third hump
was higher than the first hump. I thought it might have been because in
ages 80+ about half of people had been vaccinated by the time of the
third hump, but in ages 40-59 and 60-79 only a few people had been
vaccinated by the time of the third hump.</p>
<p>When I looked at all-cause ASMR by vaccination status, the third hump
was close to nonexistent in vaccinated people in ages 80+. But it wasn't
necessarily because vaccines prevented COVID deaths, because it might
have also been because there was a reduced number of deaths in recently
vaccinated people due to the temporal HVE:
[<a href=czech.html#Daily_deaths_and_vaccine_doses_by_age_group>czech.html#Daily_deaths_and_vaccine_doses_by_age_group</a>]</p>
<div>
<img src=i/czech-facet-asmr.png width=500>
</div>
<p>So therefore I wanted to check if COVID hospitalizations followed a
similar pattern as all-cause deaths, because COVID hospitalizations are
probably less affected by temporal HVE than all-cause mortality. But
data for 2020 was missing from the datasets published by the Czech MoH
for COVID hospitalizations by vaccination status.</p>
<p>However now based on the new UZIS dataset it's possible to calculate
a hospitalization rate by age and vaccination status so that 2020 is
included. It shows that among unvaccinated people in ages 80+, the third
hump was higher than the first hump. But in ages 80+ if you look at both
unvaccinated and vaccinated people combined, the reason why the third
hump is so low appears to be that a high percentage of people had been
vaccinated by the time of the third hump:</p>
<div>
<img src=i/czech-uzishospage.png width=600>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table);library(ggplot2)

ma=\(x,b=1,f=b){x[]=rowMeans(embed(c(rep(NA,b),x,rep(NA,f)),f+b+1),na.rm=T);x}

isoweek=\(year,week,weekday=7){d=as.Date(paste0(year,&quot;-1-4&quot;));d-(as.integer(format(d,&quot;%w&quot;))+6)%%7-1+7*(week-1)+weekday}
getweek=\(x)isoweek(as.integer(substr(x,1,4)),as.integer(substr(x,6,7)))

agecut=\(x,y)cut(x,c(y,Inf),paste0(y,c(paste0(&quot;-&quot;,y[-1]-1),&quot;+&quot;)),T,F)
ages=c(0,40,60,80)

t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv&quot;)
t[,dose:=ifelse(Datum_Prvni_davka!=&quot;&quot;&amp;Datum_Prvni_davka&lt;=min_Hospitalizace,1,0)]
t[RokNarozeni!=&quot;-&quot;,age:=pmin(100,(2020-as.integer(substr(RokNarozeni,1,4))))]

a=t[,.(hosp=.N),.(age,dose,week=min_Hospitalizace)]
b=fread(&quot;http://sars2.net/f/czbucketsdaily.csv.gz&quot;)
b=b[,.(pop=sum(alive)),.(week=format(date,&quot;%G-%V&quot;),dose=pmin(dose,1),age=pmin(90,age)%/%5*5)]
b=rbind(b,b[week==&quot;2022-51&quot;,.(week=setdiff(a[week!=&quot;&quot;&amp;!week%like%2020,week],week),pop),.(dose,age)])
b=b[rowid(week,dose,age)==1]
a=merge(a,b)
a=a[!week%like%2024]
a=a[age!=0]

a=rbind(a,a[,.(hosp=sum(hosp),pop=sum(pop),dose=2),.(week,age)])

a=merge(fread(&quot;http://sars2.net/f/czcensus2021pop.csv&quot;)[,.(std=sum(pop)),.(age=age%/%5*5)][,std:=std/sum(std)],a)

p=a[,.(y=sum(hosp/pop*std/7*365e5)),.(age=agecut(age,ages),x=week,z=factor(dose,,c(&quot;Unvaccinated&quot;,&quot;Vaccinated&quot;,&quot;Unvaccinated and vaccinated&quot;)))]

ymax=p[,.(ymax=max(y)),age]
p=merge(p,ymax)[,.(x,y=y/ymax*100,age,z)]

pct=b[,.(pop=sum(pop)),.(week,age=agecut(age,ages),dose)]
pct=dcast(pct,week+age~dose,value.var=&quot;pop&quot;)[,`1`:=nafill(`1`,,0)]
pct=pct[week&gt;=b[dose==1,min(week)]]
p=rbind(p,pct[,.(x=week,age,z=&quot;Vaccinated percent&quot;,y=`1`/(`0`+`1`)*100)])

xval=unique(format(seq(as.Date(&quot;2020-1-1&quot;),as.Date(&quot;2023-12-31&quot;),1),&quot;%G-%V&quot;))
p[,x:=as.integer(factor(x,xval))]
p=na.omit(p)
xstart=1;xend=max(p$x)

ggplot(p,aes(x))+
facet_wrap(~age,ncol=1,strip.position=&quot;top&quot;,dir=&quot;v&quot;,scales=&quot;free_y&quot;)+
geom_vline(xintercept=grep(&quot;-01&quot;,xval),linewidth=.4,color=&quot;gray66&quot;,lineend=&quot;square&quot;)+
geom_vline(xintercept=c(xstart,xend),linewidth=.4,lineend=&quot;square&quot;)+
geom_hline(yintercept=c(0,100),linewidth=.4,lineend=&quot;square&quot;)+
geom_line(aes(y=y,color=z,linetype=z),linewidth=.6)+
geom_label(data=ymax,aes(label=sprintf(&quot;\n  Age %s (max %.0f)  \n&quot;,age,ymax),y=100),x=xend,lineheight=.5,hjust=1,vjust=1,size=3.6,fill=alpha(&quot;white&quot;,1),label.r=unit(0,&quot;pt&quot;),label.padding=unit(0,&quot;pt&quot;),label.size=.4)+
labs(x=NULL,y=NULL,title=&quot;Czech Republic: Weekly age-standardized COVID hospitalization\nrate per 100,000 person-years&quot;,subtitle=&quot;Displayed as percentage of maximum value shown in parentheses&quot;)+
scale_x_continuous(limits=c(xstart,xend),breaks=grep(&quot;-26&quot;,xval),labels=2020:2023)+
scale_y_continuous(breaks=1:4*20,limits=c(0,100),labels=\(x)paste0(x,&quot;%&quot;))+
scale_color_manual(values=c(hsv(c(7,0)/12,1,.8),&quot;black&quot;,hsv(30/36,.5,1)))+
scale_linetype_manual(values=c(&quot;solid&quot;,&quot;solid&quot;,&quot;solid&quot;,&quot;42&quot;))+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
guides(color=guide_legend(nrow=2,byrow=F))+
theme(axis.text=element_text(size=11,color=&quot;black&quot;),
  axis.ticks=element_line(color=&quot;black&quot;,linewidth=.4),
  axis.text.x=element_text(margin=margin(4)),
  axis.ticks.length.x=unit(0,&quot;pt&quot;),
  axis.ticks.length.y=unit(4,&quot;pt&quot;),
  legend.background=element_blank(),
  legend.box.spacing=unit(0,&quot;pt&quot;),
  legend.direction=&quot;horizontal&quot;,
  legend.justification=&quot;center&quot;,
  legend.key=element_blank(),
  legend.key.height=unit(13,&quot;pt&quot;),
  legend.key.width=unit(26,&quot;pt&quot;),
  legend.margin=margin(,,4),
  legend.position=&quot;top&quot;,
  legend.spacing.x=unit(2,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.text=element_text(size=11,vjust=.5),
  legend.title=element_blank(),
  panel.background=element_blank(),
  panel.grid=element_blank(),
  panel.spacing=unit(3,&quot;pt&quot;),
  plot.margin=margin(5,5,5,5),
  plot.subtitle=element_text(size=11,margin=margin(,,2)),
  plot.title=element_text(size=11,face=&quot;bold&quot;,margin=margin(1,,4)),
  strip.background=element_blank(),
  strip.text=element_blank())
ggsave(&quot;1.png&quot;,width=5.3,height=5.3,dpi=300*4)

sub=&quot;The 2021 census population by 5-year age groups was used as the standard population. In the hospitalization data people were given a year of birth as a range of 5 years like 1950-1954, so here each person was assigned to a 5-year age group by subtracting the year of birth from 2020 so that aging over time was not accounted for. Ages 0-4 were excluded due to a small vaccinated population size which inflated the hospitalization rate on days with nonzero hospitalizations. Sources: nzip.cz/data/2135-covid-19-prehled-populace (hospitalizations) and github.com/PalackyUniversity/uzis-data-analysis (number of vaccinated and unvaccinated people by age).&quot;
system(paste0(&quot;mar=$[24*4];w=`identify -format %w 1.png`;magick \\( 1.png -gravity southwest -chop 0x70 \\) \\( -size $[w-mar*2]x -font Arial -interline-spacing -3 -pointsize $[44*4] caption:&#39;&quot;,gsub(&quot;&#39;&quot;,&quot;&#39;\\\\&#39;&quot;,sub),&quot;&#39; -gravity southwest -splice $[mar]x$[20*4] \\) -append -resize 25% -colors 256 1.png&quot;))</pre>
</div>
<h2>
<a href=#Moderna_Pfizer_mortality_ratio_by_year_of_birth_and_comorbidity_index_in_new_UZIS_data id=Moderna_Pfizer_mortality_ratio_by_year_of_birth_and_comorbidity_index_in_new_UZIS_data>Moderna-Pfizer
mortality ratio by year of birth and comorbidity index in new UZIS
data</a>
</h2>
<p>In the next plot I calculated the number of deaths within the first
52 weeks of the first vaccine dose grouped by the vaccine type, DCCI,
and age group. There were 36 combinations of age group and DCCI which
had at least 100 deaths, but in 30 of them Moderna got a higher
mortality rate than Pfizer:</p>
<div>
<img src=i/czech-dcci-modpfi-2.png width=700>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv&quot;)

weeks=u(format(seq(as.Date(&quot;2020-1-1&quot;),as.Date(&quot;2024-12-31&quot;),1),&quot;%G-%V&quot;))

t[,dead:=match(ifelse(DatumUmrtiLPZ==&quot;&quot;,Umrti,DatumUmrtiLPZ),weeks)]

a=t[Infekce==1&amp;RokNarozeni!=&quot;-&quot;,.(case=match(DatumPozitivity,weeks),first=match(Datum_Prvni_davka,weeks),dead,dcci=DCCI,code=OckovaciLatkaKod_Prvni_davka,born=RokNarozeni)]
a=a[!born%like%&quot;19(05|10)&quot;]
# a=a[case&gt;=first] # exclude people with a case before the first dose
a=a[code%in%paste0(&quot;CO0&quot;,1:2),.(pop=.N,dead=sum((dead-first)%in%0:51,na.rm=T)),.(code,born,dcci)]
a[,cmr:=dead/pop*1e5]

# # compare combinations of DCCI and age with at least 100 total deaths
# a[a[,sum(dead),.(born,dcci)][V1&gt;=100,.(born,dcci)],on=c(&quot;born&quot;,&quot;dcci&quot;)][,dcast(.SD,born+dcci~code,value.var=&quot;cmr&quot;)]

a[,name:=factor(code,,c(&quot;Pfizer&quot;,&quot;Moderna&quot;))]

m0=a[,tapply(cmr,.(name,paste(&quot;DCCI&quot;,dcci),born),c)]
maxcolor=max(m0,na.rm=T)

pal=sapply(255:0/255,\(i)rgb(i,i,i))
exp=.5

for(i in 1:dim(m0)[1]){
  m=disp=m0[i,,]
  pheatmap::pheatmap(m^exp,filename=paste0(&quot;i&quot;,i,&quot;.png&quot;),display_numbers=kimi(m),
    cluster_rows=F,cluster_cols=F,legend=F,cellwidth=18,cellheight=14,fontsize=9,fontsize_number=8,
    border_color=NA,na_col=&quot;white&quot;,
    number_color=ifelse(m^exp&gt;maxcolor^exp*.4,&quot;white&quot;,&quot;black&quot;),
    breaks=seq(0,maxcolor^exp,,256),colorRampPalette(pal)(256))}

ar=a[,tapply(cmr,.(code,paste(&quot;DCCI&quot;,dcci),born),c)]
m1=ar[1,,];m2=ar[2,,];m=(m2-m1)/ifelse(m2&gt;m1,m1,m2)
disp=m2/m1;disp[]=ifelse(disp&gt;=10,sprintf(&quot;%.1f&quot;,disp),sprintf(&quot;%.2f&quot;,disp))
pal=hsv(rep(c(21,0)/36,5:4),c(1,.8,.6,.3,0,.3,.6,.8,1),c(.4,.65,1,1,1,1,1,.65,.4))
maxcolor=8;exp=.7

pheatmap::pheatmap(sign(m)*abs(m)^exp,filename=paste0(&quot;i3.png&quot;),display_numbers=disp,
  cluster_rows=F,cluster_cols=F,legend=F,cellwidth=18,cellheight=14,fontsize=9,fontsize_number=8,
  border_color=NA,na_col=&quot;white&quot;,
  number_color=ifelse(abs(m)&gt;maxcolor^exp*.5,&quot;white&quot;,&quot;black&quot;),
  breaks=seq(-maxcolor^exp,maxcolor^exp,,256),colorRampPalette(pal)(256))

sub=&quot;The comorbidity index was calculated at the time of the first COVID case. People with no COVID case are excluded because the DCCI value was only listed for COVID cases. People whose COVID first case was before they were vaccinated are not excluded. Pfizer includes only type CO01 and Moderna includes only type CO02. Source: nzip.cz/data/2135-covid-19-prehled-populace.&quot;
system(paste0(&quot;w=`identify -format %w i1.png`;pad=14;convert -gravity northwest -pointsize 46 -interline-spacing -2 -font Arial-Bold -size $[w-pad*3]x \\( caption:&#39;Czech UZIS data: Deaths per 100,000 people within 52 weeks from first dose (grouped by Deyo-Charlson comorbidity index, year of birth, and type of first vaccine dose) (people vaccinated after first COVID case are excluded)&#39; -splice $[pad]x20 \\) \\( -size $[w-pad*3]x -font Arial -pointsize 42 caption:&#39;&quot;,gsub(&quot;&#39;&quot;,&quot;&#39;\\\\&#39;&#39;&quot;,sub),&quot;&#39; -splice $[pad]x10 \\) -pointsize 44 -font Arial-Bold -gravity north \\( caption:Pfizer -splice x12 \\( i1.png -chop x10 \\) caption:Moderna \\( i2.png -chop x10 \\) caption:&#39;Moderna-Pfizer ratio&#39; \\( i3.png -chop x10 \\) \\) -append 1.png&quot;));qp()</pre>
</div>
<h2>
<a href=#Mortality_risk_ratio_within_year_from_vaccination_in_new_UZIS_data id=Mortality_risk_ratio_within_year_from_vaccination_in_new_UZIS_data>Mortality
risk ratio within year from vaccination in new UZIS data</a>
</h2>
<p>In the following code I calculated a risk ratio within first the 52
weeks from vaccination, which was adjusted for both age group and
vaccination week. I included only people with a COVID case listed
because the comorbidity index was missing for people with no COVID case.
Moderna got about 1.19 times higher risk ratio than Pfizer when I only
normalized the rates by age and vaccination week, but the difference
decreased to about 1.14 when I additionally normalized the rates by the
comorbidity index:</p>
<pre>t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv&quot;)

codes=setNames(rep(&quot;Other&quot;,26),sprintf(&quot;CO%02d&quot;,1:26))
codes[c(1,8,9,16,20,21,23)]=&quot;Pfizer&quot;
codes[c(2,15)]=&quot;Moderna&quot;
codes[3]=&quot;AstraZeneca&quot;
codes[4]=&quot;Janssen&quot;
codes[c(7,22)]=&quot;Novavax&quot;

weeks=unique(format(seq(as.Date(&quot;2020-1-1&quot;),as.Date(&quot;2024-12-31&quot;),1),&quot;%G-%V&quot;))

d=t[Infekce==1] # exclude people with no case and keep only entry for first case
d[,date:=match(Datum_Prvni_davka,weeks)] # convert combination of year and week number to integer
d[,dead:=match(ifelse(DatumUmrtiLPZ==&quot;&quot;,Umrti,DatumUmrtiLPZ),weeks)]
d=d[,.(date,dead,dcci=DCCI,type=codes[OckovaciLatkaKod_Prvni_davka],born=RokNarozeni)]
d=d[born!=&quot;-&quot;&amp;!born%like%&quot;19(05|10)&quot;] # exclude people with a missing or erroneous birthdate
d=d[date&amp;#x3c;min(grep(&quot;2023&quot;,weeks))] # exclude people with a first dose in 2023 and 2024

a=d[,.(dead=sum((dead-date)%in%0:51),pop=.N),.(date,type,born,dcci)] # include only first 52 weeks
# a=d[,.(dead=sum(dead&gt;=date,na.rm=T),pop=.N),.(date,type,born,dcci)] # include whole observation period
a=merge(a,a[,.(base=sum(dead)/sum(pop)),.(date,born)])
a=merge(a[,.(base2=sum(dead)/sum(pop)),.(date,born,dcci)],a)
o=a[,.(dead=sum(dead),pop=sum(pop),rr_by_age_and_vaxweek=sum(dead)/sum(base*pop),rr_by_age_and_vaxweek_and_dcci=sum(dead)/sum(base2*pop)),type]
mutate_if(o,is.double,round,3)[order(-pop)]|&gt;print(r=F)</pre>
<!-- -->
<pre>        type  dead     pop rr_by_age_and_vaxweek rr_by_age_and_vaxweek_and_dcci
      Pfizer 14790 2183514                 0.936                          0.944
     Moderna  2729  182240                 1.115                          1.073
     Janssen  1395  152581                 1.118                          1.136
 AstraZeneca  3474  123531                 1.206                          1.177
     Novavax     9    3097                 0.592                          0.820
       Other     0       8                 0.000                          0.000</pre>
<p>When I did a Poisson regression to calculate the risk ratios instead,
the Moderna-Pfizer ratio was about 1.26 when I only included age and
vaccination week as variables in the regression, but the ratio decreased
to about 1.20 when I also included DCCI as a variable:</p>
<pre>a=d[,.(dead=sum((dead-date)%in%0:51),pop=.N),.(date,type,born,dcci)]
a=rbind(a,a[,.(dead=sum(dead),pop=sum(pop),type=&quot;Total&quot;),.(date,born,dcci)])
a[,type:=relevel(factor(type),&quot;Total&quot;)] # first factor level is used as baseline by glm
a[,date:=factor(date)] # treat vaccination week as categorical instead of continuous variable
a[,dcci:=factor(dcci)] # treat DCCI as categorical instead of continuous variable

lm=glm(dead~type+born+date,offset=log(pop),poisson,a)
lm2=glm(dead~type+born+date+dcci,offset=log(pop),poisson,a)

o=a[type!=&quot;Total&quot;,.(dead=sum(dead),pop=sum(pop)),type]
o$rr_by_age_and_vaxweek=o[,exp(coef(lm))[paste0(&quot;type&quot;,type)]]
o$rr_by_age_and_vaxweek_and_dcci=o[,exp(coef(lm2))[paste0(&quot;type&quot;,type)]]
mutate_if(o,is.double,round,3)[order(-pop)]|&gt;print(r=F)</pre>
<!-- -->
<pre>        type  dead     pop rr_by_age_and_vaxweek rr_by_age_and_vaxweek_and_dcci
      Pfizer 14790 2183514                 0.916                          0.926
     Moderna  2729  182240                 1.158                          1.112
     Janssen  1395  152581                 1.155                          1.174
 AstraZeneca  3474  123531                 1.297                          1.257
     Novavax     9    3097                 0.541                          0.604
       Other     0       8                 0.000                          0.000</pre>
<h2>
<a href=#Hospitalizations_by_weeks_after_vaccination_in_new_UZIS_data id=Hospitalizations_by_weeks_after_vaccination_in_new_UZIS_data>Hospitalizations
by weeks after vaccination in new UZIS data</a>
</h2>
<p>The new UZIS data makes it possible to plot number of
hospitalizations by time since vaccination, which is a fairly rare type
of plot I haven't seen in many studies.</p>
<p>Hospitalizations are reduced for several weeks before vaccination,
which might be because people who had recently been hospitalized were
recommended to not get vaccinated after hospitalization (and they
would've already had natural immunity anyway).</p>
<p>For some reason there's also a spike in hospitalizations about 1-10
weeks after vaccination. At first I thought it might have been if a lot
of people got vaccinated before the COVID wave that peaked in March
2021. But when I split out the data by the quarter of vaccination, the
same spike occurred during all quarters except the third quarter when
there were few hospitalizations in general. So I don't know if it's
because recently vaccinated people somehow have an elevated risk of
hospitalization:</p>
<div>
<img src=i/czech-hospvaxweek.png width=600>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>weeks=unlist(sapply(2020:2024,\(i)sprintf(&quot;%d-%02d&quot;,i,1:ifelse(i==2020,53,52))))
t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv&quot;)
t[,date:=match(Datum_Prvni_davka,weeks)]
t[,hosp:=match(min_Hospitalizace,weeks)]
t=t[date%in%54:105]

t[,vaxq:={x=(date-54)%/%13*13+1;ifelse(date%in%54:105,paste0(&quot;Vaccinated week &quot;,x,&quot;-&quot;,x+12,&quot; of 2021&quot;),NA)}]

p=na.omit(t[,.(y=.N,z=&quot;Total&quot;),.(x=hosp-date)])
p=rbind(p,na.omit(t[,.(y=.N),.(x=hosp-date,z=vaxq)]))

xbreak=pretty(p$x,10);xstart=min(p$x);xend=max(p$x)
ybreak=pretty(p$y,7);ystart=0;yend=max(p$y)

ggplot(p,aes(x,y))+
geom_hline(yintercept=0,linewidth=.4)+
geom_line(aes(color=z),linewidth=.5)+
labs(x=&quot;Week of hospitalization minus week of first dose&quot;,y=&quot;Count of hospitalizations&quot;,title=&quot;Count of COVID hospitalizations in Czech Republic by weeks since\nfirst vaccine dose&quot;,subtitle=&quot;Includes only people vaccinated on weeks where the Thursday fell in 2021. Source: nzip.cz/data/2135-covid-19-prehled-populace.&quot;|&gt;stringr::str_wrap(70))+
scale_x_continuous(limits=c(xstart-.5,xend+.5),breaks=xbreak)+
scale_y_continuous(limits=c(ystart,yend),breaks=ybreak)+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
scale_color_manual(values=c(&quot;black&quot;,hsv(c(21,12,4,0)/36,.9,.7)))+
theme(axis.text=element_text(size=11,color=&quot;black&quot;),
  axis.ticks=element_line(linewidth=.4,color=&quot;black&quot;),
  axis.ticks.length=unit(5,&quot;pt&quot;),
  axis.title=element_text(size=11,face=2),
  legend.background=element_blank(),
  legend.box.background=element_rect(color=&quot;black&quot;,linewidth=.4),
  legend.box.spacing=unit(0,&quot;pt&quot;),
  legend.direction=&quot;vertical&quot;,
  legend.justification=c(1,1),
  legend.key=element_blank(),
  legend.key.height=unit(14,&quot;pt&quot;),
  legend.key.width=unit(26,&quot;pt&quot;),
  legend.position=c(1,1),
  legend.spacing.x=unit(3,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.margin=margin(5,5,5,5),
  legend.text=element_text(size=11,vjust=.5),
  legend.title=element_blank(),
  panel.background=element_blank(),
  panel.border=element_rect(fill=NA,linewidth=.4),
  plot.margin=margin(6,8,5,5),
  plot.subtitle=element_text(size=11.5,margin=margin(,,5)),
  plot.title=element_text(size=11.5,face=2,margin=margin(1,,5)))
ggsave(&quot;1.png&quot;,width=6,height=3.7,dpi=300*4)
system(&quot;magick 1.png -resize 25% PNG8:1.png&quot;)</pre>
</div>
<p>However the spike in hospitalizations in the weeks following
vaccination is lot smaller for second doses, because I guess a lot of
people got hospitalized after the first dose but before they had time to
get the second dose:</p>
<div>
<img src=i/czech-hospvaxweek-2.png width=600>
</div>
<h2>
<a href=#Relative_risk_of_Moderna_and_Pfizer_in_low_COVID_months id=Relative_risk_of_Moderna_and_Pfizer_in_low_COVID_months>Relative
risk of Moderna and Pfizer in low-COVID months</a>
</h2>
<p>Kirsch did a blog post about how during a low-COVID period between
weeks 21 to 40 of 2021, Moderna had about 1.5 times higher mortality
rate than Pfizer within age groups:
<a href=https://kirschsubstack.com/p/official-czech-republic-record-level.><a
href="https://kirschsubstack.com/p/official-czech-republic-record-level"
class="uri">https://kirschsubstack.com/p/official-czech-republic-record-level</a>.</a></p>
<p>I tried using the old record-level data to do a Poisson regression
normalized for age and vaccination month, where I calculated the
mortality risk in June to September 2021 and I only included people
vaccinated before June 2021. But the relative risk was about 1.47 times
higher for Moderna than Pfizer, so it roughly matches Kirsch's
calculation:</p>
<pre>b=fread(&quot;http://sars2.net/f/czbucketskeep.csv.gz&quot;)

a=b[vaxmonth&lt;&quot;2021-06&quot;&amp;month&gt;=&quot;2021-06&quot;&amp;month&lt;=&quot;2021-09&quot;&amp;dose&lt;=1&amp;type!=&quot;Other&quot;]
a[dose==0,type:=&quot;Unvaccinated&quot;]
a=a[,.(dead=sum(dead),pop=sum(alive)),.(type,age=factor(pmin(age,100)),vaxmonth)]
a[,type:=relevel(factor(type),&quot;Unvaccinated&quot;)]

lm=glm(dead~type+age+vaxmonth,offset=log(pop),poisson,a)

o=a[,.(dead=sum(dead),pop=sum(pop)),type]
o$rr=o[,exp(coef(lm))[paste0(&quot;type&quot;,type)]]

se=sqrt(diag(vcov(lm)))
err=qnorm(.975)*se[paste0(&quot;type&quot;,o$type)]
o[,low:=exp(log(rr)-err)][,high:=exp(log(rr)+err)]
o[1,`:=`(rr=1,low=1,high=1)]

dplyr::mutate_if(o,is.double,round,3)[order(-pop)]|&gt;print(r=F)
#         type  dead       pop    rr   low  high
# Unvaccinated 14515 634463184 1.000 1.000 1.000
#       Pfizer 12446 379085660 0.294 0.282 0.308
#  AstraZeneca  3838  53538740 0.405 0.383 0.427
#      Moderna  2440  38525931 0.432 0.408 0.457
#      Janssen   217   4977937 0.464 0.406 0.531

o[type==&quot;Moderna&quot;,rr]/o[type==&quot;Pfizer&quot;,rr]
# 1.46563</pre>
<h2>
<a href=#Case_fatality_ratio_in_new_UZIS_data id=Case_fatality_ratio_in_new_UZIS_data>Case
fatality ratio in new UZIS data</a>
</h2>
<p>Kirsch posted this tweet:
[<a href=https://x.com/stkirsch/status/1888449481668223379>https://x.com/stkirsch/status/1888449481668223379</a>]</p>
<div>
<img src=i/czech-cfr-3.png width=600>
</div>
<p>My plot didn't show IFR but CFR. But anyway the reason why the CFR
went up in the first half of 2021 was because both deaths and cases were
going down, but deaths were lagging about 2-3 weeks behind deaths. When
I shifted the cases forwards by 3 weeks, the CFR went down in the first
half of 2021 instead:</p>
<div>
<img src=i/czech-cfr-1.png width=600>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table);library(ggplot2)

ma=\(x,b=1,f=b){x[]=rowMeans(embed(c(rep(NA,b),x,rep(NA,f)),f+b+1),na.rm=T);x}

agecut=\(x,y)cut(x,c(y,Inf),paste0(y,c(paste0(&quot;-&quot;,y[-1]-1),&quot;+&quot;)),T,F)
ages=c(10,40,60,80)

weeks=unique(format(seq(as.Date(&quot;2020-1-1&quot;),as.Date(&quot;2024-12-31&quot;),1),&quot;%G-%V&quot;))

t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv.gz&quot;)
t=t[RokNarozeni!=&quot;-&quot;]
t[,age:=pmin(100,(2020-as.integer(substr(RokNarozeni,1,4))))]
t=t[!is.na(age)]

t[,dead:=ifelse(DatumUmrtiLPZ==&quot;&quot;,Umrti,DatumUmrtiLPZ)]
t[,dosecase:=ifelse(Datum_Prvni_davka!=&quot;&quot;&amp;Datum_Prvni_davka&lt;=DatumPozitivity,1,0)]
t[,dosedead:=ifelse(Datum_Prvni_davka!=&quot;&quot;,1,0)]

a=t[DatumPozitivity!=&quot;&quot;,.(y=.N,z=&quot;case&quot;),.(week=DatumPozitivity,dose=dosecase,age)]
t[,testlag:=match(dead,weeks)-match(DatumPozitivity,weeks)]
t[,hosplag:=match(dead,weeks)-match(max_Hospitalizace,weeks)]
a=rbind(a,t[pmax(testlag%in%0:3,hosplag%in%0:3)==1,.(y=.N,z=&quot;dead&quot;),.(week=dead,dose=dosedead,age)])

w=dcast(a,age+week+dose~z,value.var=&quot;y&quot;)
w=merge(do.call(CJ,lapply(w[,1:3],unique)),w,all.x=T)
w[,case:=nafill(case,,0)][,dead:=nafill(dead,,0)]
w=w[,.(dead=sum(dead),case=sum(case)),.(age=agecut(age,ages),week=match(week,weeks),dose)]
w=rbind(w,w[,.(dead=sum(dead),case=sum(case),dose=2),.(age,week)])

lab=c(&quot;Unvaccinated&quot;,&quot;Vaccinated&quot;,&quot;Unvaccinated and vaccinated&quot;)
w[,z:=factor(dose,,lab)]

p=merge(w[,.(case=ma(case,2),x=week+3),.(age,z)],w[,.(dead=ma(dead,2),x=week),.(age,z)],all=T)
p[is.na(case),case:=0][is.na(dead),dead:=0]
p[,y:=ifelse(case&lt;5,NA,dead/case*100)]
p=p[!is.na(age)]
p[y&gt;100,y:=100]

xstart=1;xend=length(weeks)

ggplot(p,aes(x))+
facet_wrap(~age,ncol=1,strip.position=&quot;top&quot;,dir=&quot;v&quot;,scales=&quot;free_y&quot;)+
geom_vline(xintercept=grep(&quot;-01&quot;,weeks),linewidth=.4,color=&quot;gray66&quot;,lineend=&quot;square&quot;)+
geom_line(aes(y=y,color=z,linetype=z),linewidth=.6)+
geom_text(data=p[,.(ymax=max(y,na.rm=T)),age],aes(label=sprintf(&quot;\n  Age %s  \n&quot;,age),y=ymax*.87),x=mean(c(xstart,xend)),hjust=.5,size=3.9,fontface=2)+
labs(x=NULL,y=NULL,title=&quot;Czech Republic: Weekly percentage of COVID deaths per COVID\ncases (cases shifted 3 weeks forwards)&quot;)+
scale_x_continuous(limits=c(xstart,xend),breaks=grep(&quot;-26&quot;,weeks),labels=2020:2024)+
scale_y_continuous(breaks=\(x){y=pretty(x,4);y[y&lt;max(x)*.9]},labels=\(x)paste0(x,&quot;%&quot;))+
scale_color_manual(values=c(hsv(c(7,0)/12,1,.8),&quot;black&quot;,hsv(30/36,.5,1)))+
scale_linetype_manual(values=c(&quot;solid&quot;,&quot;solid&quot;,&quot;solid&quot;,&quot;42&quot;))+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
guides(color=guide_legend(nrow=1,byrow=F))+
theme(axis.text=element_text(size=11,color=&quot;black&quot;),
  axis.ticks=element_line(color=&quot;black&quot;,linewidth=.4),
  axis.text.x=element_text(margin=margin(4)),
  axis.ticks.length.x=unit(0,&quot;pt&quot;),
  axis.ticks.length.y=unit(4,&quot;pt&quot;),
  legend.background=element_blank(),
  legend.box.spacing=unit(0,&quot;pt&quot;),
  legend.direction=&quot;horizontal&quot;,
  legend.justification=&quot;right&quot;,
  legend.key=element_blank(),
  legend.key.height=unit(13,&quot;pt&quot;),
  legend.key.width=unit(26,&quot;pt&quot;),
  legend.margin=margin(,,5),
  legend.position=&quot;top&quot;,
  legend.spacing.x=unit(2,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.text=element_text(size=11,vjust=.5),
  legend.title=element_blank(),
  panel.background=element_blank(),
  panel.border=element_rect(fill=NA,linewidth=.4),
  panel.grid=element_blank(),
  panel.spacing=unit(3,&quot;pt&quot;),
  plot.margin=margin(5,5,5,5),
  plot.title=element_text(size=11,face=&quot;bold&quot;,margin=margin(1,,3)),
  strip.background=element_blank(),
  strip.text=element_blank())
ggsave(&quot;1.png&quot;,width=5.38,height=5.3,dpi=300*4)
sub=&quot;Each line shows a ±2-week moving average of deaths divided by a ±2-week moving average of cases, where the lines are not drawn on weeks where the ±2-week moving average of cases is below 5. COVID deaths are deaths where the difference between the week of death and week of positive test or hospitalization is 0-3 weeks, so many deaths classified as COVID deaths here were not actually due to COVID. The age groups were determined by subtracting the year of birth from 2020 so that aging over time was not accounted for. Source: nzip.cz/data/2135-covid-19-prehled-populace.&quot;
system(paste0(&quot;mar=$[24*4];w=`identify -format %w 1.png`;magick \\( 1.png -gravity southwest -chop 0x50 \\) \\( -size $[w-mar*2]x -font Arial -interline-spacing -3 -pointsize $[44*4] caption:&#39;&quot;,gsub(&quot;&#39;&quot;,&quot;&#39;\\\\&#39;&quot;,sub),&quot;&#39; -gravity southwest -splice $[mar]x$[20*4] \\) -append -resize 25% PNG8:1.png&quot;))</pre>
</div>
<p>The two previous plots show that regardless of whether I shifted the
cases forwards or not, unvaccinated people had higher CFR than
vaccinated people. Within age groups unvaccinated people had both higher
COVID mortality rate than vaccinated people and a higher rate of COVID
cases, but the difference in deaths was bigger than the difference in
cases, which explains why unvaccinated people also had higher CFR.</p>
<p>In the two previous plots I treated deaths that occurred within three
weeks of a positive test or hospitalization as COVID deaths, because I
thought that the new UZIS dataset did not indicate which deaths were due
to COVID. However then I realized that the column <code>Umrti</code>
showed the week of death for COVID deaths but the column
<code>DatumUmrtiLPZ</code> showed the week of death for all-cause
deaths. But actually it doesn't seem to make too much difference which
definition for a COVID death I use, because when I determined the number
of COVID deaths based on the <code>Umrti</code> column, the result was
not much different from the number of deaths which occurred on the same
week as the last week of a COVID hospitalization:</p>
<div>
<img src=i/czech-cfr-4.gif width=600>
</div>
<p>In the winter of 2020-2021 deaths and hospitalizations had a pattern
with three distinct humps, where in ages 80+ where about half of people
had been vaccinated by the time of the third hump, the third hump was
lower than the first and second humps, but in younger age groups the
third hump was not as low relative to the two earlier humps. However a
similar pattern can be seen in the next plot for cases, where in ages
80+ the third hump was much lower than the first two humps, but in ages
60-79, 40-59, and 10-39 the third hump was about as high as the first
two humps:</p>
<div>
<img src=i/czech-cfr-2.png width=600>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table);library(ggplot2)

agecut=\(x,y)cut(x,c(y,Inf),paste0(y,c(paste0(&quot;-&quot;,y[-1]-1),&quot;+&quot;)),T,F)
ages=c(10,40,60,80)

weeks=unique(format(seq(as.Date(&quot;2020-1-1&quot;),as.Date(&quot;2024-12-31&quot;),1),&quot;%G-%V&quot;))

t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv.gz&quot;)
t[RokNarozeni!=&quot;-&quot;,age:=pmin(100,(2020-as.integer(substr(RokNarozeni,1,4))))]
t[,dose:=ifelse(Datum_Prvni_davka!=&quot;&quot;&amp;Datum_Prvni_davka&lt;=DatumPozitivity,1,0)]

a=t[DatumPozitivity!=&quot;&quot;,.(cases=.N),.(week=DatumPozitivity,dose,age)]
a=merge(do.call(CJ,lapply(a[,-4],unique)),a,all.x=T)[is.na(cases),cases:=0][]

b=fread(&quot;http://sars2.net/f/czbucketsdaily.csv.gz&quot;)
b=b[,.(pop=sum(alive)),.(week=format(date,&quot;%G-%V&quot;),dose=pmin(dose,1),age=pmin(90,age)%/%5*5)]
b=rbind(b,b[week==&quot;2022-51&quot;,.(week=setdiff(a[week!=&quot;&quot;&amp;!week%like%2020,week],week),pop),.(dose,age)])
b=b[rowid(week,dose,age)==1]
a=merge(a,b)
a=a[!week%like%2024]
a=a[age&gt;=10]

a=rbind(a,a[,.(cases=sum(cases),pop=sum(pop),dose=2),.(week,age)])

a=merge(fread(&quot;http://sars2.net/f/czcensus2021pop.csv&quot;)[,.(std=sum(pop)),.(age=age%/%5*5)][,std:=std/sum(std)],a)
lab=c(&quot;Unvaccinated&quot;,&quot;Vaccinated&quot;,&quot;Unvaccinated and vaccinated&quot;)
p=a[,.(pop=sum(pop),y=sum(cases/pop*std/7*365e5)),.(age=agecut(age,ages),week,z=factor(dose,,lab))]
p[pop&lt;1e4,y:=NA]

ymax=p[,.(ymax=max(y,na.rm=T)),age]
p=merge(p,ymax)[,.(week,y=y/ymax*100,age,z)]

pct=b[,.(pop=sum(pop)),.(week,age=agecut(age,ages),dose)]
pct=dcast(pct,week+age~dose,value.var=&quot;pop&quot;)[,`1`:=nafill(`1`,,0)]
pct=pct[week&gt;=b[dose==1,min(week)]]
p=rbind(p,pct[,.(week,age,z=&quot;Vaccinated percent&quot;,y=`1`/(`0`+`1`)*100)])

xval=unique(format(seq(as.Date(&quot;2020-1-1&quot;),as.Date(&quot;2023-12-31&quot;),1),&quot;%G-%V&quot;))

p=p[!is.na(age)]
p=p[week&lt;=&quot;2024-01&quot;]
p[,x:=match(week,weeks)]

ggplot(p,aes(x))+
facet_wrap(~age,ncol=1,strip.position=&quot;top&quot;,dir=&quot;v&quot;,scales=&quot;free_y&quot;)+
geom_vline(xintercept=grep(&quot;-01&quot;,weeks),linewidth=.4,color=&quot;gray66&quot;,lineend=&quot;square&quot;)+
geom_vline(xintercept=range(p$x),linewidth=.4,lineend=&quot;square&quot;)+
geom_hline(yintercept=c(0,100),linewidth=.4,lineend=&quot;square&quot;)+
geom_line(aes(y=y,color=z,linetype=z),linewidth=.6)+
geom_label(data=ymax,aes(label=sprintf(&quot;\n  Age %s (max %.0f)  \n&quot;,age,ymax),y=100),x=max(p$x),lineheight=.5,hjust=1,vjust=1,size=3.6,fill=alpha(&quot;white&quot;,1),label.r=unit(0,&quot;pt&quot;),label.padding=unit(0,&quot;pt&quot;),label.size=.4)+
labs(x=NULL,y=NULL,title=&quot;Czech Republic: Weekly age-standardized rate of COVID cases\nper 100,000 person-years&quot;,subtitle=&quot;Displayed as percentage of maximum value shown in parentheses&quot;)+
scale_x_continuous(limits=range(p$x),breaks=grep(&quot;-26&quot;,weeks),labels=2020:2024)+
scale_y_continuous(breaks=1:4*20,limits=c(0,100),labels=\(x)paste0(x,&quot;%&quot;))+
scale_color_manual(values=c(hsv(c(7,0)/12,1,.8),&quot;black&quot;,hsv(30/36,.5,1)))+
scale_linetype_manual(values=c(&quot;solid&quot;,&quot;solid&quot;,&quot;solid&quot;,&quot;42&quot;))+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
guides(color=guide_legend(nrow=2,byrow=F))+
theme(axis.text=element_text(size=11,color=&quot;black&quot;),
  axis.ticks=element_line(color=&quot;black&quot;,linewidth=.4),
  axis.text.x=element_text(margin=margin(4)),
  axis.ticks.length.x=unit(0,&quot;pt&quot;),
  axis.ticks.length.y=unit(4,&quot;pt&quot;),
  legend.background=element_blank(),
  legend.box.spacing=unit(0,&quot;pt&quot;),
  legend.direction=&quot;horizontal&quot;,
  legend.justification=&quot;center&quot;,
  legend.key=element_blank(),
  legend.key.height=unit(13,&quot;pt&quot;),
  legend.key.width=unit(26,&quot;pt&quot;),
  legend.margin=margin(,,4),
  legend.position=&quot;top&quot;,
  legend.spacing.x=unit(2,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.text=element_text(size=11,vjust=.5),
  legend.title=element_blank(),
  panel.background=element_blank(),
  panel.grid=element_blank(),
  panel.spacing=unit(3,&quot;pt&quot;),
  plot.margin=margin(5,5,5,5),
  plot.subtitle=element_text(size=11,margin=margin(,,3)),
  plot.title=element_text(size=11,face=&quot;bold&quot;,margin=margin(1,,5)),
  strip.background=element_blank(),
  strip.text=element_blank())
ggsave(&quot;1.png&quot;,width=5.3,height=5.3,dpi=300*4)

sub=&quot;The 2021 census population by 5-year age groups was used as the standard population. People were given a year of birth as a range of 5 years like 1950-1954, so here each person was assigned to a 5-year age group by subtracting the year of birth from 2020 so that aging over time was not accounted for. The resident population estimates in the 2021 census were used as the standard population. The age-standardized rates are not shown on days with population size below 10,000. Sources: nzip.cz/data/2135-covid-19-prehled-populace (cases) and github.com/PalackyUniversity/uzis-data-analysis (number of vaccinated and unvaccinated people by age).&quot;
system(paste0(&quot;mar=$[24*4];w=`identify -format %w 1.png`;magick \\( 1.png -gravity southwest -chop 0x70 \\) \\( -size $[w-mar*2]x -font Arial -interline-spacing -3 -pointsize $[44*4] caption:&#39;&quot;,gsub(&quot;&#39;&quot;,&quot;&#39;\\\\&#39;&quot;,sub),&quot;&#39; -gravity southwest -splice $[mar]x$[20*4] \\) -append -resize 25% -colors 256 1.png&quot;))</pre>
</div>
<p>Added later: I now figured out a better method to calculate CFR which
doesn't require shifting deaths or cases, which is to simple look at the
proportion of cases by the <code>DatumPozitivity</code> column where the
<code>Umrti</code> column is not empty. But by that method the CFR also
went down during the first half of 2021:</p>
<div>
<img src=i/czech-cfr-5.png width=600>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table);library(ggplot2)

ma=\(x,b=1,f=b){x[]=rowMeans(embed(c(rep(NA,b),x,rep(NA,f)),f+b+1),na.rm=T);x}

agecut=\(x,y)cut(x,c(y,Inf),paste0(y,c(paste0(&quot;-&quot;,y[-1]-1),&quot;+&quot;)),T,F)
ages=c(10,40,60,80)

weeks=unique(format(seq(as.Date(&quot;2020-1-1&quot;),as.Date(&quot;2024-12-31&quot;),1),&quot;%G-%V&quot;))

t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv.gz&quot;)

d=t[RokNarozeni!=&quot;-&quot;]
d[,age:=pmin(100,(2020-as.integer(substr(RokNarozeni,1,4))))]
d=d[!is.na(age)]
d=d[DatumPozitivity!=&quot;&quot;]
d[,dose:=as.integer(Datum_Prvni_davka!=&quot;&quot;&amp;Datum_Prvni_davka&lt;=DatumPozitivity)]

a=d[,.(cases=.N,dead=sum(Umrti!=&quot;&quot;)),,.(week=DatumPozitivity,dose,age=agecut(age,ages))]
a=a[!is.na(age)]
a=merge(do.call(CJ,lapply(a[,1:3],unique)),a,all.x=T)
a[is.na(cases),cases:=0][is.na(dead),dead:=0]

a=rbind(a,a[,.(cases=sum(cases),dead=sum(dead),dose=2),.(week,age)])

p=a[,.(y=ifelse(ma(cases,2)&lt;5,NA,ma(dead/cases*100,2)),week),.(dose,age)]
lab=c(&quot;Unvaccinated&quot;,&quot;Vaccinated&quot;,&quot;All people&quot;)
p[,z:=factor(dose,,lab)]
p[,x:=match(week,weeks)]

xstart=1;xend=length(weeks)

ggplot(p,aes(x,y))+
facet_wrap(~age,ncol=1,strip.position=&quot;top&quot;,dir=&quot;v&quot;,scales=&quot;free_y&quot;)+
geom_vline(xintercept=grep(&quot;-01&quot;,weeks),linewidth=.4,color=&quot;gray66&quot;,lineend=&quot;square&quot;)+
geom_line(aes(color=z),linewidth=.6)+
geom_text(data=p[,.(y=max(y,na.rm=T)),age],aes(label=sprintf(&quot;\n  Age %s  \n&quot;,age),y=y*.87),x=mean(c(xstart,xend)),hjust=.5,size=3.9,fontface=2)+
labs(x=NULL,y=NULL,title=&quot;Czech Republic: Weekly percentage of COVID cases that led to a death&quot;)+
scale_x_continuous(limits=c(xstart,xend),breaks=grep(&quot;-26&quot;,weeks),labels=2020:2024)+
scale_y_continuous(breaks=\(x){y=pretty(x,4);y[y&lt;max(x)*.9]},labels=\(x)paste0(x,&quot;%&quot;))+
scale_color_manual(values=c(hsv(c(7,0)/12,1,.8),&quot;black&quot;,hsv(30/36,.5,1)))+
scale_linetype_manual(values=c(&quot;solid&quot;,&quot;solid&quot;,&quot;solid&quot;,&quot;42&quot;))+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
guides(color=guide_legend(nrow=1,byrow=F))+
theme(axis.text=element_text(size=11,color=&quot;black&quot;),
  axis.ticks=element_line(color=&quot;black&quot;,linewidth=.4),
  axis.text.x=element_text(margin=margin(4)),
  axis.ticks.length.x=unit(0,&quot;pt&quot;),
  axis.ticks.length.y=unit(4,&quot;pt&quot;),
  legend.background=element_blank(),
  legend.box.spacing=unit(0,&quot;pt&quot;),
  legend.direction=&quot;horizontal&quot;,
  legend.justification=&quot;right&quot;,
  legend.key=element_blank(),
  legend.key.height=unit(13,&quot;pt&quot;),
  legend.key.width=unit(26,&quot;pt&quot;),
  legend.margin=margin(,,5),
  legend.position=&quot;top&quot;,
  legend.spacing.x=unit(2,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.text=element_text(size=11,vjust=.5),
  legend.title=element_blank(),
  panel.background=element_blank(),
  panel.border=element_rect(fill=NA,linewidth=.4),
  panel.grid=element_blank(),
  panel.spacing=unit(3,&quot;pt&quot;),
  plot.margin=margin(5,5,5,5),
  plot.title=element_text(size=11,hjust=1,face=&quot;bold&quot;,margin=margin(2,,3)),
  strip.background=element_blank(),
  strip.text=element_blank())
ggsave(&quot;1.png&quot;,width=5.38,height=5.3,dpi=300*4)
sub=&quot;Each line shows a ±2-week moving average cases that led to a COVID death for the given week divided by a ±2-week moving average of total cases for the same week, where the week is the week of a positive test result. The lines are not drawn on weeks where the ±2-week moving average of cases is below 5. COVID deaths are deaths listed in the `Umrti` column. The age groups were determined by subtracting the year of birth from 2020 so that aging over time was not accounted for. People are counted as vaccinated on the week of the first dose. Source: nzip.cz/data/2135-covid-19-prehled-populace.&quot;
system(paste0(&quot;mar=$[24*4];w=`identify -format %w 1.png`;magick \\( 1.png -gravity southwest -chop 0x50 \\) \\( -size $[w-mar*2]x -font Arial -interline-spacing -3 -pointsize $[44*4] caption:&#39;&quot;,gsub(&quot;&#39;&quot;,&quot;&#39;\\\\&#39;&quot;,sub),&quot;&#39; -gravity southwest -splice $[mar]x$[20*4] \\) -append -resize 25% PNG8:1.png&quot;))</pre>
</div>
<h2>
<a href=#Daily_raw_number_of_deaths_by_vaccination_status id=Daily_raw_number_of_deaths_by_vaccination_status>Daily
raw number of deaths by vaccination status</a>
</h2>
<p>In December 2023 Kirsch published a spreadsheet he received from a
source at HHS, which shows the daily number of deaths by vaccination
status among people enrolled to Medicare. The dataset doesn't show the
ages of people who died or the population sizes of each age group so I
wasn't able to plot ASMR by vaccination status but I had to simply plot
the raw deaths. But even the raw deaths show that the spike in deaths
during the Delta wave was much more pronounced in unvaccinated people
than vaccinated people:
[<a href=rootclaim.html#Post_by_Spiro_Pantazatos_for_mortality_by_state_during_the_Delta_wave>rootclaim.html#Post_by_Spiro_Pantazatos_for_mortality_by_state_during_the_Delta_wave</a>]</p>
<div>
<img src=i/rootclaim-medicareraw.png width=600>
</div>
<p>I also tried making a similar plot for the Czech data. In the Czech
Republic the Delta wave only peaked around November to December 2021,
but even from the top panel below which shows the raw number of deaths,
you can see that the increase in deaths during the Delta wave was much
more pronounced in unvaccinated people than vaccinated people:</p>
<div>
<img src=i/czech-rawfacet.png width=600>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>library(data.table);library(ggplot2);library(readxl)

ma=\(x,b=1,f=b){x[]=rowMeans(embed(c(rep(NA,b),x,rep(NA,f)),f+b+1),na.rm=T);x}

ages=c(0,3:9*5,50:89,18:20*5)

t=fread(&quot;http://sars2.net/f/czbucketsdaily.csv.gz&quot;)
t[,z:=ifelse(dose==0,3,2)]

p=t[,.(y=as.double(sum(dead))),.(z,x=date)]
p=rbind(p,p[,.(y=sum(y),z=1),x])[,type:=1]

a=t[,.(dead=sum(dead),pop=sum(alive)),.(z,x=date,age=ages[findInterval(age,ages)])]
a=rbind(a,a[,.(dead=sum(dead),pop=sum(pop),z=1),.(x,age)])
a=merge(a,fread(&quot;http://sars2.net/f/czcensus2021pop.csv&quot;)[,std:=pop/sum(pop)][,.(std=sum(std)),.(age=ages[findInterval(age,ages)])])
p=rbind(p,a[,.(y=sum(dead/pop*std*365e5),type=2),.(x,z)])

p[,z:=factor(z,,c(&quot;All people&quot;,&quot;Vaccinated&quot;,&quot;Unvaccinated&quot;))]
p[,type:=factor(type,,c(&quot;Deaths&quot;,&quot;Age-standardized mortality rate per 100,000 person-years&quot;))]
p[,y:=ma(y,3),,.(type,z)]

xstart=as.Date(&quot;2020-1-1&quot;);xend=as.Date(&quot;2023-1-1&quot;)
xbreak=seq(xstart+182,xend,&quot;year&quot;)
p=p[x%in%xstart:xend]
ybreak=pretty(c(0,p$y),7)

segx=seq(xstart,xend,&quot;month&quot;)

ggplot(p,aes(x,y,z))+
facet_wrap(~type,dir=&quot;v&quot;,scales=&quot;free&quot;)+
geom_vline(xintercept=seq(xstart,xend,&quot;month&quot;),color=&quot;gray92&quot;,linewidth=.4)+
geom_vline(xintercept=seq(xstart,xend,&quot;year&quot;),color=&quot;black&quot;,linewidth=.4)+
geom_line(aes(color=z),linewidth=.6)+
labs(x=NULL,y=NULL,title=&quot;Daily deaths and ASMR in Czech Republic (±3-day moving average)&quot;)+
scale_x_continuous(limits=c(xstart-.5,xend+.5),breaks=xbreak,labels=year(xbreak))+
scale_y_continuous(limits=\(x)c(0,max(x)*1.02),breaks=\(x)pretty(x,6))+
scale_color_manual(values=c(&quot;black&quot;,&quot;#ff6666&quot;,&quot;#6666ff&quot;))+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
theme(axis.text=element_text(size=11,color=&quot;black&quot;),
  axis.text.x=element_text(margin=margin(3)),
  axis.ticks=element_line(linewidth=.4,color=&quot;black&quot;),
  axis.ticks.length.x=unit(0,&quot;pt&quot;),
  axis.ticks.length.y=unit(4,&quot;pt&quot;),
  legend.box.background=element_blank(),
  legend.box.spacing=unit(0,&quot;pt&quot;),
  legend.direction=&quot;horizontal&quot;,
  legend.justification=&quot;right&quot;,
  legend.key=element_blank(),
  legend.key.height=unit(13,&quot;pt&quot;),
  legend.key.width=unit(26,&quot;pt&quot;),
  legend.margin=margin(),
  legend.position=&quot;top&quot;,
  legend.spacing.x=unit(2,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.text=element_text(size=11,vjust=.5),
  legend.title=element_blank(),
  panel.background=element_blank(),
  panel.border=element_rect(fill=NA,linewidth=.4),
  panel.spacing=unit(2,&quot;pt&quot;),
  plot.margin=margin(5,5,5,5),
  plot.title=element_text(hjust=1,size=11,face=2,margin=margin(2,,4)),
  strip.background=element_blank(),
  strip.text=element_text(margin=margin(,,4),size=11,hjust=0))
ggsave(&quot;1.png&quot;,width=5.3,height=4.3,dpi=300*4)

sub=&quot;Source: github.com/PalackyUniversity/uzis-data-analysis. People are counted as vaccinated from the day of the first dose. Partially vaccinated people are not excluded. The age groups used for ASMR were 0-14, single years of age for ages 50-89, and 5-year age groups for other ages. The resident population estimates in the 2021 census were used as the standard population.&quot;
system(paste0(&quot;mogrify -trim 1.png;magick 1.png \\( -size `identify -format %w 1.png`x -font Arial -interline-spacing -3 -pointsize $[43*4] caption:&#39;&quot;,gsub(&quot;&#39;&quot;,&quot;&#39;\\\\&#39;&quot;,sub),&quot;&#39; -splice x80 \\) -append -resize 25% -bordercolor white -border 24 -colors 256 1.png&quot;))</pre>
</div>
<h2>
<a href=#Monthly_ASMR_by_vaccination_status id=Monthly_ASMR_by_vaccination_status>Monthly
ASMR by vaccination status</a>
</h2>
<p>This plot is basically the same as my earlier plot for a moving
average of daily ASMR, but I now plotted monthly ASMR instead. Both
plots are based on the <code>czbuckets.csv.gz</code> file generated by
the code here:
<a href=czech.html#Bucket_analysis>czech.html#Bucket_analysis</a>.</p>
<div>
<img src=i/czech-monthlyasmr.png width=600>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>agecut=\(x,y)cut(x,c(y,Inf),paste0(y,c(paste0(&quot;-&quot;,y[-1]-1),&quot;+&quot;)),T,F)

ages=c(0,3:4*10,seq(50,95,5))

t=fread(&quot;http://sars2.net/f/czbuckets.csv.gz&quot;)
std=fread(&quot;http://sars2.net/f/czcensus2021pop.csv&quot;)

doses=c(&quot;Unvaccinated&quot;,paste(&quot;Dose&quot;,c(1:3,&quot;4+&quot;)))
a=t[,.(dead=sum(dead),pop=sum(alive)),.(dose=factor(doses[pmin(dose,4)+1],doses),age=agecut(age,ages),month)]
a=rbind(a,a[dose!=&quot;Unvaccinated&quot;,.(dead=sum(dead),pop=sum(pop),dose=&quot;Vaccinated&quot;),.(age,month)])
a=rbind(a,a[dose%like%&quot;accinated&quot;,.(dead=sum(dead),pop=sum(pop),dose=&quot;All people&quot;),.(age,month)])
a=merge(a,std[,.(std=sum(pop)),.(age=agecut(age,ages))][,std:=std/sum(std)])

p=a[,.(pop=sum(pop),y=sum(dead/pop*std*365e5)),.(x=as.Date(paste0(month,&quot;-1&quot;)),z=dose)]
p[pop/365&lt;1e3,y:=NA]
frac=p[!z%in%c(&quot;Vaccinated&quot;,&quot;All people&quot;),.(frac=pop/sum(pop),z),x]

ybreak=pretty(p$y,8);ystart=0;yend=max(ybreak);xstart=min(p$x);xend=max(p$x)

pal=c(hcl(c(21,11,6,0,31)*10+15,90,70),&quot;black&quot;,&quot;gray50&quot;)

ggplot(p,aes(x,y,color=z))+
geom_area(data=frac,aes(y=frac*yend*.9999,fill=z),linewidth=.15,show.legend=F,alpha=.3)+
annotate(&quot;rect&quot;,xmin=xstart,xmax=xend,ymin=ystart,ymax=yend,linewidth=.4,lineend=&quot;square&quot;,fill=NA,color=&quot;black&quot;)+
geom_line(aes(linetype=z,linewidth=z))+
geom_point(aes(alpha=z),size=1)+
annotate(&quot;label&quot;,x=xstart,y=yend,hjust=0,vjust=1,size=3.8,label=&quot;ASMR per 100,000 person-years&quot;,label.r=unit(0,&quot;pt&quot;),label.padding=unit(5,&quot;pt&quot;),label.size=.4)+
annotate(&quot;label&quot;,x=xend,y=yend,hjust=1,vjust=1,size=3.8,label=&quot;Percentage of group&quot;,label.r=unit(0,&quot;pt&quot;),label.padding=unit(5,&quot;pt&quot;),label.size=.4)+
scale_x_date(breaks=unique(p$x)[c(T,F)],date_labels=&quot;%b\n%y&quot;)+
scale_y_continuous(limits=c(ystart,yend),breaks=seq(0,yend,1000),labels=\(i)ifelse(i&lt;1000,i,paste0(i/1e3,&quot;k&quot;)),sec.axis=sec_axis(trans=~./yend*100,labels=\(x)paste0(x,&quot;%&quot;)))+
labs(x=NULL,y=NULL)+
ggtitle(&quot;Age-standardized mortality rate in Czech Republic&quot;)+
scale_color_manual(values=pal)+
scale_linetype_manual(values=rep(c(&quot;solid&quot;,&quot;42&quot;),c(6,1)))+
scale_linewidth_manual(values=rep(c(.4,.6),c(6,1)))+
scale_alpha_manual(values=rep(1:0,c(6,1)))+
scale_fill_manual(values=pal)+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
guides(color=guide_legend(nrow=2))+
theme(axis.text=element_text(size=10,color=&quot;black&quot;),
  axis.ticks=element_line(linewidth=.4),
  axis.ticks.length=unit(3,&quot;pt&quot;),
  axis.title=element_text(size=11),
  legend.background=element_blank(),
  legend.box.background=element_blank(),
  legend.box.just=&quot;center&quot;,
  legend.box.spacing=unit(0,&quot;pt&quot;),
  legend.direction=&quot;vertical&quot;,
  legend.key=element_rect(fill=&quot;white&quot;),
  legend.key.height=unit(13,&quot;pt&quot;),
  legend.key.width=unit(26,&quot;pt&quot;),
  legend.justification=&quot;center&quot;,
  legend.margin=margin(,,3),
  legend.position=&quot;top&quot;,
  legend.spacing.x=unit(2,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.text=element_text(size=10.5),
  legend.title=element_blank(),
  panel.background=element_blank(),
  plot.margin=margin(5,5,4,5),
  plot.title=element_text(size=11,face=2,hjust=.5,margin=margin(,,2)))
ggsave(&quot;1.png&quot;,width=5.6,height=3.7,dpi=300*4)

sub=&quot;Source: github.com/PalackyUniversity/uzis-data-analysis. The 2021 census population was used as the standard population, with age groups 0-29, 30-39, 40-49, 50-54, ..., 90-94, 95+.&quot;
system(paste0(&quot;mogrify -trim 1.png;magick 1.png \\( -size `identify -format %w 1.png`x -font Arial -interline-spacing -3 -pointsize $[44*4] caption:&#39;&quot;,gsub(&quot;&#39;&quot;,&quot;&#39;\\\\&#39;&#39;&quot;,sub),&quot;&#39; -splice x80 \\) -append -resize 25% -bordercolor white -border 24 -dither none -colors 256 1.png&quot;))</pre>
</div>
<h2>
<a href=#Kirsch_regrets_not_appreciating_the_effect_of_confounders_in_his_analysis_of_the_Czech_data id=Kirsch_regrets_not_appreciating_the_effect_of_confounders_in_his_analysis_of_the_Czech_data>Kirsch
regrets not appreciating the effect of confounders in his analysis of
the Czech data</a>
</h2>
<p>In a PDF file Kirsch published in June 2025 as part of the Rootclaim
debate, he now wrote that he regrets not having appreciated the effect
of confounders when he compared the mortality of Moderna against Pfizer
in the Czech data:
[<a href=https://www.skirsch.com/covid/KIRSCH_COVID_shot_analysis.pdf>https://www.skirsch.com/covid/KIRSCH_COVID_shot_analysis.pdf</a>]</p>
<blockquote>
<p>In previous analyses of the Czech data, I found that the Moderna
shots were more deadly than the Pfizer shots. That calculation was using
the raw, unadjusted data.</p>
<p>In fact, in the Levi study, in the unadjusted FULL cohort, they found
the same thing (that in the raw, unadjusted full cohort, Moderna appears
to be more deadly):</p>
<div>
<img src=i/czech-regret.png width=600>
</div>
<p>However, after <strong>basic adjustments were made to the FULL COHORT
(9M), they found that Pfizer was in fact more deadly</strong> (see the
second line of the figure above).</p>
<p>And after doing extremely tight matching, it changed the adjusted
full cohort by less than 0.5%, a tiny amount.</p>
<p>My earlier Czech analysis didn't do any of these adjustments. This is
why in observational studies they do adjustments like these because
sometimes they can flip the result.</p>
<p>The fact that the Levi study FULL cohort with basic adjustments
nearly exactly matched the nearly exactly matched MATCHED cohort
<strong>is extremely powerful</strong>.</p>
<p>The reality of course is that <strong>both vaccines were quite
deadly</strong>. If Moderna was 100% safe as we have assumed in this
analysis (since we don't know the absolute level of NCACM harm),
<strong>most all the VAERS death reports would be for only one brand of
vaccine</strong>; that just isn't the case.</p>
<p>This is a perfect example of why, when looking at observational data,
basic adjustments to the raw data are necessary. I regret that I did not
fully appreciate that before.</p>
</blockquote>
<p>In 2024 Kirsch kept insisting that Pfizer and Moderna vaccines were
distributed randomly and without bias in the Czech Republic, so the
difference in mortality could not have been due to confounders, even
though me and Uncle John Returns and Jeffrey Morris kept telling him
otherwise.</p>
<p>In the first round of the Rootclaim debate in 2024, Kirsch wrote:
[<a href=https://kirschsubstack.com/p/did-the-covid-vaccine-save-more-people>https://kirschsubstack.com/p/did-the-covid-vaccine-save-more-people</a>]</p>
<blockquote>
<p>The
<a href=https://github.com/PalackyUniversity/uzis-data-analysis>Czech
Republic record-level data</a> obtained under
<a href=https://www.skirsch.com/covid/CzechFOIA.pdf>FOIA request from
the Czech government</a> showed that people who got the Moderna vaccine
were <strong>30% more likely to die within 1 year of the shot than
people who got the Pfizer vaccine</strong>. The
<a href=https://kirschsubstack.com/p/the-covid-vaccine-all-risk-no-benefit>30%
difference appeared in all age groups where there was sufficient
data</a> and it happened during NON-COVID time periods. People tried to
attack this claiming that it was due to distribution bias, but
<a href=https://kirschsubstack.com/p/a-summary-of-why-the-czech-republic>we
showed that was false</a>. The reason this is such an important study is
because you cannot compare vaccinated with unvaccinated death rates due
to selection bias. But in the Czech Republic, the vaccines were randomly
assigned and nobody had any clue which one was safer. So there was no
systematic or systemic bias. So how can the death rates be 30% higher in
every age group with sufficient data? <strong>The only way that can
happen is if the Moderna vaccine is more deadly.</strong> And in that
document we show 8 different data points that are consistent with
Moderna having a higher adverse event rate. We believe the higher death
rate in Moderna vs. Pfizer is primarily due to the <strong>100mcg dose
vs. 30 mcg dose.</strong> The more poison, the more death. There have
been very few brand comparison studies like this and what they do is
adjust the numbers to make the death differences go away because their
assumption going into it is that the vaccines should have equal
mortality rates so they get rid of the differences statistically. This
is raw data. You can't have a 30% higher death rate in nearly all 5 year
age groups over 50. That's statistically unlikely to happen. And even if
Pfizer was 100% safe, <strong>a 30% increase in ACM (over the first year
from the shot) is a disaster.</strong></p>
</blockquote>
<p>However even though he summarized many of his earlier arguments in
his new PDF, he no longer repeated his earlier claim that the Czech data
showed that Moderna was more deadly than Pfizer.</p>
<h2>
<a href=#ASMR_and_vaccine_doses_administered_by_age_group_in_NZIP_data id=ASMR_and_vaccine_doses_administered_by_age_group_in_NZIP_data>ASMR
and vaccine doses administered by age group in NZIP data</a>
</h2>
<p>USMortality posted this tweet:
[<a href=https://x.com/USMortality/status/1975667010341425586>https://x.com/USMortality/status/1975667010341425586</a>]</p>
<div>
<img src=i/czech-nzip-age-facet.png width=550>
</div>
<p>I pointed out that the Alpha spike around March 2021 occurs around
the same time in all age groups, even though young people got vaccinated
later than old people. And the same thing applies to the Delta spike in
November to December 2021, which Rancourt blamed on the vaccines:</p>
<div>
<img src=i/czech-nzip-age-facet-2.png width=580>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>t=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv.gz&quot;)

t=t[RokNarozeni!=&quot;-&quot;]
t=t[Infekce%in%c(1,NA)]

t[,born:=pmin(pmax(1920,as.integer(substr(RokNarozeni,1,4))),2000)]
t[,vax:=Datum_Prvni_davka]
t[,dose:=(vax!=&quot;&quot;)*1]

pop=t[vax!=&quot;&quot;,.(pop=.N,dose=1),.(week=vax,born)]
pop=rbind(pop,t[,.(week=&quot;2020-10&quot;,pop=.N,dose=0),born])

dead=t[,.(dead=.N),.(week=DatumUmrtiLPZ,dose,born)]
covid=t[,.(covid=.N),.(week=Umrti,dose,born)]
a=merge(covid,merge(dead,pop,all=T),all=T)[week!=&quot;&quot;]

a=merge(do.call(CJ,lapply(a[,1:3],unique)),a,all=T);a[is.na(a)]=0
a[dose==0,pop:=pop-a[dose==1,pop]]
a[,pop:=cumsum(pop-dead),.(born,dose)]

a=a[,.(type=1:2,dead=dead-c(0,covid),pop),.(week,dose,born)]
a=rbind(a,a[,.(dead=sum(dead),pop=sum(pop),dose=2),.(week,born,type)])

a=a[,.(week,dead=ma(dead,2),pop=ma(pop,2)),.(type,born,dose)]

groups=c(1900,1935,1950,1970)
a[,group:=agecut(born,groups)]
a[,std:=tapply(pop,born,sum)[factor(born)]/sum(pop)]

iso=as.IDate(0:1e4*7);names(iso)=format(iso,&quot;%G-%V&quot;)

p=a[,.(y=ifelse(pop&lt;1e3,NA_real_,sum(dead/pop*std/7*365e5))),.(x=iso[week],type,dose,group)]

p[,type:=factor(type,,c(&quot;All causes&quot;,&quot;Not COVID&quot;))]
p[,dose:=factor(dose,,c(&quot;Unvaccinated&quot;,&quot;Vaccinated&quot;,&quot;Total&quot;))]

xmin=as.Date(&quot;2021-1-1&quot;);xmax=as.Date(&quot;2024-1-1&quot;)
p=p[x&gt;=xmin&amp;x&lt;=xmax]
xbreak=seq(xmin+182,xmax,&quot;year&quot;)

ylim=p[,.(max=max(y,na.rm=T)),group]

vax=t[,.(born,week=unlist(.SD,,F)),.SDcols=patterns(&quot;Datum_&quot;)]
vax=vax[,.(y=.N),.(born,week)]
vax=vax[week!=&quot;&quot;,.(y=sum(y)),.(group=agecut(born,groups),week)]
vax=merge(do.call(CJ,lapply(vax[,-3],unique)),vax,all=T)
vax[,y:=as.double(ma(nafill(y,,0),2))]
vax=merge(ylim,vax)[,.(x=iso[week],y=y/max(y)*max),group]

vaxlab=&quot;New vaccine doses (panel top is maximum)&quot;

ggplot(p)+
facet_wrap(~group,ncol=2,dir=&quot;v&quot;,scales=&quot;free_y&quot;)+
geom_ribbon(data=vax,aes(x,ymin=0,ymax=y,fill=vaxlab),linewidth=0)+
geom_vline(xintercept=seq(xmin,xmax,&quot;year&quot;),color=&quot;gray75&quot;,linewidth=.4)+
geom_rect(data=ylim,aes(ymin=0,ymax=max),xmin=xmin,xmax=xmax,lineend=&quot;square&quot;,linejoin=&quot;mitre&quot;,fill=NA,color=&quot;gray75&quot;,linewidth=.4)+
geom_line(aes(x,y,color=dose,alpha=type),linewidth=.6)+
geom_label(data=ylim,aes(xmax,max,label=group),hjust=1,vjust=1,label.r=unit(0,&quot;pt&quot;),label.padding=unit(4,&quot;pt&quot;),label.size=.4,color=&quot;gray72&quot;,fill=&quot;white&quot;,size=3.87,lineheight=.8)+
geom_label(data=ylim,aes(xmax,max,label=group),hjust=1,vjust=1,label.r=unit(0,&quot;pt&quot;),label.padding=unit(4,&quot;pt&quot;),label.size=0,fill=NA,size=3.87,lineheight=.8)+
labs(x=NULL,y=NULL,title=&quot;ASMR per 100,000 person-years in Czech Republic&quot;)+
scale_x_date(limits=c(xmin,xmax),breaks=xbreak,labels=year(xbreak))+
scale_y_continuous(breaks=\(x){y=pretty(x,4);y[y&lt;max(x)*.98]},labels=\(x)ifelse(x&gt;=1e3,paste0(x/1e3,&quot;k&quot;),x))+
scale_color_manual(values=c(hsv(2:3/3,.6,1),&quot;black&quot;))+
scale_fill_manual(labels=vaxlab,values=&quot;gray85&quot;)+
scale_alpha_manual(values=c(1,.4))+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
guides(color=guide_legend(order=1),alpha=guide_legend(order=1),fill=guide_legend(order=3))+
theme(axis.text=element_text(size=11,color=&quot;gray50&quot;),
  axis.text.y=element_text(margin=margin(,1.5)),
  axis.ticks=element_line(linewidth=.4,color=&quot;gray75&quot;),
  axis.ticks.length.x=unit(0,&quot;pt&quot;),
  axis.ticks.length.y=unit(4,&quot;pt&quot;),
  legend.background=element_rect(color=&quot;gray70&quot;,linewidth=.4),
  legend.box=&quot;vertical&quot;,
  legend.box.just=&quot;center&quot;,
  legend.box.margin=margin(,,3),
  legend.box.spacing=unit(0,&quot;pt&quot;),
  legend.direction=&quot;horizontal&quot;,
  legend.justification=&quot;center&quot;,
  legend.key=element_blank(),
  legend.key.height=unit(13,&quot;pt&quot;),
  legend.key.spacing.x=unit(2,&quot;pt&quot;),
  legend.key.width=unit(26,&quot;pt&quot;),
  legend.margin=margin(2.5,5.5,2.5,2.5),
  legend.position=&quot;top&quot;,
  legend.spacing.x=unit(3,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.text=element_text(size=11,vjust=.5,margin=margin(,,,2)),
  legend.title=element_blank(),
  panel.background=element_blank(),
  panel.spacing.x=unit(2,&quot;pt&quot;),
  panel.spacing.y=unit(3,&quot;pt&quot;),
  plot.subtitle=element_text(size=11,hjust=.5,margin=margin(,,3)),
  plot.title=element_text(size=11,face=2,hjust=.5,margin=margin(,,3)),
  strip.background=element_blank(),
  strip.text=element_blank())
ggsave(&quot;1.png&quot;,width=5.4,height=3.8,dpi=300*4)
system(&quot;mogrify -trim 1.png;magick 1.png \\( -size `identify -format %w 1.png`x -font Arial -interline-spacing -3 -pointsize $[42*4] caption:&#39;All lines are ±2-week moving averages. ASMR was calculated by 5-year groups for year of birth, so that aging over time was not accounted for. People born in 2000 or later were grouped together, and people born in 1924 or earlier were grouped together. The total person-weeks for each age were used as the standard population. Due to a missing date of birth, unvaccinated people are missing about 10% of deaths, with slightly more deaths missing in early 2021. Source: nzip.cz/data/2135-covid-19-prehled-populace.&#39; -splice x$[16*4] \\) -append -trim -resize 25% -bordercolor white -border 20 -dither none -colors 256 1.png&quot;)</pre>
</div>
<h2>
<a href=#NZIP_deaths_as_percentage_of_FOI_deaths id=NZIP_deaths_as_percentage_of_FOI_deaths>NZIP
deaths as percentage of FOI deaths</a>
</h2>
<p>If you exclude people with a year of birth missing, then even in
2022, the NZIP data is missing more than 10% of deaths in unvaccinated
people. The proportion of missing deaths is temporarily reduced in the
winter of 2021 to 2022, but I think it's because in the winter many
unvaccinated people died of COVID, so their year of birth is available
from ISIN if they have a COVID case listed at ISIN:</p>
<div>
<img src=i/czech-nzip-missing-age.png width=530>
</div>
<div class="spoiler">
<button>
Show code
</button>
<pre>old=fread(&quot;xz -dc CR_records.csv.xz&quot;,showProgress=F)
a=old[,.(old=.N),.(week=format(DatumUmrti,&quot;%G-%V&quot;),dose=(!is.na(Datum_1))*1)]

new=fread(&quot;Otevrena-data-NR-26-30-COVID-19-prehled-populace-2024-01.csv.gz&quot;)
a2=new[Infekce%in%c(1,NA)&amp;RokNarozeni!=&quot;-&quot;][!(DatumUmrtiLPZ!=&quot;&quot;&amp;Datum_Prvni_davka&gt;DatumUmrtiLPZ)]
a2=a2[,.(new=.N),.(week=DatumUmrtiLPZ,dose=(Datum_Prvni_davka!=&quot;&quot;)*1)]

iso=as.IDate(0:1e4*7);names(iso)=format(iso,&quot;%G-%V&quot;)
p=merge(a,a2)[week!=&quot;2022-52&quot;]
p=rbind(p,p[,.(old=sum(old),new=sum(new),dose=2),week])

p=p[,.(y=new/old*100,x=iso[week],z=factor(dose,c(1,2,0),c(&quot;Vaccinated&quot;,&quot;Total&quot;,&quot;Unvaccinated&quot;)))]

xstart=as.Date(&quot;2020-1-1&quot;);xend=as.Date(&quot;2023-1-1&quot;);xbreak=seq(xstart+182,xend,&quot;year&quot;)
ybreak=0:11*10;ystart=0;yend=110

ggplot(p)+
geom_vline(xintercept=seq(xstart,xend,&quot;year&quot;),color=&quot;gray91&quot;,linewidth=.4)+
geom_hline(yintercept=ybreak,color=&quot;gray91&quot;,linewidth=.4)+
annotate(&quot;rect&quot;,xmin=xstart,xmax=xend,ymin=ystart,ymax=yend,linewidth=.4,lineend=&quot;square&quot;,linejoin=&quot;mitre&quot;,fill=NA,color=&quot;gray75&quot;)+
geom_line(aes(x,y,color=z),linewidth=.6)+
labs(x=NULL,y=NULL,title=&quot;Weekly deaths with year of birth not missing in NZIP data as\npercentage of deaths in FOI data&quot;)+
scale_x_date(limits=c(xstart,xend),breaks=xbreak,labels=year(xbreak))+
scale_y_continuous(limits=c(ystart,yend),breaks=ybreak,labels=\(x)paste0(x,&quot;%&quot;))+
scale_color_manual(values=c(hsv(0,.7,1),&quot;black&quot;,hsv(2/3,.7,1)))+
coord_cartesian(clip=&quot;off&quot;,expand=F)+
guides(color=guide_legend(ncol=1,byrow=F))+
theme(axis.text=element_text(size=11,color=&quot;gray40&quot;),
  axis.text.y=element_text(margin=margin(,1.5)),
  axis.ticks.length=unit(0,&quot;pt&quot;),
  legend.background=element_rect(color=&quot;gray75&quot;,linewidth=.4),
  legend.box.spacing=unit(0,&quot;pt&quot;),
  legend.direction=&quot;vertical&quot;,
  legend.justification=c(.5,.5),
  legend.key=element_blank(),
  legend.key.height=unit(12,&quot;pt&quot;),
  legend.key.width=unit(24,&quot;pt&quot;),
  legend.margin=margin(3,5,3,3),
  legend.position=c(.5,.5),
  legend.spacing.x=unit(2,&quot;pt&quot;),
  legend.spacing.y=unit(0,&quot;pt&quot;),
  legend.text=element_text(size=11,margin=margin(,,,2)),
  legend.title=element_blank(),
  panel.background=element_blank(),
  plot.subtitle=element_text(hjust=.5,margin=margin(,,4)),
  plot.title=element_text(size=11,hjust=.5,face=2,margin=margin(,,4)))
ggsave(&quot;1.png&quot;,width=5,height=3,dpi=300*4)</pre>
</div>
<p>I'm not sure why the number of unvaccinated people with no year of
birth is smaller than the number of unvaccinated people with no case.
But ISIN might have the year of birth for unvaccinated people who got
tested, but who tested negative so they weren't added as a case. ISIN
has a <span class="quote">"laboratory module"</span> which includes
negative tests, and which includes the date of birth:
[<a href=https://vladci.cz/archive/covid/106/UZIS_2022-02_Struktura_NZIS_106.pdf>https://vladci.cz/archive/covid/106/UZIS_2022-02_Struktura_NZIS_106.pdf</a>]</p>
<div>
<img src=i/czech-isin-test.png width=700>
</div>
<script>
document.querySelectorAll('pre').forEach(e=>e.innerHTML=e.innerHTML.replace(/((^| )# [^\n]*|^#$)/mg,"<span class=comment>$1</span>"))

const walker=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null,false)
const nodes=[]
while(walker.nextNode())nodes.push(walker.currentNode)
nodes.forEach(node=>{
  const text=node.textContent
  if(text.split(/\s+/).some(piece=>piece.length>=20)||/\w{60}/.test(text)){
    const frag=document.createDocumentFragment()
    text.split(/([A-Za-z0-9]{60}|[\041-\057\072-\100\133-\140\173-\176])/g).forEach(part=>{
      if(part){
        frag.appendChild(document.createTextNode(part))
        if(/^[A-Za-z0-9]{60}$/.test(part)||/^[\041-\057\072-\100\133-\140\173-\176]$/.test(part))
          frag.appendChild(document.createElement('wbr'))
      }
    })
    node.parentNode.replaceChild(frag,node)
  }
})

document.querySelectorAll('.spoiler button').forEach(x=>{x.addEventListener('click',function(){
  let block=this.nextElementSibling
  if(window.getComputedStyle(block).display=='none'){block.style.display='block';this.textContent='Hide code'}
  else{block.style.display='none';this.textContent='Show code'}
})})
</script>
